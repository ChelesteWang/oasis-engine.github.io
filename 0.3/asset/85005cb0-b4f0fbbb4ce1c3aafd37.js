(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{hdqI:function(t,e,a){!function(t,e){"use strict";function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function r(t,e,a){return e&&n(t.prototype,e),a&&n(t,a),t}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&function(t,e){(Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}(t,e)}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function l(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?o(t):e}function h(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,n=s(t);if(e){var r=s(this).constructor;a=Reflect.construct(n,arguments,r)}else a=n.apply(this,arguments);return l(this,a)}}var u=function(){function t(){a(this,t),this.array=new Array}return r(t,[{key:"add",value:function(t){var e=this.contains(t);return this.array[0|t]=0|t,!e}},{key:"contains",value:function(t){return null!=this.array[0|t]}},{key:"remove",value:function(t){this.array[0|t]=void 0}},{key:"clear",value:function(){this.array.length=0}}]),t}(),c=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;a(this,t),this.r=e,this.g=n,this.b=r,this.a=i}return r(t,[{key:"set",value:function(t,e,a,n){return this.r=t,this.g=e,this.b=a,this.a=n,this.clamp(),this}},{key:"setFromColor",value:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this.a=t.a,this}},{key:"setFromString",value:function(t){return t="#"==t.charAt(0)?t.substr(1):t,this.r=parseInt(t.substr(0,2),16)/255,this.g=parseInt(t.substr(2,2),16)/255,this.b=parseInt(t.substr(4,2),16)/255,this.a=(8!=t.length?255:parseInt(t.substr(6,2),16))/255,this}},{key:"add",value:function(t,e,a,n){return this.r+=t,this.g+=e,this.b+=a,this.a+=n,this.clamp(),this}},{key:"clamp",value:function(){return this.r<0?this.r=0:this.r>1&&(this.r=1),this.g<0?this.g=0:this.g>1&&(this.g=1),this.b<0?this.b=0:this.b>1&&(this.b=1),this.a<0?this.a=0:this.a>1&&(this.a=1),this}}],[{key:"rgba8888ToColor",value:function(t,e){t.r=((4278190080&e)>>>24)/255,t.g=((16711680&e)>>>16)/255,t.b=((65280&e)>>>8)/255,t.a=(255&e)/255}},{key:"rgb888ToColor",value:function(t,e){t.r=((16711680&e)>>>16)/255,t.g=((65280&e)>>>8)/255,t.b=(255&e)/255}}]),t}();c.WHITE=new c(1,1,1,1),c.RED=new c(1,0,0,1),c.GREEN=new c(0,1,0,1),c.BLUE=new c(0,0,1,1),c.MAGENTA=new c(1,0,1,1);var d=function(){function t(){a(this,t)}return r(t,null,[{key:"clamp",value:function(t,e,a){return t<e?e:t>a?a:t}},{key:"cosDeg",value:function(e){return Math.cos(e*t.degRad)}},{key:"sinDeg",value:function(e){return Math.sin(e*t.degRad)}},{key:"signum",value:function(t){return t>0?1:t<0?-1:0}},{key:"toInt",value:function(t){return t>0?Math.floor(t):Math.ceil(t)}},{key:"cbrt",value:function(t){var e=Math.pow(Math.abs(t),1/3);return t<0?-e:e}},{key:"randomTriangular",value:function(e,a){return t.randomTriangularWith(e,a,.5*(e+a))}},{key:"randomTriangularWith",value:function(t,e,a){var n=Math.random(),r=e-t;return n<=(a-t)/r?t+Math.sqrt(n*r*(a-t)):e-Math.sqrt((1-n)*r*(e-a))}}]),t}();d.PI=3.1415927,d.PI2=2*d.PI,d.radiansToDegrees=180/d.PI,d.radDeg=d.radiansToDegrees,d.degreesToRadians=d.PI/180,d.degRad=d.degreesToRadians;var f=function(){function t(){a(this,t)}return r(t,null,[{key:"arrayCopy",value:function(t,e,a,n,r){for(var i=e,s=n;i<e+r;i++,s++)a[s]=t[i]}},{key:"setArraySize",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=t.length;if(n==e)return t;if(t.length=e,n<e)for(var r=n;r<e;r++)t[r]=a;return t}},{key:"ensureArrayCapacity",value:function(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e.length>=a?e:t.setArraySize(e,a,n)}},{key:"newArray",value:function(t,e){for(var a=new Array(t),n=0;n<t;n++)a[n]=e;return a}},{key:"newFloatArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Float32Array(e);for(var a=new Array(e),n=0;n<a.length;n++)a[n]=0;return a}},{key:"newShortArray",value:function(e){if(t.SUPPORTS_TYPED_ARRAYS)return new Int16Array(e);for(var a=new Array(e),n=0;n<a.length;n++)a[n]=0;return a}},{key:"toFloatArray",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?new Float32Array(e):e}},{key:"toSinglePrecision",value:function(e){return t.SUPPORTS_TYPED_ARRAYS?Math.fround(e):e}},{key:"webkit602BugfixHelper",value:function(t,e){}},{key:"contains",value:function(t,e){for(var a=0;a<t.length;a++)if(t[a]==e)return!0;return!1}}]),t}();f.SUPPORTS_TYPED_ARRAYS="undefined"!=typeof Float32Array;var v,g=function(){function t(e){a(this,t),this.items=new Array,this.instantiator=void 0,this.instantiator=e}return r(t,[{key:"obtain",value:function(){return this.items.length>0?this.items.pop():this.instantiator()}},{key:"free",value:function(t){t.reset&&t.reset(),this.items.push(t)}},{key:"freeAll",value:function(t){for(var e=0;e<t.length;e++)this.free(t[e])}},{key:"clear",value:function(){this.items.length=0}}]),t}(),m=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;a(this,t),this.x=e,this.y=n}return r(t,[{key:"set",value:function(t,e){return this.x=t,this.y=e,this}},{key:"length",value:function(){var t=this.x,e=this.y;return Math.sqrt(t*t+e*e)}},{key:"normalize",value:function(){var t=this.length();return 0!=t&&(this.x/=t,this.y/=t),this}}]),t}(),p=function t(e,n,r){if(a(this,t),this.index=void 0,this.name=void 0,this.parent=void 0,this.length=void 0,this.x=0,this.y=0,this.rotation=0,this.scaleX=1,this.scaleY=1,this.shearX=0,this.shearY=0,this.transformMode=v.Normal,this.skinRequired=!1,this.color=new c,e<0)throw new Error("index must be >= 0.");if(null==n)throw new Error("name cannot be null.");this.index=e,this.name=n,this.parent=r};!function(t){t[t.Normal=0]="Normal",t[t.OnlyTranslation=1]="OnlyTranslation",t[t.NoRotationOrReflection=2]="NoRotationOrReflection",t[t.NoScale=3]="NoScale",t[t.NoScaleOrReflection=4]="NoScaleOrReflection"}(v||(v={}));var y,w,k,x=function(){function t(e,n,r){if(a(this,t),this.data=void 0,this.skeleton=void 0,this.parent=void 0,this.children=new Array,this.x=0,this.y=0,this.rotation=0,this.scaleX=0,this.scaleY=0,this.shearX=0,this.shearY=0,this.ax=0,this.ay=0,this.arotation=0,this.ascaleX=0,this.ascaleY=0,this.ashearX=0,this.ashearY=0,this.appliedValid=!1,this.a=0,this.b=0,this.c=0,this.d=0,this.worldY=0,this.worldX=0,this.sorted=!1,this.active=!1,null==e)throw new Error("data cannot be null.");if(null==n)throw new Error("skeleton cannot be null.");this.data=e,this.skeleton=n,this.parent=r,this.setToSetupPose()}return r(t,[{key:"isActive",value:function(){return this.active}},{key:"update",value:function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}},{key:"updateWorldTransform",value:function(){this.updateWorldTransformWith(this.x,this.y,this.rotation,this.scaleX,this.scaleY,this.shearX,this.shearY)}},{key:"updateWorldTransformWith",value:function(t,e,a,n,r,i,s){this.ax=t,this.ay=e,this.arotation=a,this.ascaleX=n,this.ascaleY=r,this.ashearX=i,this.ashearY=s,this.appliedValid=!0;var o=this.parent;if(null==o){var l=this.skeleton,h=a+90+s,u=l.scaleX,c=l.scaleY;return this.a=d.cosDeg(a+i)*n*u,this.b=d.cosDeg(h)*r*u,this.c=d.sinDeg(a+i)*n*c,this.d=d.sinDeg(h)*r*c,this.worldX=t*u+l.x,void(this.worldY=e*c+l.y)}var f=o.a,g=o.b,m=o.c,p=o.d;switch(this.worldX=f*t+g*e+o.worldX,this.worldY=m*t+p*e+o.worldY,this.data.transformMode){case v.Normal:var y=a+90+s,w=d.cosDeg(a+i)*n,k=d.cosDeg(y)*r,x=d.sinDeg(a+i)*n,E=d.sinDeg(y)*r;return this.a=f*w+g*x,this.b=f*k+g*E,this.c=m*w+p*x,void(this.d=m*k+p*E);case v.OnlyTranslation:var b=a+90+s;this.a=d.cosDeg(a+i)*n,this.b=d.cosDeg(b)*r,this.c=d.sinDeg(a+i)*n,this.d=d.sinDeg(b)*r;break;case v.NoRotationOrReflection:var M=f*f+m*m,S=0;M>1e-4?(M=Math.abs(f*p-g*m)/M,f/=this.skeleton.scaleX,g=(m/=this.skeleton.scaleY)*M,p=f*M,S=Math.atan2(m,f)*d.radDeg):(f=0,m=0,S=90-Math.atan2(p,g)*d.radDeg);var I=a+i-S,A=a+s-S+90,T=d.cosDeg(I)*n,R=d.cosDeg(A)*r,C=d.sinDeg(I)*n,V=d.sinDeg(A)*r;this.a=f*T-g*C,this.b=f*R-g*V,this.c=m*T+p*C,this.d=m*R+p*V;break;case v.NoScale:case v.NoScaleOrReflection:var P=d.cosDeg(a),F=d.sinDeg(a),N=(f*P+g*F)/this.skeleton.scaleX,_=(m*P+p*F)/this.skeleton.scaleY,O=Math.sqrt(N*N+_*_);O>1e-5&&(O=1/O),N*=O,_*=O,O=Math.sqrt(N*N+_*_),this.data.transformMode==v.NoScale&&f*p-g*m<0!=(this.skeleton.scaleX<0!=this.skeleton.scaleY<0)&&(O=-O);var L=Math.PI/2+Math.atan2(_,N),X=Math.cos(L)*O,D=Math.sin(L)*O,Y=d.cosDeg(i)*n,B=d.cosDeg(90+s)*r,U=d.sinDeg(i)*n,W=d.sinDeg(90+s)*r;this.a=N*Y+X*U,this.b=N*B+X*W,this.c=_*Y+D*U,this.d=_*B+D*W}this.a*=this.skeleton.scaleX,this.b*=this.skeleton.scaleX,this.c*=this.skeleton.scaleY,this.d*=this.skeleton.scaleY}},{key:"setToSetupPose",value:function(){var t=this.data;this.x=t.x,this.y=t.y,this.rotation=t.rotation,this.scaleX=t.scaleX,this.scaleY=t.scaleY,this.shearX=t.shearX,this.shearY=t.shearY}},{key:"getWorldRotationX",value:function(){return Math.atan2(this.c,this.a)*d.radDeg}},{key:"getWorldRotationY",value:function(){return Math.atan2(this.d,this.b)*d.radDeg}},{key:"getWorldScaleX",value:function(){return Math.sqrt(this.a*this.a+this.c*this.c)}},{key:"getWorldScaleY",value:function(){return Math.sqrt(this.b*this.b+this.d*this.d)}},{key:"updateAppliedTransform",value:function(){this.appliedValid=!0;var t=this.parent;if(null==t)return this.ax=this.worldX,this.ay=this.worldY,this.arotation=Math.atan2(this.c,this.a)*d.radDeg,this.ascaleX=Math.sqrt(this.a*this.a+this.c*this.c),this.ascaleY=Math.sqrt(this.b*this.b+this.d*this.d),this.ashearX=0,void(this.ashearY=Math.atan2(this.a*this.b+this.c*this.d,this.a*this.d-this.b*this.c)*d.radDeg);var e=t.a,a=t.b,n=t.c,r=t.d,i=1/(e*r-a*n),s=this.worldX-t.worldX,o=this.worldY-t.worldY;this.ax=s*r*i-o*a*i,this.ay=o*e*i-s*n*i;var l=i*r,h=i*e,u=i*a,c=i*n,f=l*this.a-u*this.c,v=l*this.b-u*this.d,g=h*this.c-c*this.a,m=h*this.d-c*this.b;if(this.ashearX=0,this.ascaleX=Math.sqrt(f*f+g*g),this.ascaleX>1e-4){var p=f*m-v*g;this.ascaleY=p/this.ascaleX,this.ashearY=Math.atan2(f*v+g*m,p)*d.radDeg,this.arotation=Math.atan2(g,f)*d.radDeg}else this.ascaleX=0,this.ascaleY=Math.sqrt(v*v+m*m),this.ashearY=0,this.arotation=90-Math.atan2(m,v)*d.radDeg}},{key:"worldToLocal",value:function(t){var e=this.a,a=this.b,n=this.c,r=this.d,i=1/(e*r-a*n),s=t.x-this.worldX,o=t.y-this.worldY;return t.x=s*r*i-o*a*i,t.y=o*e*i-s*n*i,t}},{key:"localToWorld",value:function(t){var e=t.x,a=t.y;return t.x=e*this.a+a*this.b+this.worldX,t.y=e*this.c+a*this.d+this.worldY,t}},{key:"worldToLocalRotation",value:function(t){var e=d.sinDeg(t),a=d.cosDeg(t);return Math.atan2(this.a*e-this.c*a,this.d*a-this.b*e)*d.radDeg+this.rotation-this.shearX}},{key:"localToWorldRotation",value:function(t){t-=this.rotation-this.shearX;var e=d.sinDeg(t),a=d.cosDeg(t);return Math.atan2(a*this.c+e*this.d,a*this.a+e*this.b)*d.radDeg}},{key:"rotateWorld",value:function(t){var e=this.a,a=this.b,n=this.c,r=this.d,i=d.cosDeg(t),s=d.sinDeg(t);this.a=i*e-s*n,this.b=i*a-s*r,this.c=s*e+i*n,this.d=s*a+i*r,this.appliedValid=!1}}]),t}(),E=function(){function t(e,n){if(a(this,t),this.data=void 0,this.bone=void 0,this.color=void 0,this.darkColor=void 0,this.attachment=void 0,this.attachmentTime=void 0,this.attachmentState=void 0,this.deform=new Array,null==e)throw new Error("data cannot be null.");if(null==n)throw new Error("bone cannot be null.");this.data=e,this.bone=n,this.color=new c,this.darkColor=null==e.darkColor?null:new c,this.setToSetupPose()}return r(t,[{key:"getSkeleton",value:function(){return this.bone.skeleton}},{key:"getAttachment",value:function(){return this.attachment}},{key:"setAttachment",value:function(t){this.attachment!=t&&(this.attachment=t,this.attachmentTime=this.bone.skeleton.time,this.deform.length=0)}},{key:"setAttachmentTime",value:function(t){this.attachmentTime=this.bone.skeleton.time-t}},{key:"getAttachmentTime",value:function(){return this.bone.skeleton.time-this.attachmentTime}},{key:"setToSetupPose",value:function(){this.color.setFromColor(this.data.color),null!=this.darkColor&&this.darkColor.setFromColor(this.data.darkColor),null==this.data.attachmentName?this.attachment=null:(this.attachment=null,this.setAttachment(this.bone.skeleton.getAttachment(this.data.index,this.data.attachmentName)))}}]),t}(),b=function(){function t(e,n){if(a(this,t),this.data=void 0,this.bones=void 0,this.target=void 0,this.bendDirection=0,this.compress=!1,this.stretch=!1,this.mix=1,this.softness=0,this.active=!1,null==e)throw new Error("data cannot be null.");if(null==n)throw new Error("skeleton cannot be null.");this.data=e,this.mix=e.mix,this.softness=e.softness,this.bendDirection=e.bendDirection,this.compress=e.compress,this.stretch=e.stretch,this.bones=new Array;for(var r=0;r<e.bones.length;r++)this.bones.push(n.findBone(e.bones[r].name));this.target=n.findBone(e.target.name)}return r(t,[{key:"isActive",value:function(){return this.active}},{key:"apply",value:function(){this.update()}},{key:"update",value:function(){var t=this.target,e=this.bones;switch(e.length){case 1:this.apply1(e[0],t.worldX,t.worldY,this.compress,this.stretch,this.data.uniform,this.mix);break;case 2:this.apply2(e[0],e[1],t.worldX,t.worldY,this.bendDirection,this.stretch,this.softness,this.mix)}}},{key:"apply1",value:function(t,e,a,n,r,i,s){t.appliedValid||t.updateAppliedTransform();var o=t.parent,l=o.a,h=o.b,u=o.c,c=o.d,f=-t.ashearX-t.arotation,g=0,m=0;switch(t.data.transformMode){case v.OnlyTranslation:g=e-t.worldX,m=a-t.worldY;break;case v.NoRotationOrReflection:var p=Math.abs(l*c-h*u)/(l*l+u*u),y=l/t.skeleton.scaleX,w=u/t.skeleton.scaleY;h=-w*p*t.skeleton.scaleX,c=y*p*t.skeleton.scaleY,f+=Math.atan2(w,y)*d.radDeg;default:var k=e-o.worldX,x=a-o.worldY,E=l*c-h*u;g=(k*c-x*h)/E-t.ax,m=(x*l-k*u)/E-t.ay}f+=Math.atan2(m,g)*d.radDeg,t.ascaleX<0&&(f+=180),f>180?f-=360:f<-180&&(f+=360);var b=t.ascaleX,M=t.ascaleY;if(n||r){switch(t.data.transformMode){case v.NoScale:case v.NoScaleOrReflection:g=e-t.worldX,m=a-t.worldY}var S=t.data.length*b,I=Math.sqrt(g*g+m*m);if(n&&I<S||r&&I>S&&S>1e-4){var A=(I/S-1)*s+1;b*=A,i&&(M*=A)}}t.updateWorldTransformWith(t.ax,t.ay,t.arotation+f*s,b,M,t.ashearX,t.ashearY)}},{key:"apply2",value:function(t,e,a,n,r,i,s,o){if(0!=o){t.appliedValid||t.updateAppliedTransform(),e.appliedValid||e.updateAppliedTransform();var l=t.ax,h=t.ay,u=t.ascaleX,c=u,f=t.ascaleY,v=e.ascaleX,g=0,m=0,p=0;u<0?(u=-u,g=180,p=-1):(g=0,p=1),f<0&&(f=-f,p=-p),v<0?(v=-v,m=180):m=0;var y=e.ax,w=0,k=0,x=0,E=t.a,b=t.b,M=t.c,S=t.d,I=Math.abs(u-f)<=1e-4;I?(k=E*y+b*(w=e.ay)+t.worldX,x=M*y+S*w+t.worldY):(w=0,k=E*y+t.worldX,x=M*y+t.worldY);var A=t.parent;E=A.a,b=A.b,M=A.c;var T,R,C=1/(E*(S=A.d)-b*M),V=k-A.worldX,P=x-A.worldY,F=(V*S-P*b)*C-l,N=(P*E-V*M)*C-h,_=Math.sqrt(F*F+N*N),O=e.data.length*v;if(_<1e-4)return this.apply1(t,a,n,!1,i,!1,o),void e.updateWorldTransformWith(y,w,0,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY);var L=((V=a-A.worldX)*S-(P=n-A.worldY)*b)*C-l,X=(P*E-V*M)*C-h,D=L*L+X*X;if(0!=s){s*=u*(v+1)/2;var Y=Math.sqrt(D),B=Y-_-O*u+s;if(B>0){var U=Math.min(1,B/(2*s))-1;D=(L-=(U=(B-s*(1-U*U))/Y)*L)*L+(X-=U*X)*X}}t:if(I){var W=(D-_*_-(O*=u)*O)/(2*_*O);W<-1?W=-1:W>1&&(W=1,i&&(c*=(Math.sqrt(D)/(_+O)-1)*o+1)),R=Math.acos(W)*r,E=_+O*W,b=O*Math.sin(R),T=Math.atan2(X*E-L*b,L*E+X*b)}else{var q=(E=u*O)*E,H=(b=f*O)*b,G=Math.atan2(X,L),j=-2*H*_,Z=H-q;if((S=j*j-4*Z*(M=H*_*_+q*D-q*H))>=0){var z=Math.sqrt(S);j<0&&(z=-z);var Q=(z=-(j+z)/2)/Z,J=M/z,K=Math.abs(Q)<Math.abs(J)?Q:J;if(K*K<=D){P=Math.sqrt(D-K*K)*r,T=G-Math.atan2(P,K),R=Math.atan2(P/f,(K-_)/u);break t}}var $=d.PI,tt=_-E,et=tt*tt,at=0,nt=0,rt=_+E,it=rt*rt,st=0;(M=-E*_/(q-H))>=-1&&M<=1&&(M=Math.acos(M),(S=(V=E*Math.cos(M)+_)*V+(P=b*Math.sin(M))*P)<et&&($=M,et=S,tt=V,at=P),S>it&&(nt=M,it=S,rt=V,st=P)),D<=(et+it)/2?(T=G-Math.atan2(at*r,tt),R=$*r):(T=G-Math.atan2(st*r,rt),R=nt*r)}var ot=Math.atan2(w,y)*p,lt=t.arotation;(T=(T-ot)*d.radDeg+g-lt)>180?T-=360:T<-180&&(T+=360),t.updateWorldTransformWith(l,h,lt+T*o,c,t.ascaleY,0,0),lt=e.arotation,(R=((R+ot)*d.radDeg-e.ashearX)*p+m-lt)>180?R-=360:R<-180&&(R+=360),e.updateWorldTransformWith(y,w,lt+R*o,e.ascaleX,e.ascaleY,e.ashearX,e.ashearY)}else e.updateWorldTransform()}}]),t}(),M=function(){function t(e,n){if(a(this,t),this.data=void 0,this.bones=void 0,this.target=void 0,this.rotateMix=0,this.translateMix=0,this.scaleMix=0,this.shearMix=0,this.temp=new m,this.active=!1,null==e)throw new Error("data cannot be null.");if(null==n)throw new Error("skeleton cannot be null.");this.data=e,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix,this.scaleMix=e.scaleMix,this.shearMix=e.shearMix,this.bones=new Array;for(var r=0;r<e.bones.length;r++)this.bones.push(n.findBone(e.bones[r].name));this.target=n.findBone(e.target.name)}return r(t,[{key:"isActive",value:function(){return this.active}},{key:"apply",value:function(){this.update()}},{key:"update",value:function(){this.data.local?this.data.relative?this.applyRelativeLocal():this.applyAbsoluteLocal():this.data.relative?this.applyRelativeWorld():this.applyAbsoluteWorld()}},{key:"applyAbsoluteWorld",value:function(){for(var t=this.rotateMix,e=this.translateMix,a=this.scaleMix,n=this.shearMix,r=this.target,i=r.a,s=r.b,o=r.c,l=r.d,h=i*l-s*o>0?d.degRad:-d.degRad,u=this.data.offsetRotation*h,c=this.data.offsetShearY*h,f=this.bones,v=0,g=f.length;v<g;v++){var m=f[v],p=!1;if(0!=t){var y=m.a,w=m.b,k=m.c,x=m.d,E=Math.atan2(o,i)-Math.atan2(k,y)+u;E>d.PI?E-=d.PI2:E<-d.PI&&(E+=d.PI2),E*=t;var b=Math.cos(E),M=Math.sin(E);m.a=b*y-M*k,m.b=b*w-M*x,m.c=M*y+b*k,m.d=M*w+b*x,p=!0}if(0!=e){var S=this.temp;r.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),m.worldX+=(S.x-m.worldX)*e,m.worldY+=(S.y-m.worldY)*e,p=!0}if(a>0){var I=Math.sqrt(m.a*m.a+m.c*m.c),A=Math.sqrt(i*i+o*o);I>1e-5&&(I=(I+(A-I+this.data.offsetScaleX)*a)/I),m.a*=I,m.c*=I,I=Math.sqrt(m.b*m.b+m.d*m.d),A=Math.sqrt(s*s+l*l),I>1e-5&&(I=(I+(A-I+this.data.offsetScaleY)*a)/I),m.b*=I,m.d*=I,p=!0}if(n>0){var T=m.b,R=m.d,C=Math.atan2(R,T),V=Math.atan2(l,s)-Math.atan2(o,i)-(C-Math.atan2(m.c,m.a));V>d.PI?V-=d.PI2:V<-d.PI&&(V+=d.PI2),V=C+(V+c)*n;var P=Math.sqrt(T*T+R*R);m.b=Math.cos(V)*P,m.d=Math.sin(V)*P,p=!0}p&&(m.appliedValid=!1)}}},{key:"applyRelativeWorld",value:function(){for(var t=this.rotateMix,e=this.translateMix,a=this.scaleMix,n=this.shearMix,r=this.target,i=r.a,s=r.b,o=r.c,l=r.d,h=i*l-s*o>0?d.degRad:-d.degRad,u=this.data.offsetRotation*h,c=this.data.offsetShearY*h,f=this.bones,v=0,g=f.length;v<g;v++){var m=f[v],p=!1;if(0!=t){var y=m.a,w=m.b,k=m.c,x=m.d,E=Math.atan2(o,i)+u;E>d.PI?E-=d.PI2:E<-d.PI&&(E+=d.PI2),E*=t;var b=Math.cos(E),M=Math.sin(E);m.a=b*y-M*k,m.b=b*w-M*x,m.c=M*y+b*k,m.d=M*w+b*x,p=!0}if(0!=e){var S=this.temp;r.localToWorld(S.set(this.data.offsetX,this.data.offsetY)),m.worldX+=S.x*e,m.worldY+=S.y*e,p=!0}if(a>0){var I=(Math.sqrt(i*i+o*o)-1+this.data.offsetScaleX)*a+1;m.a*=I,m.c*=I,I=(Math.sqrt(s*s+l*l)-1+this.data.offsetScaleY)*a+1,m.b*=I,m.d*=I,p=!0}if(n>0){var A=Math.atan2(l,s)-Math.atan2(o,i);A>d.PI?A-=d.PI2:A<-d.PI&&(A+=d.PI2);var T=m.b,R=m.d;A=Math.atan2(R,T)+(A-d.PI/2+c)*n;var C=Math.sqrt(T*T+R*R);m.b=Math.cos(A)*C,m.d=Math.sin(A)*C,p=!0}p&&(m.appliedValid=!1)}}},{key:"applyAbsoluteLocal",value:function(){var t=this.rotateMix,e=this.translateMix,a=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();for(var i=this.bones,s=0,o=i.length;s<o;s++){var l=i[s];l.appliedValid||l.updateAppliedTransform();var h=l.arotation;if(0!=t){var u=r.arotation-h+this.data.offsetRotation;h+=(u-=360*(16384-(16384.499999999996-u/360|0)))*t}var c=l.ax,d=l.ay;0!=e&&(c+=(r.ax-c+this.data.offsetX)*e,d+=(r.ay-d+this.data.offsetY)*e);var f=l.ascaleX,v=l.ascaleY;0!=a&&(f>1e-5&&(f=(f+(r.ascaleX-f+this.data.offsetScaleX)*a)/f),v>1e-5&&(v=(v+(r.ascaleY-v+this.data.offsetScaleY)*a)/v));var g=l.ashearY;if(0!=n){var m=r.ashearY-g+this.data.offsetShearY;m-=360*(16384-(16384.499999999996-m/360|0)),l.shearY+=m*n}l.updateWorldTransformWith(c,d,h,f,v,l.ashearX,g)}}},{key:"applyRelativeLocal",value:function(){var t=this.rotateMix,e=this.translateMix,a=this.scaleMix,n=this.shearMix,r=this.target;r.appliedValid||r.updateAppliedTransform();for(var i=this.bones,s=0,o=i.length;s<o;s++){var l=i[s];l.appliedValid||l.updateAppliedTransform();var h=l.arotation;0!=t&&(h+=(r.arotation+this.data.offsetRotation)*t);var u=l.ax,c=l.ay;0!=e&&(u+=(r.ax+this.data.offsetX)*e,c+=(r.ay+this.data.offsetY)*e);var d=l.ascaleX,f=l.ascaleY;0!=a&&(d>1e-5&&(d*=(r.ascaleX-1+this.data.offsetScaleX)*a+1),f>1e-5&&(f*=(r.ascaleY-1+this.data.offsetScaleY)*a+1));var v=l.ashearY;0!=n&&(v+=(r.ashearY+this.data.offsetShearY)*n),l.updateWorldTransformWith(u,c,h,d,f,l.ashearX,v)}}}]),t}(),S=function t(e,n,r){a(this,t),this.name=e,this.order=n,this.skinRequired=r},I=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t,0,!1)).bones=new Array,r.target=void 0,r.positionMode=void 0,r.spacingMode=void 0,r.rotateMode=void 0,r.offsetRotation=void 0,r.position=void 0,r.spacing=void 0,r.rotateMix=void 0,r.translateMix=void 0,r}return n}(S);!function(t){t[t.Fixed=0]="Fixed",t[t.Percent=1]="Percent"}(y||(y={})),function(t){t[t.Length=0]="Length",t[t.Fixed=1]="Fixed",t[t.Percent=2]="Percent"}(w||(w={})),function(t){t[t.Tangent=0]="Tangent",t[t.Chain=1]="Chain",t[t.ChainScale=2]="ChainScale"}(k||(k={}));var A=function t(e){if(a(this,t),this.name=void 0,null==e)throw new Error("name cannot be null.");this.name=e},T=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).id=(65535&n.nextID++)<<11,r.bones=void 0,r.vertices=void 0,r.worldVerticesLength=0,r.deformAttachment=o(r),r}return r(n,[{key:"computeWorldVertices",value:function(t,e,a,n,r,i){a=r+(a>>1)*i;var s=t.bone.skeleton,o=t.deform,l=this.vertices,h=this.bones;if(null!=h){for(var u=0,c=0,d=0;d<e;d+=2){var f=h[u];u+=f+1,c+=f}var v=s.bones;if(0==o.length)for(var g=r,m=3*c;g<a;g+=i){var p=0,y=0,w=h[u++];for(w+=u;u<w;u++,m+=3){var k=v[h[u]],x=l[m],E=l[m+1],b=l[m+2];p+=(x*k.a+E*k.b+k.worldX)*b,y+=(x*k.c+E*k.d+k.worldY)*b}n[g]=p,n[g+1]=y}else for(var M=o,S=r,I=3*c,A=c<<1;S<a;S+=i){var T=0,R=0,C=h[u++];for(C+=u;u<C;u++,I+=3,A+=2){var V=v[h[u]],P=l[I]+M[A],F=l[I+1]+M[A+1],N=l[I+2];T+=(P*V.a+F*V.b+V.worldX)*N,R+=(P*V.c+F*V.d+V.worldY)*N}n[S]=T,n[S+1]=R}}else{o.length>0&&(l=o);for(var _=t.bone,O=_.worldX,L=_.worldY,X=_.a,D=_.b,Y=_.c,B=_.d,U=e,W=r;W<a;U+=2,W+=i){var q=l[U],H=l[U+1];n[W]=q*X+H*D+O,n[W+1]=q*Y+H*B+L}}}},{key:"copyTo",value:function(t){null!=this.bones?(t.bones=new Array(this.bones.length),f.arrayCopy(this.bones,0,t.bones,0,this.bones.length)):t.bones=null,null!=this.vertices?(t.vertices=f.newFloatArray(this.vertices.length),f.arrayCopy(this.vertices,0,t.vertices,0,this.vertices.length)):t.vertices=null,t.worldVerticesLength=this.worldVerticesLength,t.deformAttachment=this.deformAttachment}}]),n}(A);T.nextID=0;var R=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).lengths=void 0,r.closed=!1,r.constantSpeed=!1,r.color=new c(1,1,1,1),r}return r(n,[{key:"copy",value:function(){var t=new n(this.name);return this.copyTo(t),t.lengths=new Array(this.lengths.length),f.arrayCopy(this.lengths,0,t.lengths,0,this.lengths.length),t.closed=closed,t.constantSpeed=this.constantSpeed,t.color.setFromColor(this.color),t}}]),n}(T),C=function(){function t(e,n){if(a(this,t),this.data=void 0,this.bones=void 0,this.target=void 0,this.position=0,this.spacing=0,this.rotateMix=0,this.translateMix=0,this.spaces=new Array,this.positions=new Array,this.world=new Array,this.curves=new Array,this.lengths=new Array,this.segments=new Array,this.active=!1,null==e)throw new Error("data cannot be null.");if(null==n)throw new Error("skeleton cannot be null.");this.data=e,this.bones=new Array;for(var r=0,i=e.bones.length;r<i;r++)this.bones.push(n.findBone(e.bones[r].name));this.target=n.findSlot(e.target.name),this.position=e.position,this.spacing=e.spacing,this.rotateMix=e.rotateMix,this.translateMix=e.translateMix}return r(t,[{key:"isActive",value:function(){return this.active}},{key:"apply",value:function(){this.update()}},{key:"update",value:function(){var e=this.target.getAttachment();if(e instanceof R){var a=this.rotateMix,n=this.translateMix,r=a>0;if(n>0||r){var i=this.data,s=i.spacingMode==w.Percent,o=i.rotateMode,l=o==k.Tangent,h=o==k.ChainScale,u=this.bones.length,c=l?u:u+1,v=this.bones,g=f.setArraySize(this.spaces,c),m=null,p=this.spacing;if(h||!s){h&&(m=f.setArraySize(this.lengths,u));for(var x=i.spacingMode==w.Length,E=0,b=c-1;E<b;){var M=v[E],S=M.data.length;if(S<t.epsilon)h&&(m[E]=0),g[++E]=0;else if(s){if(h){var I=S*M.a,A=S*M.c,T=Math.sqrt(I*I+A*A);m[E]=T}g[++E]=p}else{var C=S*M.a,V=S*M.c,P=Math.sqrt(C*C+V*V);h&&(m[E]=P),g[++E]=(x?S+p:p)*P/S}}}else for(var F=1;F<c;F++)g[F]=p;var N=this.computeWorldPositions(e,c,l,i.positionMode==y.Percent,s),_=N[0],O=N[1],L=i.offsetRotation,X=!1;if(0==L)X=o==k.Chain;else{X=!1;var D=this.target.bone;L*=D.a*D.d-D.b*D.c>0?d.degRad:-d.degRad}for(var Y=0,B=3;Y<u;Y++,B+=3){var U=v[Y];U.worldX+=(_-U.worldX)*n,U.worldY+=(O-U.worldY)*n;var W=N[B],q=N[B+1],H=W-_,G=q-O;if(h){var j=m[Y];if(0!=j){var Z=(Math.sqrt(H*H+G*G)/j-1)*a+1;U.a*=Z,U.c*=Z}}if(_=W,O=q,r){var z=U.a,Q=U.b,J=U.c,K=U.d,$=0,tt=0,et=0;if($=l?N[B-1]:0==g[Y+1]?N[B+2]:Math.atan2(G,H),$-=Math.atan2(J,z),X){tt=Math.cos($),et=Math.sin($);var at=U.data.length;_+=(at*(tt*z-et*J)-H)*a,O+=(at*(et*z+tt*J)-G)*a}else $+=L;$>d.PI?$-=d.PI2:$<-d.PI&&($+=d.PI2),$*=a,tt=Math.cos($),et=Math.sin($),U.a=tt*z-et*J,U.b=tt*Q-et*K,U.c=et*z+tt*J,U.d=et*Q+tt*K}U.appliedValid=!1}}}}},{key:"computeWorldPositions",value:function(e,a,n,r,i){var s=this.target,o=this.position,l=this.spaces,h=f.setArraySize(this.positions,3*a+2),u=null,c=e.closed,d=e.worldVerticesLength,v=d/6,g=t.NONE;if(!e.constantSpeed){var m=e.lengths,p=m[v-=c?1:2];if(r&&(o*=p),i)for(var y=1;y<a;y++)l[y]*=p;u=f.setArraySize(this.world,8);for(var w=0,k=0,x=0;w<a;w++,k+=3){var E=l[w],b=o+=E;if(c)(b%=p)<0&&(b+=p),x=0;else{if(b<0){g!=t.BEFORE&&(g=t.BEFORE,e.computeWorldVertices(s,2,4,u,0,2)),this.addBeforePosition(b,u,0,h,k);continue}if(b>p){g!=t.AFTER&&(g=t.AFTER,e.computeWorldVertices(s,d-6,4,u,0,2)),this.addAfterPosition(b-p,u,0,h,k);continue}}for(;;x++){var M=m[x];if(!(b>M)){if(0==x)b/=M;else{var S=m[x-1];b=(b-S)/(M-S)}break}}x!=g&&(g=x,c&&x==v?(e.computeWorldVertices(s,d-4,4,u,0,2),e.computeWorldVertices(s,0,4,u,4,2)):e.computeWorldVertices(s,6*x+2,8,u,0,2)),this.addCurvePosition(b,u[0],u[1],u[2],u[3],u[4],u[5],u[6],u[7],h,k,n||w>0&&0==E)}return h}c?(d+=2,u=f.setArraySize(this.world,d),e.computeWorldVertices(s,2,d-4,u,0,2),e.computeWorldVertices(s,0,2,u,d-4,2),u[d-2]=u[0],u[d-1]=u[1]):(v--,d-=4,u=f.setArraySize(this.world,d),e.computeWorldVertices(s,2,d,u,0,2));for(var I=f.setArraySize(this.curves,v),A=0,T=u[0],R=u[1],C=0,V=0,P=0,F=0,N=0,_=0,O=0,L=0,X=0,D=0,Y=0,B=0,U=0,W=0,q=0,H=2;q<v;q++,H+=6)C=u[H],V=u[H+1],P=u[H+2],F=u[H+3],Y=2*(O=.1875*(T-2*C+P))+(X=.09375*(3*(C-P)-T+(N=u[H+4]))),B=2*(L=.1875*(R-2*V+F))+(D=.09375*(3*(V-F)-R+(_=u[H+5]))),U=.75*(C-T)+O+.16666667*X,W=.75*(V-R)+L+.16666667*D,A+=Math.sqrt(U*U+W*W),U+=Y,W+=B,Y+=X,B+=D,A+=Math.sqrt(U*U+W*W),U+=Y,W+=B,A+=Math.sqrt(U*U+W*W),U+=Y+X,W+=B+D,A+=Math.sqrt(U*U+W*W),I[q]=A,T=N,R=_;if(o*=r?A:A/e.lengths[v-1],i)for(var G=1;G<a;G++)l[G]*=A;for(var j=this.segments,Z=0,z=0,Q=0,J=0,K=0;z<a;z++,Q+=3){var $=l[z],tt=o+=$;if(c)(tt%=A)<0&&(tt+=A),J=0;else{if(tt<0){this.addBeforePosition(tt,u,0,h,Q);continue}if(tt>A){this.addAfterPosition(tt-A,u,d-4,h,Q);continue}}for(;;J++){var et=I[J];if(!(tt>et)){if(0==J)tt/=et;else{var at=I[J-1];tt=(tt-at)/(et-at)}break}}if(J!=g){g=J;var nt=6*J;for(T=u[nt],R=u[nt+1],C=u[nt+2],V=u[nt+3],P=u[nt+4],F=u[nt+5],Y=2*(O=.03*(T-2*C+P))+(X=.006*(3*(C-P)-T+(N=u[nt+6]))),B=2*(L=.03*(R-2*V+F))+(D=.006*(3*(V-F)-R+(_=u[nt+7]))),U=.3*(C-T)+O+.16666667*X,W=.3*(V-R)+L+.16666667*D,Z=Math.sqrt(U*U+W*W),j[0]=Z,nt=1;nt<8;nt++)U+=Y,W+=B,Y+=X,B+=D,Z+=Math.sqrt(U*U+W*W),j[nt]=Z;U+=Y,W+=B,Z+=Math.sqrt(U*U+W*W),j[8]=Z,U+=Y+X,W+=B+D,Z+=Math.sqrt(U*U+W*W),j[9]=Z,K=0}for(tt*=Z;;K++){var rt=j[K];if(!(tt>rt)){if(0==K)tt/=rt;else{var it=j[K-1];tt=K+(tt-it)/(rt-it)}break}}this.addCurvePosition(.1*tt,T,R,C,V,P,F,N,_,h,Q,n||z>0&&0==$)}return h}},{key:"addBeforePosition",value:function(t,e,a,n,r){var i=e[a],s=e[a+1],o=e[a+2]-i,l=e[a+3]-s,h=Math.atan2(l,o);n[r]=i+t*Math.cos(h),n[r+1]=s+t*Math.sin(h),n[r+2]=h}},{key:"addAfterPosition",value:function(t,e,a,n,r){var i=e[a+2],s=e[a+3],o=i-e[a],l=s-e[a+1],h=Math.atan2(l,o);n[r]=i+t*Math.cos(h),n[r+1]=s+t*Math.sin(h),n[r+2]=h}},{key:"addCurvePosition",value:function(t,e,a,n,r,i,s,o,l,h,u,c){if(0==t||isNaN(t))return h[u]=e,h[u+1]=a,void(h[u+2]=Math.atan2(r-a,n-e));var d=t*t,f=d*t,v=1-t,g=v*v,m=g*v,p=v*t,y=3*p,w=v*y,k=y*t,x=e*m+n*w+i*k+o*f,E=a*m+r*w+s*k+l*f;h[u]=x,h[u+1]=E,c&&(h[u+2]=t<.001?Math.atan2(r-a,n-e):Math.atan2(E-(a*g+r*p*2+s*d),x-(e*g+n*p*2+i*d)))}}]),t}();C.NONE=-1,C.BEFORE=-2,C.AFTER=-3,C.epsilon=1e-5;var V=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).x=0,r.y=0,r.scaleX=1,r.scaleY=1,r.rotation=0,r.width=0,r.height=0,r.color=new c(1,1,1,1),r.path=void 0,r.rendererObject=void 0,r.region=void 0,r.offset=f.newFloatArray(8),r.uvs=f.newFloatArray(8),r.tempColor=new c(1,1,1,1),r}return r(n,[{key:"updateOffset",value:function(){var t=this.width/this.region.originalWidth*this.scaleX,e=this.height/this.region.originalHeight*this.scaleY,a=-this.width/2*this.scaleX+this.region.offsetX*t,r=-this.height/2*this.scaleY+this.region.offsetY*e,i=a+this.region.width*t,s=r+this.region.height*e,o=this.rotation*Math.PI/180,l=Math.cos(o),h=Math.sin(o),u=a*l+this.x,c=a*h,d=r*l+this.y,f=r*h,v=i*l+this.x,g=i*h,m=s*l+this.y,p=s*h,y=this.offset;y[n.OX1]=u-f,y[n.OY1]=d+c,y[n.OX2]=u-p,y[n.OY2]=m+c,y[n.OX3]=v-p,y[n.OY3]=m+g,y[n.OX4]=v-f,y[n.OY4]=d+g}},{key:"setRegion",value:function(t){this.region=t;var e=this.uvs;t.rotate?(e[2]=t.u,e[3]=t.v2,e[4]=t.u,e[5]=t.v,e[6]=t.u2,e[7]=t.v,e[0]=t.u2,e[1]=t.v2):(e[0]=t.u,e[1]=t.v2,e[2]=t.u,e[3]=t.v,e[4]=t.u2,e[5]=t.v,e[6]=t.u2,e[7]=t.v2)}},{key:"computeWorldVertices",value:function(t,e,a,r){var i=this.offset,s=t.worldX,o=t.worldY,l=t.a,h=t.b,u=t.c,c=t.d,d=0,f=0;d=i[n.OX1],f=i[n.OY1],e[a]=d*l+f*h+s,e[a+1]=d*u+f*c+o,a+=r,d=i[n.OX2],f=i[n.OY2],e[a]=d*l+f*h+s,e[a+1]=d*u+f*c+o,a+=r,d=i[n.OX3],f=i[n.OY3],e[a]=d*l+f*h+s,e[a+1]=d*u+f*c+o,a+=r,d=i[n.OX4],f=i[n.OY4],e[a]=d*l+f*h+s,e[a+1]=d*u+f*c+o}},{key:"copy",value:function(){var t=new n(this.name);return t.region=this.region,t.rendererObject=this.rendererObject,t.path=this.path,t.x=this.x,t.y=this.y,t.scaleX=this.scaleX,t.scaleY=this.scaleY,t.rotation=this.rotation,t.width=this.width,t.height=this.height,f.arrayCopy(this.uvs,0,t.uvs,0,8),f.arrayCopy(this.offset,0,t.offset,0,8),t.color.setFromColor(this.color),t}}]),n}(A);V.OX1=0,V.OY1=1,V.OX2=2,V.OY2=3,V.OX3=4,V.OY3=5,V.OX4=6,V.OY4=7,V.X1=0,V.Y1=1,V.C1R=2,V.C1G=3,V.C1B=4,V.C1A=5,V.U1=6,V.V1=7,V.X2=8,V.Y2=9,V.C2R=10,V.C2G=11,V.C2B=12,V.C2A=13,V.U2=14,V.V2=15,V.X3=16,V.Y3=17,V.C3R=18,V.C3G=19,V.C3B=20,V.C3A=21,V.U3=22,V.V3=23,V.X4=24,V.Y4=25,V.C4R=26,V.C4G=27,V.C4B=28,V.C4A=29,V.U4=30,V.V4=31;var P,F,N=function(){function t(e){a(this,t),this._image=void 0,this._image=e}return r(t,[{key:"getImage",value:function(){return this._image}}],[{key:"filterFromString",value:function(t){switch(t.toLowerCase()){case"nearest":return P.Nearest;case"linear":return P.Linear;case"mipmap":return P.MipMap;case"mipmapnearestnearest":return P.MipMapNearestNearest;case"mipmaplinearnearest":return P.MipMapLinearNearest;case"mipmapnearestlinear":return P.MipMapNearestLinear;case"mipmaplinearlinear":return P.MipMapLinearLinear;default:throw new Error("Unknown texture filter ".concat(t))}}},{key:"wrapFromString",value:function(t){switch(t.toLowerCase()){case"mirroredtepeat":return F.MirroredRepeat;case"clamptoedge":return F.ClampToEdge;case"repeat":return F.Repeat;default:throw new Error("Unknown texture wrap ".concat(t))}}}]),t}();!function(t){t[t.Nearest=9728]="Nearest",t[t.Linear=9729]="Linear",t[t.MipMap=9987]="MipMap",t[t.MipMapNearestNearest=9984]="MipMapNearestNearest",t[t.MipMapLinearNearest=9985]="MipMapLinearNearest",t[t.MipMapNearestLinear=9986]="MipMapNearestLinear",t[t.MipMapLinearLinear=9987]="MipMapLinearLinear"}(P||(P={})),function(t){t[t.MirroredRepeat=33648]="MirroredRepeat",t[t.ClampToEdge=33071]="ClampToEdge",t[t.Repeat=10497]="Repeat"}(F||(F={}));var _,O,L,X=function(t){i(n,t);var e=h(n);function n(){return a(this,n),e.apply(this,arguments)}return r(n,[{key:"setFilters",value:function(t,e){}},{key:"setWraps",value:function(t,e){}},{key:"dispose",value:function(){}}]),n}(N),D=function(){function t(e,n){a(this,t),this.pages=new Array,this.regions=new Array,this.load(e,n)}return r(t,[{key:"load",value:function(t,e){if(null==e)throw new Error("textureLoader cannot be null.");for(var a=new Y(t),n=new Array(4),r=null;;){var i=a.readLine();if(null==i)break;if(0==(i=i.trim()).length)r=null;else if(r){var s=new U;s.name=i,s.page=r;var o=a.readValue();"true"==o.toLocaleLowerCase()?s.degrees=90:"false"==o.toLocaleLowerCase()?s.degrees=0:s.degrees=parseFloat(o),s.rotate=90==s.degrees,a.readTuple(n);var l=parseInt(n[0]),h=parseInt(n[1]);a.readTuple(n);var u=parseInt(n[0]),c=parseInt(n[1]);s.u=l/r.width,s.v=h/r.height,s.rotate?(s.u2=(l+c)/r.width,s.v2=(h+u)/r.height):(s.u2=(l+u)/r.width,s.v2=(h+c)/r.height),s.x=l,s.y=h,s.width=Math.abs(u),s.height=Math.abs(c),4==a.readTuple(n)&&4==a.readTuple(n)&&a.readTuple(n),s.originalWidth=parseInt(n[0]),s.originalHeight=parseInt(n[1]),a.readTuple(n),s.offsetX=parseInt(n[0]),s.offsetY=parseInt(n[1]),s.index=parseInt(a.readValue()),s.texture=r.texture,this.regions.push(s)}else{(r=new B).name=i,2==a.readTuple(n)&&(r.width=parseInt(n[0]),r.height=parseInt(n[1]),a.readTuple(n)),a.readTuple(n),r.minFilter=N.filterFromString(n[0]),r.magFilter=N.filterFromString(n[1]);var d=a.readValue();r.uWrap=F.ClampToEdge,r.vWrap=F.ClampToEdge,"x"==d?r.uWrap=F.Repeat:"y"==d?r.vWrap=F.Repeat:"xy"==d&&(r.uWrap=r.vWrap=F.Repeat),r.texture=e(i),r.texture.setFilters(r.minFilter,r.magFilter),r.texture.setWraps(r.uWrap,r.vWrap),r.width=r.texture.getImage().width,r.height=r.texture.getImage().height,this.pages.push(r)}}}},{key:"findRegion",value:function(t){for(var e=0;e<this.regions.length;e++)if(this.regions[e].name==t)return this.regions[e];return null}},{key:"dispose",value:function(){for(var t=0;t<this.pages.length;t++)this.pages[t].texture.dispose()}}]),t}(),Y=function(){function t(e){a(this,t),this.lines=void 0,this.index=0,this.lines=e.split(/\r\n|\r|\n/)}return r(t,[{key:"readLine",value:function(){return this.index>=this.lines.length?null:this.lines[this.index++]}},{key:"readValue",value:function(){var t=this.readLine(),e=t.indexOf(":");if(-1==e)throw new Error("Invalid line: "+t);return t.substring(e+1).trim()}},{key:"readTuple",value:function(t){var e=this.readLine(),a=e.indexOf(":");if(-1==a)throw new Error("Invalid line: "+e);for(var n=0,r=a+1;n<3;n++){var i=e.indexOf(",",r);if(-1==i)break;t[n]=e.substr(r,i-r).trim(),r=i+1}return t[n]=e.substring(r).trim(),n+1}}]),t}(),B=function t(){a(this,t),this.name=void 0,this.minFilter=void 0,this.magFilter=void 0,this.uWrap=void 0,this.vWrap=void 0,this.texture=void 0,this.width=void 0,this.height=void 0},U=function(t){i(n,t);var e=h(n);function n(){var t;a(this,n);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return(t=e.call.apply(e,[this].concat(i))).page=void 0,t.name=void 0,t.x=void 0,t.y=void 0,t.index=void 0,t.rotate=void 0,t.degrees=void 0,t.texture=void 0,t}return n}((function t(){a(this,t),this.renderObject=void 0,this.u=0,this.v=0,this.u2=0,this.v2=0,this.width=0,this.height=0,this.rotate=!1,this.offsetX=0,this.offsetY=0,this.originalWidth=0,this.originalHeight=0})),W=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).region=void 0,r.path=void 0,r.regionUVs=void 0,r.uvs=void 0,r.triangles=void 0,r.color=new c(1,1,1,1),r.width=void 0,r.height=void 0,r.hullLength=void 0,r.edges=void 0,r.parentMesh=void 0,r.tempColor=new c(0,0,0,0),r}return r(n,[{key:"updateUVs",value:function(){var t=this.regionUVs;null!=this.uvs&&this.uvs.length==t.length||(this.uvs=f.newFloatArray(t.length));var e=this.uvs,a=this.uvs.length,n=this.region.u,r=this.region.v,i=0,s=0;if(this.region instanceof U){var o=this.region,l=o.texture.getImage().width,h=o.texture.getImage().height;switch(o.degrees){case 90:n-=(o.originalHeight-o.offsetY-o.height)/l,r-=(o.originalWidth-o.offsetX-o.width)/h,i=o.originalHeight/l,s=o.originalWidth/h;for(var u=0;u<a;u+=2)e[u]=n+t[u+1]*i,e[u+1]=r+(1-t[u])*s;return;case 180:n-=(o.originalWidth-o.offsetX-o.width)/l,r-=o.offsetY/h,i=o.originalWidth/l,s=o.originalHeight/h;for(var c=0;c<a;c+=2)e[c]=n+(1-t[c])*i,e[c+1]=r+(1-t[c+1])*s;return;case 270:n-=o.offsetY/l,r-=o.offsetX/h,i=o.originalHeight/l,s=o.originalWidth/h;for(var d=0;d<a;d+=2)e[d]=n+(1-t[d+1])*i,e[d+1]=r+t[d]*s;return}n-=o.offsetX/l,r-=(o.originalHeight-o.offsetY-o.height)/h,i=o.originalWidth/l,s=o.originalHeight/h}else null==this.region?(n=r=0,i=s=1):(i=this.region.u2-n,s=this.region.v2-r);for(var v=0;v<a;v+=2)e[v]=n+t[v]*i,e[v+1]=r+t[v+1]*s}},{key:"getParentMesh",value:function(){return this.parentMesh}},{key:"setParentMesh",value:function(t){this.parentMesh=t,null!=t&&(this.bones=t.bones,this.vertices=t.vertices,this.worldVerticesLength=t.worldVerticesLength,this.regionUVs=t.regionUVs,this.triangles=t.triangles,this.hullLength=t.hullLength,this.worldVerticesLength=t.worldVerticesLength)}},{key:"copy",value:function(){if(null!=this.parentMesh)return this.newLinkedMesh();var t=new n(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),this.copyTo(t),t.regionUVs=new Array(this.regionUVs.length),f.arrayCopy(this.regionUVs,0,t.regionUVs,0,this.regionUVs.length),t.uvs=new Array(this.uvs.length),f.arrayCopy(this.uvs,0,t.uvs,0,this.uvs.length),t.triangles=new Array(this.triangles.length),f.arrayCopy(this.triangles,0,t.triangles,0,this.triangles.length),t.hullLength=this.hullLength,null!=this.edges&&(t.edges=new Array(this.edges.length),f.arrayCopy(this.edges,0,t.edges,0,this.edges.length)),t.width=this.width,t.height=this.height,t}},{key:"newLinkedMesh",value:function(){var t=new n(this.name);return t.region=this.region,t.path=this.path,t.color.setFromColor(this.color),t.deformAttachment=this.deformAttachment,t.setParentMesh(null!=this.parentMesh?this.parentMesh:this),t.updateUVs(),t}}]),n}(T),q=function(){function t(e){if(a(this,t),this.data=void 0,this.bones=void 0,this.slots=void 0,this.drawOrder=void 0,this.ikConstraints=void 0,this.transformConstraints=void 0,this.pathConstraints=void 0,this._updateCache=new Array,this.updateCacheReset=new Array,this.skin=void 0,this.color=void 0,this.time=0,this.scaleX=1,this.scaleY=1,this.x=0,this.y=0,null==e)throw new Error("data cannot be null.");this.data=e,this.bones=new Array;for(var n=0;n<e.bones.length;n++){var r=e.bones[n],i=void 0;if(null==r.parent)i=new x(r,this,null);else{var s=this.bones[r.parent.index];i=new x(r,this,s),s.children.push(i)}this.bones.push(i)}this.slots=new Array,this.drawOrder=new Array;for(var o=0;o<e.slots.length;o++){var l=e.slots[o],h=this.bones[l.boneData.index],u=new E(l,h);this.slots.push(u),this.drawOrder.push(u)}this.ikConstraints=new Array;for(var d=0;d<e.ikConstraints.length;d++){var f=e.ikConstraints[d];this.ikConstraints.push(new b(f,this))}this.transformConstraints=new Array;for(var v=0;v<e.transformConstraints.length;v++){var g=e.transformConstraints[v];this.transformConstraints.push(new M(g,this))}this.pathConstraints=new Array;for(var m=0;m<e.pathConstraints.length;m++){var p=e.pathConstraints[m];this.pathConstraints.push(new C(p,this))}this.color=new c(1,1,1,1),this.updateCache()}return r(t,[{key:"updateCache",value:function(){this._updateCache.length=0,this.updateCacheReset.length=0;for(var t=this.bones,e=0,a=t.length;e<a;e++){var n=t[e];n.sorted=n.data.skinRequired,n.active=!n.sorted}if(null!=this.skin)for(var r=this.skin.bones,i=0,s=this.skin.bones.length;i<s;i++){var o=this.bones[r[i].index];do{o.sorted=!1,o.active=!0,o=o.parent}while(null!=o)}var l=this.ikConstraints,h=this.transformConstraints,u=this.pathConstraints,c=l.length,d=h.length,f=u.length,v=c+d+f;t:for(var g=0;g<v;g++){for(var m=0;m<c;m++){var p=l[m];if(p.data.order==g){this.sortIkConstraint(p);continue t}}for(var y=0;y<d;y++){var w=h[y];if(w.data.order==g){this.sortTransformConstraint(w);continue t}}for(var k=0;k<f;k++){var x=u[k];if(x.data.order==g){this.sortPathConstraint(x);continue t}}}for(var E=0,b=t.length;E<b;E++)this.sortBone(t[E])}},{key:"sortIkConstraint",value:function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&f.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target;this.sortBone(e);var a=t.bones,n=a[0];if(this.sortBone(n),a.length>1){var r=a[a.length-1];this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}this._updateCache.push(t),this.sortReset(n.children),a[a.length-1].sorted=!0}}},{key:"sortPathConstraint",value:function(t){if(t.active=t.target.bone.isActive()&&(!t.data.skinRequired||null!=this.skin&&f.contains(this.skin.constraints,t.data,!0)),t.active){var e=t.target,a=e.data.index,n=e.bone;null!=this.skin&&this.sortPathConstraintAttachment(this.skin,a,n),null!=this.data.defaultSkin&&this.data.defaultSkin!=this.skin&&this.sortPathConstraintAttachment(this.data.defaultSkin,a,n);for(var r=0,i=this.data.skins.length;r<i;r++)this.sortPathConstraintAttachment(this.data.skins[r],a,n);var s=e.getAttachment();s instanceof R&&this.sortPathConstraintAttachmentWith(s,n);for(var o=t.bones,l=o.length,h=0;h<l;h++)this.sortBone(o[h]);this._updateCache.push(t);for(var u=0;u<l;u++)this.sortReset(o[u].children);for(var c=0;c<l;c++)o[c].sorted=!0}}},{key:"sortTransformConstraint",value:function(t){if(t.active=t.target.isActive()&&(!t.data.skinRequired||null!=this.skin&&f.contains(this.skin.constraints,t.data,!0)),t.active){this.sortBone(t.target);var e=t.bones,a=e.length;if(t.data.local)for(var n=0;n<a;n++){var r=e[n];this.sortBone(r.parent),this._updateCache.indexOf(r)>-1||this.updateCacheReset.push(r)}else for(var i=0;i<a;i++)this.sortBone(e[i]);this._updateCache.push(t);for(var s=0;s<a;s++)this.sortReset(e[s].children);for(var o=0;o<a;o++)e[o].sorted=!0}}},{key:"sortPathConstraintAttachment",value:function(t,e,a){var n=t.attachments[e];if(n)for(var r in n)this.sortPathConstraintAttachmentWith(n[r],a)}},{key:"sortPathConstraintAttachmentWith",value:function(t,e){if(t instanceof R){var a=t.bones;if(null==a)this.sortBone(e);else for(var n=this.bones,r=0;r<a.length;)for(var i=a[r++],s=r+i;r<s;r++){var o=a[r];this.sortBone(n[o])}}}},{key:"sortBone",value:function(t){if(!t.sorted){var e=t.parent;null!=e&&this.sortBone(e),t.sorted=!0,this._updateCache.push(t)}}},{key:"sortReset",value:function(t){for(var e=0,a=t.length;e<a;e++){var n=t[e];n.active&&(n.sorted&&this.sortReset(n.children),n.sorted=!1)}}},{key:"updateWorldTransform",value:function(){for(var t=this.updateCacheReset,e=0,a=t.length;e<a;e++){var n=t[e];n.ax=n.x,n.ay=n.y,n.arotation=n.rotation,n.ascaleX=n.scaleX,n.ascaleY=n.scaleY,n.ashearX=n.shearX,n.ashearY=n.shearY,n.appliedValid=!0}for(var r=this._updateCache,i=0,s=r.length;i<s;i++)r[i].update()}},{key:"setToSetupPose",value:function(){this.setBonesToSetupPose(),this.setSlotsToSetupPose()}},{key:"setBonesToSetupPose",value:function(){for(var t=this.bones,e=0,a=t.length;e<a;e++)t[e].setToSetupPose();for(var n=this.ikConstraints,r=0,i=n.length;r<i;r++){var s=n[r];s.mix=s.data.mix,s.softness=s.data.softness,s.bendDirection=s.data.bendDirection,s.compress=s.data.compress,s.stretch=s.data.stretch}for(var o=this.transformConstraints,l=0,h=o.length;l<h;l++){var u=o[l],c=u.data;u.rotateMix=c.rotateMix,u.translateMix=c.translateMix,u.scaleMix=c.scaleMix,u.shearMix=c.shearMix}for(var d=this.pathConstraints,f=0,v=d.length;f<v;f++){var g=d[f],m=g.data;g.position=m.position,g.spacing=m.spacing,g.rotateMix=m.rotateMix,g.translateMix=m.translateMix}}},{key:"setSlotsToSetupPose",value:function(){var t=this.slots;f.arrayCopy(t,0,this.drawOrder,0,t.length);for(var e=0,a=t.length;e<a;e++)t[e].setToSetupPose()}},{key:"getRootBone",value:function(){return 0==this.bones.length?null:this.bones[0]}},{key:"findBone",value:function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"findBoneIndex",value:function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,a=0,n=e.length;a<n;a++)if(e[a].data.name==t)return a;return-1}},{key:"findSlot",value:function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"findSlotIndex",value:function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,a=0,n=e.length;a<n;a++)if(e[a].data.name==t)return a;return-1}},{key:"setSkinByName",value:function(t){var e=this.data.findSkin(t);if(null==e)throw new Error("Skin not found: "+t);this.setSkin(e)}},{key:"setSkin",value:function(t){if(t!=this.skin){if(null!=t)if(null!=this.skin)t.attachAll(this,this.skin);else for(var e=this.slots,a=0,n=e.length;a<n;a++){var r=e[a],i=r.data.attachmentName;if(null!=i){var s=t.getAttachment(a,i);null!=s&&r.setAttachment(s)}}this.skin=t,this.updateCache()}}},{key:"getAttachmentByName",value:function(t,e){return this.getAttachment(this.data.findSlotIndex(t),e)}},{key:"getAttachment",value:function(t,e){if(null==e)throw new Error("attachmentName cannot be null.");if(null!=this.skin){var a=this.skin.getAttachment(t,e);if(null!=a)return a}return null!=this.data.defaultSkin?this.data.defaultSkin.getAttachment(t,e):null}},{key:"setAttachment",value:function(t,e){if(null==t)throw new Error("slotName cannot be null.");for(var a=this.slots,n=0,r=a.length;n<r;n++){var i=a[n];if(i.data.name==t){var s=null;if(null!=e&&null==(s=this.getAttachment(n,e)))throw new Error("Attachment not found: "+e+", for slot: "+t);return void i.setAttachment(s)}}throw new Error("Slot not found: "+t)}},{key:"findIkConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"findTransformConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"findPathConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.data.name==t)return r}return null}},{key:"getBounds",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Array(2);if(null==t)throw new Error("offset cannot be null.");if(null==e)throw new Error("size cannot be null.");for(var n=this.drawOrder,r=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY,o=Number.NEGATIVE_INFINITY,l=0,h=n.length;l<h;l++){var u=n[l];if(u.bone.active){var c=0,d=null,v=u.getAttachment();if(v instanceof V)c=8,d=f.setArraySize(a,c,0),v.computeWorldVertices(u.bone,d,0,2);else if(v instanceof W){var g=v;c=g.worldVerticesLength,d=f.setArraySize(a,c,0),g.computeWorldVertices(u,0,c,d,0,2)}if(null!=d)for(var m=0,p=d.length;m<p;m+=2){var y=d[m],w=d[m+1];r=Math.min(r,y),i=Math.min(i,w),s=Math.max(s,y),o=Math.max(o,w)}}}t.set(r,i),e.set(s-r,o-i)}},{key:"update",value:function(t){this.time+=t}}]),t}(),H=function(){function t(e,n,r){if(a(this,t),this.name=void 0,this.timelines=void 0,this.timelineIds=void 0,this.duration=void 0,null==e)throw new Error("name cannot be null.");if(null==n)throw new Error("timelines cannot be null.");this.name=e,this.timelines=n,this.timelineIds=[];for(var i=0;i<n.length;i++)this.timelineIds[n[i].getPropertyId()]=!0;this.duration=r}return r(t,[{key:"hasTimeline",value:function(t){return 1==this.timelineIds[t]}},{key:"apply",value:function(t,e,a,n,r,i,s,o){if(null==t)throw new Error("skeleton cannot be null.");n&&0!=this.duration&&(a%=this.duration,e>0&&(e%=this.duration));for(var l=this.timelines,h=0,u=l.length;h<u;h++)l[h].apply(t,e,a,r,i,s,o)}}],[{key:"binarySearch",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=0,r=t.length/a-2;if(0==r)return a;for(var i=r>>>1;;){if(t[(i+1)*a]<=e?n=i+1:r=i,n==r)return(n+1)*a;i=n+r>>>1}}},{key:"linearSearch",value:function(t,e,a){for(var n=0,r=t.length-a;n<=r;n+=a)if(t[n]>e)return n;return-1}}]),t}();!function(t){t[t.setup=0]="setup",t[t.first=1]="first",t[t.replace=2]="replace",t[t.add=3]="add"}(_||(_={})),function(t){t[t.mixIn=0]="mixIn",t[t.mixOut=1]="mixOut"}(O||(O={})),function(t){t[t.rotate=0]="rotate",t[t.translate=1]="translate",t[t.scale=2]="scale",t[t.shear=3]="shear",t[t.attachment=4]="attachment",t[t.color=5]="color",t[t.deform=6]="deform",t[t.event=7]="event",t[t.drawOrder=8]="drawOrder",t[t.ikConstraint=9]="ikConstraint",t[t.transformConstraint=10]="transformConstraint",t[t.pathConstraintPosition=11]="pathConstraintPosition",t[t.pathConstraintSpacing=12]="pathConstraintSpacing",t[t.pathConstraintMix=13]="pathConstraintMix",t[t.twoColor=14]="twoColor"}(L||(L={}));var G=function(){function t(e){if(a(this,t),this.curves=void 0,e<=0)throw new Error("frameCount must be > 0: "+e);this.curves=f.newFloatArray((e-1)*t.BEZIER_SIZE)}return r(t,[{key:"getFrameCount",value:function(){return this.curves.length/t.BEZIER_SIZE+1}},{key:"setLinear",value:function(e){this.curves[e*t.BEZIER_SIZE]=t.LINEAR}},{key:"setStepped",value:function(e){this.curves[e*t.BEZIER_SIZE]=t.STEPPED}},{key:"getCurveType",value:function(e){var a=e*t.BEZIER_SIZE;if(a==this.curves.length)return t.LINEAR;var n=this.curves[a];return n==t.LINEAR?t.LINEAR:n==t.STEPPED?t.STEPPED:t.BEZIER}},{key:"setCurve",value:function(e,a,n,r,i){var s=.03*(2*-a+r),o=.03*(2*-n+i),l=.006*(3*(a-r)+1),h=.006*(3*(n-i)+1),u=2*s+l,c=2*o+h,d=.3*a+s+.16666667*l,f=.3*n+o+.16666667*h,v=e*t.BEZIER_SIZE,g=this.curves;g[v++]=t.BEZIER;for(var m=d,p=f,y=v+t.BEZIER_SIZE-1;v<y;v+=2)g[v]=m,g[v+1]=p,d+=u,f+=c,u+=l,c+=h,m+=d,p+=f}},{key:"getCurvePercent",value:function(e,a){a=d.clamp(a,0,1);var n=this.curves,r=e*t.BEZIER_SIZE,i=n[r];if(i==t.LINEAR)return a;if(i==t.STEPPED)return 0;for(var s=0,o=++r,l=r+t.BEZIER_SIZE-1;r<l;r+=2)if((s=n[r])>=a){var h=void 0,u=void 0;return r==o?(h=0,u=0):(h=n[r-2],u=n[r-1]),u+(n[r+1]-u)*(a-h)/(s-h)}var c=n[r-1];return c+(1-c)*(a-s)/(1-s)}}]),t}();G.LINEAR=0,G.STEPPED=1,G.BEZIER=2,G.BEZIER_SIZE=19;var j=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).boneIndex=void 0,r.frames=void 0,r.frames=f.newFloatArray(t<<1),r}return r(n,[{key:"getPropertyId",value:function(){return(L.rotate<<24)+this.boneIndex}},{key:"setFrame",value:function(t,e,a){t<<=1,this.frames[t]=e,this.frames[t+n.ROTATION]=a}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=this.frames,h=t.bones[this.boneIndex];if(h.active)if(a<l[0])switch(s){case _.setup:return void(h.rotation=h.data.rotation);case _.first:var u=h.data.rotation-h.rotation;h.rotation+=(u-360*(16384-(16384.499999999996-u/360|0)))*i}else if(a>=l[l.length-n.ENTRIES]){var c=l[l.length+n.PREV_ROTATION];switch(s){case _.setup:h.rotation=h.data.rotation+c*i;break;case _.first:case _.replace:c+=h.data.rotation-h.rotation,c-=360*(16384-(16384.499999999996-c/360|0));case _.add:h.rotation+=c*i}}else{var d=H.binarySearch(l,a,n.ENTRIES),f=l[d+n.PREV_ROTATION],v=l[d],g=this.getCurvePercent((d>>1)-1,1-(a-v)/(l[d+n.PREV_TIME]-v)),m=l[d+n.ROTATION]-f;switch(m=f+(m-360*(16384-(16384.499999999996-m/360|0)))*g,s){case _.setup:h.rotation=h.data.rotation+(m-360*(16384-(16384.499999999996-m/360|0)))*i;break;case _.first:case _.replace:m+=h.data.rotation-h.rotation;case _.add:h.rotation+=(m-360*(16384-(16384.499999999996-m/360|0)))*i}}}}]),n}(G);j.ENTRIES=2,j.PREV_TIME=-2,j.PREV_ROTATION=-1,j.ROTATION=1;var Z=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).boneIndex=void 0,r.frames=void 0,r.frames=f.newFloatArray(t*n.ENTRIES),r}return r(n,[{key:"getPropertyId",value:function(){return(L.translate<<24)+this.boneIndex}},{key:"setFrame",value:function(t,e,a,r){t*=n.ENTRIES,this.frames[t]=e,this.frames[t+n.X]=a,this.frames[t+n.Y]=r}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=this.frames,h=t.bones[this.boneIndex];if(h.active)if(a<l[0])switch(s){case _.setup:return h.x=h.data.x,void(h.y=h.data.y);case _.first:h.x+=(h.data.x-h.x)*i,h.y+=(h.data.y-h.y)*i}else{var u=0,c=0;if(a>=l[l.length-n.ENTRIES])u=l[l.length+n.PREV_X],c=l[l.length+n.PREV_Y];else{var d=H.binarySearch(l,a,n.ENTRIES);u=l[d+n.PREV_X],c=l[d+n.PREV_Y];var f=l[d],v=this.getCurvePercent(d/n.ENTRIES-1,1-(a-f)/(l[d+n.PREV_TIME]-f));u+=(l[d+n.X]-u)*v,c+=(l[d+n.Y]-c)*v}switch(s){case _.setup:h.x=h.data.x+u*i,h.y=h.data.y+c*i;break;case _.first:case _.replace:h.x+=(h.data.x+u-h.x)*i,h.y+=(h.data.y+c-h.y)*i;break;case _.add:h.x+=u*i,h.y+=c*i}}}}]),n}(G);Z.ENTRIES=3,Z.PREV_TIME=-3,Z.PREV_X=-2,Z.PREV_Y=-1,Z.X=1,Z.Y=2;var z=function(t){i(n,t);var e=h(n);function n(t){return a(this,n),e.call(this,t)}return r(n,[{key:"getPropertyId",value:function(){return(L.scale<<24)+this.boneIndex}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=this.frames,h=t.bones[this.boneIndex];if(h.active)if(a<l[0])switch(s){case _.setup:return h.scaleX=h.data.scaleX,void(h.scaleY=h.data.scaleY);case _.first:h.scaleX+=(h.data.scaleX-h.scaleX)*i,h.scaleY+=(h.data.scaleY-h.scaleY)*i}else{var u=0,c=0;if(a>=l[l.length-n.ENTRIES])u=l[l.length+n.PREV_X]*h.data.scaleX,c=l[l.length+n.PREV_Y]*h.data.scaleY;else{var f=H.binarySearch(l,a,n.ENTRIES);u=l[f+n.PREV_X],c=l[f+n.PREV_Y];var v=l[f],g=this.getCurvePercent(f/n.ENTRIES-1,1-(a-v)/(l[f+n.PREV_TIME]-v));u=(u+(l[f+n.X]-u)*g)*h.data.scaleX,c=(c+(l[f+n.Y]-c)*g)*h.data.scaleY}if(1==i)s==_.add?(h.scaleX+=u-h.data.scaleX,h.scaleY+=c-h.data.scaleY):(h.scaleX=u,h.scaleY=c);else{var m=0,p=0;if(o==O.mixOut)switch(s){case _.setup:m=h.data.scaleX,p=h.data.scaleY,h.scaleX=m+(Math.abs(u)*d.signum(m)-m)*i,h.scaleY=p+(Math.abs(c)*d.signum(p)-p)*i;break;case _.first:case _.replace:m=h.scaleX,p=h.scaleY,h.scaleX=m+(Math.abs(u)*d.signum(m)-m)*i,h.scaleY=p+(Math.abs(c)*d.signum(p)-p)*i;break;case _.add:m=h.scaleX,p=h.scaleY,h.scaleX=m+(Math.abs(u)*d.signum(m)-h.data.scaleX)*i,h.scaleY=p+(Math.abs(c)*d.signum(p)-h.data.scaleY)*i}else switch(s){case _.setup:m=Math.abs(h.data.scaleX)*d.signum(u),p=Math.abs(h.data.scaleY)*d.signum(c),h.scaleX=m+(u-m)*i,h.scaleY=p+(c-p)*i;break;case _.first:case _.replace:m=Math.abs(h.scaleX)*d.signum(u),p=Math.abs(h.scaleY)*d.signum(c),h.scaleX=m+(u-m)*i,h.scaleY=p+(c-p)*i;break;case _.add:m=d.signum(u),p=d.signum(c),h.scaleX=Math.abs(h.scaleX)*m+(u-Math.abs(h.data.scaleX)*m)*i,h.scaleY=Math.abs(h.scaleY)*p+(c-Math.abs(h.data.scaleY)*p)*i}}}}}]),n}(Z),Q=function(t){i(n,t);var e=h(n);function n(t){return a(this,n),e.call(this,t)}return r(n,[{key:"getPropertyId",value:function(){return(L.shear<<24)+this.boneIndex}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=this.frames,h=t.bones[this.boneIndex];if(h.active)if(a<l[0])switch(s){case _.setup:return h.shearX=h.data.shearX,void(h.shearY=h.data.shearY);case _.first:h.shearX+=(h.data.shearX-h.shearX)*i,h.shearY+=(h.data.shearY-h.shearY)*i}else{var u=0,c=0;if(a>=l[l.length-n.ENTRIES])u=l[l.length+n.PREV_X],c=l[l.length+n.PREV_Y];else{var d=H.binarySearch(l,a,n.ENTRIES);u=l[d+n.PREV_X],c=l[d+n.PREV_Y];var f=l[d],v=this.getCurvePercent(d/n.ENTRIES-1,1-(a-f)/(l[d+n.PREV_TIME]-f));u+=(l[d+n.X]-u)*v,c+=(l[d+n.Y]-c)*v}switch(s){case _.setup:h.shearX=h.data.shearX+u*i,h.shearY=h.data.shearY+c*i;break;case _.first:case _.replace:h.shearX+=(h.data.shearX+u-h.shearX)*i,h.shearY+=(h.data.shearY+c-h.shearY)*i;break;case _.add:h.shearX+=u*i,h.shearY+=c*i}}}}]),n}(Z),J=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).slotIndex=void 0,r.frames=void 0,r.frames=f.newFloatArray(t*n.ENTRIES),r}return r(n,[{key:"getPropertyId",value:function(){return(L.color<<24)+this.slotIndex}},{key:"setFrame",value:function(t,e,a,r,i,s){t*=n.ENTRIES,this.frames[t]=e,this.frames[t+n.R]=a,this.frames[t+n.G]=r,this.frames[t+n.B]=i,this.frames[t+n.A]=s}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=t.slots[this.slotIndex];if(l.bone.active){var h=this.frames;if(a<h[0])switch(s){case _.setup:return void l.color.setFromColor(l.data.color);case _.first:var u=l.color,c=l.data.color;u.add((c.r-u.r)*i,(c.g-u.g)*i,(c.b-u.b)*i,(c.a-u.a)*i)}else{var d=0,f=0,v=0,g=0;if(a>=h[h.length-n.ENTRIES]){var m=h.length;d=h[m+n.PREV_R],f=h[m+n.PREV_G],v=h[m+n.PREV_B],g=h[m+n.PREV_A]}else{var p=H.binarySearch(h,a,n.ENTRIES);d=h[p+n.PREV_R],f=h[p+n.PREV_G],v=h[p+n.PREV_B],g=h[p+n.PREV_A];var y=h[p],w=this.getCurvePercent(p/n.ENTRIES-1,1-(a-y)/(h[p+n.PREV_TIME]-y));d+=(h[p+n.R]-d)*w,f+=(h[p+n.G]-f)*w,v+=(h[p+n.B]-v)*w,g+=(h[p+n.A]-g)*w}if(1==i)l.color.set(d,f,v,g);else{var k=l.color;s==_.setup&&k.setFromColor(l.data.color),k.add((d-k.r)*i,(f-k.g)*i,(v-k.b)*i,(g-k.a)*i)}}}}}]),n}(G);J.ENTRIES=5,J.PREV_TIME=-5,J.PREV_R=-4,J.PREV_G=-3,J.PREV_B=-2,J.PREV_A=-1,J.R=1,J.G=2,J.B=3,J.A=4;var K=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).slotIndex=void 0,r.frames=void 0,r.frames=f.newFloatArray(t*n.ENTRIES),r}return r(n,[{key:"getPropertyId",value:function(){return(L.twoColor<<24)+this.slotIndex}},{key:"setFrame",value:function(t,e,a,r,i,s,o,l,h){t*=n.ENTRIES,this.frames[t]=e,this.frames[t+n.R]=a,this.frames[t+n.G]=r,this.frames[t+n.B]=i,this.frames[t+n.A]=s,this.frames[t+n.R2]=o,this.frames[t+n.G2]=l,this.frames[t+n.B2]=h}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=t.slots[this.slotIndex];if(l.bone.active){var h=this.frames;if(a<h[0])switch(s){case _.setup:return l.color.setFromColor(l.data.color),void l.darkColor.setFromColor(l.data.darkColor);case _.first:var u=l.color,c=l.darkColor,d=l.data.color,f=l.data.darkColor;u.add((d.r-u.r)*i,(d.g-u.g)*i,(d.b-u.b)*i,(d.a-u.a)*i),c.add((f.r-c.r)*i,(f.g-c.g)*i,(f.b-c.b)*i,0)}else{var v=0,g=0,m=0,p=0,y=0,w=0,k=0;if(a>=h[h.length-n.ENTRIES]){var x=h.length;v=h[x+n.PREV_R],g=h[x+n.PREV_G],m=h[x+n.PREV_B],p=h[x+n.PREV_A],y=h[x+n.PREV_R2],w=h[x+n.PREV_G2],k=h[x+n.PREV_B2]}else{var E=H.binarySearch(h,a,n.ENTRIES);v=h[E+n.PREV_R],g=h[E+n.PREV_G],m=h[E+n.PREV_B],p=h[E+n.PREV_A],y=h[E+n.PREV_R2],w=h[E+n.PREV_G2],k=h[E+n.PREV_B2];var b=h[E],M=this.getCurvePercent(E/n.ENTRIES-1,1-(a-b)/(h[E+n.PREV_TIME]-b));v+=(h[E+n.R]-v)*M,g+=(h[E+n.G]-g)*M,m+=(h[E+n.B]-m)*M,p+=(h[E+n.A]-p)*M,y+=(h[E+n.R2]-y)*M,w+=(h[E+n.G2]-w)*M,k+=(h[E+n.B2]-k)*M}if(1==i)l.color.set(v,g,m,p),l.darkColor.set(y,w,k,1);else{var S=l.color,I=l.darkColor;s==_.setup&&(S.setFromColor(l.data.color),I.setFromColor(l.data.darkColor)),S.add((v-S.r)*i,(g-S.g)*i,(m-S.b)*i,(p-S.a)*i),I.add((y-I.r)*i,(w-I.g)*i,(k-I.b)*i,0)}}}}}]),n}(G);K.ENTRIES=8,K.PREV_TIME=-8,K.PREV_R=-7,K.PREV_G=-6,K.PREV_B=-5,K.PREV_A=-4,K.PREV_R2=-3,K.PREV_G2=-2,K.PREV_B2=-1,K.R=1,K.G=2,K.B=3,K.A=4,K.R2=5,K.G2=6,K.B2=7;var $=function(){function t(e){a(this,t),this.slotIndex=void 0,this.frames=void 0,this.attachmentNames=void 0,this.frames=f.newFloatArray(e),this.attachmentNames=new Array(e)}return r(t,[{key:"getPropertyId",value:function(){return(L.attachment<<24)+this.slotIndex}},{key:"getFrameCount",value:function(){return this.frames.length}},{key:"setFrame",value:function(t,e,a){this.frames[t]=e,this.attachmentNames[t]=a}},{key:"apply",value:function(t,e,a,n,r,i,s){var o=t.slots[this.slotIndex];if(o.bone.active)if(s!=O.mixOut){var l=this.frames;if(a<l[0])i!=_.setup&&i!=_.first||this.setAttachment(t,o,o.data.attachmentName);else{var h;h=a>=l[l.length-1]?l.length-1:H.binarySearch(l,a,1)-1;var u=this.attachmentNames[h];t.slots[this.slotIndex].setAttachment(null==u?null:t.getAttachment(this.slotIndex,u))}}else i==_.setup&&this.setAttachment(t,o,o.data.attachmentName)}},{key:"setAttachment",value:function(t,e,a){e.attachment=null==a?null:t.getAttachment(this.slotIndex,a)}}]),t}(),tt=null,et=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).slotIndex=void 0,r.attachment=void 0,r.frames=void 0,r.frameVertices=void 0,r.frames=f.newFloatArray(t),r.frameVertices=new Array(t),null==tt&&(tt=f.newFloatArray(64)),r}return r(n,[{key:"getPropertyId",value:function(){return(L.deform<<27)+ +this.attachment.id+this.slotIndex}},{key:"setFrame",value:function(t,e,a){this.frames[t]=e,this.frameVertices[t]=a}},{key:"apply",value:function(t,e,a,n,r,i,s){var o=t.slots[this.slotIndex];if(o.bone.active){var l=o.getAttachment();if(l instanceof T&&l.deformAttachment==this.attachment){var h=o.deform;0==h.length&&(i=_.setup);var u=this.frameVertices,c=u[0].length,d=this.frames;if(a<d[0]){var v=l;switch(i){case _.setup:return void(h.length=0);case _.first:if(1==r){h.length=0;break}var g=f.setArraySize(h,c);if(null==v.bones)for(var m=v.vertices,p=0;p<c;p++)g[p]+=(m[p]-g[p])*r;else for(r=1-r,p=0;p<c;p++)g[p]*=r}}else{var y=f.setArraySize(h,c);if(a>=d[d.length-1]){var w=u[d.length-1];if(1==r)if(i==_.add){var k=l;if(null==k.bones)for(var x=k.vertices,E=0;E<c;E++)y[E]+=w[E]-x[E];else for(var b=0;b<c;b++)y[b]+=w[b]}else f.arrayCopy(w,0,y,0,c);else switch(i){case _.setup:var M=l;if(null==M.bones)for(var S=M.vertices,I=0;I<c;I++){var A=S[I];y[I]=A+(w[I]-A)*r}else for(var R=0;R<c;R++)y[R]=w[R]*r;break;case _.first:case _.replace:for(var C=0;C<c;C++)y[C]+=(w[C]-y[C])*r;break;case _.add:var V=l;if(null==V.bones)for(var P=V.vertices,F=0;F<c;F++)y[F]+=(w[F]-P[F])*r;else for(var N=0;N<c;N++)y[N]+=w[N]*r}}else{var O=H.binarySearch(d,a),L=u[O-1],X=u[O],D=d[O],Y=this.getCurvePercent(O-1,1-(a-D)/(d[O-1]-D));if(1==r)if(i==_.add){var B=l;if(null==B.bones)for(var U=B.vertices,W=0;W<c;W++){var q=L[W];y[W]+=q+(X[W]-q)*Y-U[W]}else for(var G=0;G<c;G++){var j=L[G];y[G]+=j+(X[G]-j)*Y}}else for(var Z=0;Z<c;Z++){var z=L[Z];y[Z]=z+(X[Z]-z)*Y}else switch(i){case _.setup:var Q=l;if(null==Q.bones)for(var J=Q.vertices,K=0;K<c;K++){var $=L[K],tt=J[K];y[K]=tt+($+(X[K]-$)*Y-tt)*r}else for(var et=0;et<c;et++){var at=L[et];y[et]=(at+(X[et]-at)*Y)*r}break;case _.first:case _.replace:for(var nt=0;nt<c;nt++){var rt=L[nt];y[nt]+=(rt+(X[nt]-rt)*Y-y[nt])*r}break;case _.add:var it=l;if(null==it.bones)for(var st=it.vertices,ot=0;ot<c;ot++){var lt=L[ot];y[ot]+=(lt+(X[ot]-lt)*Y-st[ot])*r}else for(var ht=0;ht<c;ht++){var ut=L[ht];y[ht]+=(ut+(X[ht]-ut)*Y)*r}}}}}}}}]),n}(G),at=function(){function t(e){a(this,t),this.frames=void 0,this.events=void 0,this.frames=f.newFloatArray(e),this.events=new Array(e)}return r(t,[{key:"getPropertyId",value:function(){return L.event<<24}},{key:"getFrameCount",value:function(){return this.frames.length}},{key:"setFrame",value:function(t,e){this.frames[t]=e.time,this.events[t]=e}},{key:"apply",value:function(t,e,a,n,r,i,s){if(null!=n){var o=this.frames,l=this.frames.length;if(e>a)this.apply(t,e,Number.MAX_VALUE,n,r,i,s),e=-1;else if(e>=o[l-1])return;if(!(a<o[0])){var h=0;if(e<o[0])h=0;else for(var u=o[h=H.binarySearch(o,e)];h>0&&o[h-1]==u;)h--;for(;h<l&&a>=o[h];h++)n.push(this.events[h])}}}}]),t}(),nt=function(){function t(e){a(this,t),this.frames=void 0,this.drawOrders=void 0,this.frames=f.newFloatArray(e),this.drawOrders=new Array(e)}return r(t,[{key:"getPropertyId",value:function(){return L.drawOrder<<24}},{key:"getFrameCount",value:function(){return this.frames.length}},{key:"setFrame",value:function(t,e,a){this.frames[t]=e,this.drawOrders[t]=a}},{key:"apply",value:function(t,e,a,n,r,i,s){var o=t.drawOrder,l=t.slots;if(s!=O.mixOut){var h=this.frames;if(a<h[0])i!=_.setup&&i!=_.first||f.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length);else{var u;u=a>=h[h.length-1]?h.length-1:H.binarySearch(h,a)-1;var c=this.drawOrders[u];if(null==c)f.arrayCopy(l,0,o,0,l.length);else for(var d=0,v=c.length;d<v;d++)o[d]=l[c[d]]}}else i==_.setup&&f.arrayCopy(t.slots,0,t.drawOrder,0,t.slots.length)}}]),t}(),rt=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).ikConstraintIndex=void 0,r.frames=void 0,r.frames=f.newFloatArray(t*n.ENTRIES),r}return r(n,[{key:"getPropertyId",value:function(){return(L.ikConstraint<<24)+this.ikConstraintIndex}},{key:"setFrame",value:function(t,e,a,r,i,s,o){t*=n.ENTRIES,this.frames[t]=e,this.frames[t+n.MIX]=a,this.frames[t+n.SOFTNESS]=r,this.frames[t+n.BEND_DIRECTION]=i,this.frames[t+n.COMPRESS]=s?1:0,this.frames[t+n.STRETCH]=o?1:0}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=this.frames,h=t.ikConstraints[this.ikConstraintIndex];if(h.active)if(a<l[0])switch(s){case _.setup:return h.mix=h.data.mix,h.softness=h.data.softness,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,void(h.stretch=h.data.stretch);case _.first:h.mix+=(h.data.mix-h.mix)*i,h.softness+=(h.data.softness-h.softness)*i,h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch}else if(a>=l[l.length-n.ENTRIES])s==_.setup?(h.mix=h.data.mix+(l[l.length+n.PREV_MIX]-h.data.mix)*i,h.softness=h.data.softness+(l[l.length+n.PREV_SOFTNESS]-h.data.softness)*i,o==O.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=l[l.length+n.PREV_BEND_DIRECTION],h.compress=0!=l[l.length+n.PREV_COMPRESS],h.stretch=0!=l[l.length+n.PREV_STRETCH])):(h.mix+=(l[l.length+n.PREV_MIX]-h.mix)*i,h.softness+=(l[l.length+n.PREV_SOFTNESS]-h.softness)*i,o==O.mixIn&&(h.bendDirection=l[l.length+n.PREV_BEND_DIRECTION],h.compress=0!=l[l.length+n.PREV_COMPRESS],h.stretch=0!=l[l.length+n.PREV_STRETCH]));else{var u=H.binarySearch(l,a,n.ENTRIES),c=l[u+n.PREV_MIX],d=l[u+n.PREV_SOFTNESS],f=l[u],v=this.getCurvePercent(u/n.ENTRIES-1,1-(a-f)/(l[u+n.PREV_TIME]-f));s==_.setup?(h.mix=h.data.mix+(c+(l[u+n.MIX]-c)*v-h.data.mix)*i,h.softness=h.data.softness+(d+(l[u+n.SOFTNESS]-d)*v-h.data.softness)*i,o==O.mixOut?(h.bendDirection=h.data.bendDirection,h.compress=h.data.compress,h.stretch=h.data.stretch):(h.bendDirection=l[u+n.PREV_BEND_DIRECTION],h.compress=0!=l[u+n.PREV_COMPRESS],h.stretch=0!=l[u+n.PREV_STRETCH])):(h.mix+=(c+(l[u+n.MIX]-c)*v-h.mix)*i,h.softness+=(d+(l[u+n.SOFTNESS]-d)*v-h.softness)*i,o==O.mixIn&&(h.bendDirection=l[u+n.PREV_BEND_DIRECTION],h.compress=0!=l[u+n.PREV_COMPRESS],h.stretch=0!=l[u+n.PREV_STRETCH]))}}}]),n}(G);rt.ENTRIES=6,rt.PREV_TIME=-6,rt.PREV_MIX=-5,rt.PREV_SOFTNESS=-4,rt.PREV_BEND_DIRECTION=-3,rt.PREV_COMPRESS=-2,rt.PREV_STRETCH=-1,rt.MIX=1,rt.SOFTNESS=2,rt.BEND_DIRECTION=3,rt.COMPRESS=4,rt.STRETCH=5;var it=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).transformConstraintIndex=void 0,r.frames=void 0,r.frames=f.newFloatArray(t*n.ENTRIES),r}return r(n,[{key:"getPropertyId",value:function(){return(L.transformConstraint<<24)+this.transformConstraintIndex}},{key:"setFrame",value:function(t,e,a,r,i,s){t*=n.ENTRIES,this.frames[t]=e,this.frames[t+n.ROTATE]=a,this.frames[t+n.TRANSLATE]=r,this.frames[t+n.SCALE]=i,this.frames[t+n.SHEAR]=s}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=this.frames,h=t.transformConstraints[this.transformConstraintIndex];if(h.active)if(a<l[0]){var u=h.data;switch(s){case _.setup:return h.rotateMix=u.rotateMix,h.translateMix=u.translateMix,h.scaleMix=u.scaleMix,void(h.shearMix=u.shearMix);case _.first:h.rotateMix+=(u.rotateMix-h.rotateMix)*i,h.translateMix+=(u.translateMix-h.translateMix)*i,h.scaleMix+=(u.scaleMix-h.scaleMix)*i,h.shearMix+=(u.shearMix-h.shearMix)*i}}else{var c=0,d=0,f=0,v=0;if(a>=l[l.length-n.ENTRIES]){var g=l.length;c=l[g+n.PREV_ROTATE],d=l[g+n.PREV_TRANSLATE],f=l[g+n.PREV_SCALE],v=l[g+n.PREV_SHEAR]}else{var m=H.binarySearch(l,a,n.ENTRIES);c=l[m+n.PREV_ROTATE],d=l[m+n.PREV_TRANSLATE],f=l[m+n.PREV_SCALE],v=l[m+n.PREV_SHEAR];var p=l[m],y=this.getCurvePercent(m/n.ENTRIES-1,1-(a-p)/(l[m+n.PREV_TIME]-p));c+=(l[m+n.ROTATE]-c)*y,d+=(l[m+n.TRANSLATE]-d)*y,f+=(l[m+n.SCALE]-f)*y,v+=(l[m+n.SHEAR]-v)*y}if(s==_.setup){var w=h.data;h.rotateMix=w.rotateMix+(c-w.rotateMix)*i,h.translateMix=w.translateMix+(d-w.translateMix)*i,h.scaleMix=w.scaleMix+(f-w.scaleMix)*i,h.shearMix=w.shearMix+(v-w.shearMix)*i}else h.rotateMix+=(c-h.rotateMix)*i,h.translateMix+=(d-h.translateMix)*i,h.scaleMix+=(f-h.scaleMix)*i,h.shearMix+=(v-h.shearMix)*i}}}]),n}(G);it.ENTRIES=5,it.PREV_TIME=-5,it.PREV_ROTATE=-4,it.PREV_TRANSLATE=-3,it.PREV_SCALE=-2,it.PREV_SHEAR=-1,it.ROTATE=1,it.TRANSLATE=2,it.SCALE=3,it.SHEAR=4;var st=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).pathConstraintIndex=void 0,r.frames=void 0,r.frames=f.newFloatArray(t*n.ENTRIES),r}return r(n,[{key:"getPropertyId",value:function(){return(L.pathConstraintPosition<<24)+this.pathConstraintIndex}},{key:"setFrame",value:function(t,e,a){t*=n.ENTRIES,this.frames[t]=e,this.frames[t+n.VALUE]=a}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(h.active)if(a<l[0])switch(s){case _.setup:return void(h.position=h.data.position);case _.first:h.position+=(h.data.position-h.position)*i}else{var u=0;if(a>=l[l.length-n.ENTRIES])u=l[l.length+n.PREV_VALUE];else{var c=H.binarySearch(l,a,n.ENTRIES);u=l[c+n.PREV_VALUE];var d=l[c],f=this.getCurvePercent(c/n.ENTRIES-1,1-(a-d)/(l[c+n.PREV_TIME]-d));u+=(l[c+n.VALUE]-u)*f}s==_.setup?h.position=h.data.position+(u-h.data.position)*i:h.position+=(u-h.position)*i}}}]),n}(G);st.ENTRIES=2,st.PREV_TIME=-2,st.PREV_VALUE=-1,st.VALUE=1;var ot=function(t){i(n,t);var e=h(n);function n(t){return a(this,n),e.call(this,t)}return r(n,[{key:"getPropertyId",value:function(){return(L.pathConstraintSpacing<<24)+this.pathConstraintIndex}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(h.active)if(a<l[0])switch(s){case _.setup:return void(h.spacing=h.data.spacing);case _.first:h.spacing+=(h.data.spacing-h.spacing)*i}else{var u=0;if(a>=l[l.length-n.ENTRIES])u=l[l.length+n.PREV_VALUE];else{var c=H.binarySearch(l,a,n.ENTRIES);u=l[c+n.PREV_VALUE];var d=l[c],f=this.getCurvePercent(c/n.ENTRIES-1,1-(a-d)/(l[c+n.PREV_TIME]-d));u+=(l[c+n.VALUE]-u)*f}s==_.setup?h.spacing=h.data.spacing+(u-h.data.spacing)*i:h.spacing+=(u-h.spacing)*i}}}]),n}(st),lt=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).pathConstraintIndex=void 0,r.frames=void 0,r.frames=f.newFloatArray(t*n.ENTRIES),r}return r(n,[{key:"getPropertyId",value:function(){return(L.pathConstraintMix<<24)+this.pathConstraintIndex}},{key:"setFrame",value:function(t,e,a,r){t*=n.ENTRIES,this.frames[t]=e,this.frames[t+n.ROTATE]=a,this.frames[t+n.TRANSLATE]=r}},{key:"apply",value:function(t,e,a,r,i,s,o){var l=this.frames,h=t.pathConstraints[this.pathConstraintIndex];if(h.active)if(a<l[0])switch(s){case _.setup:return h.rotateMix=h.data.rotateMix,void(h.translateMix=h.data.translateMix);case _.first:h.rotateMix+=(h.data.rotateMix-h.rotateMix)*i,h.translateMix+=(h.data.translateMix-h.translateMix)*i}else{var u=0,c=0;if(a>=l[l.length-n.ENTRIES])u=l[l.length+n.PREV_ROTATE],c=l[l.length+n.PREV_TRANSLATE];else{var d=H.binarySearch(l,a,n.ENTRIES);u=l[d+n.PREV_ROTATE],c=l[d+n.PREV_TRANSLATE];var f=l[d],v=this.getCurvePercent(d/n.ENTRIES-1,1-(a-f)/(l[d+n.PREV_TIME]-f));u+=(l[d+n.ROTATE]-u)*v,c+=(l[d+n.TRANSLATE]-c)*v}s==_.setup?(h.rotateMix=h.data.rotateMix+(u-h.data.rotateMix)*i,h.translateMix=h.data.translateMix+(c-h.data.translateMix)*i):(h.rotateMix+=(u-h.rotateMix)*i,h.translateMix+=(c-h.translateMix)*i)}}}]),n}(G);lt.ENTRIES=3,lt.PREV_TIME=-3,lt.PREV_ROTATE=-2,lt.PREV_TRANSLATE=-1,lt.ROTATE=1,lt.TRANSLATE=2;var ht=function(){function t(e){a(this,t),this.data=void 0,this.tracks=new Array,this.timeScale=1,this.unkeyedState=0,this.events=new Array,this.listeners=new Array,this.queue=new dt(this),this.propertyIDs=new u,this.animationsChanged=!1,this.trackEntryPool=new g((function(){return new ct})),this.data=e}return r(t,[{key:"update",value:function(t){t*=this.timeScale;for(var e=this.tracks,a=0,n=e.length;a<n;a++){var r=e[a];if(null!=r){r.animationLast=r.nextAnimationLast,r.trackLast=r.nextTrackLast;var i=t*r.timeScale;if(r.delay>0){if(r.delay-=i,r.delay>0)continue;i=-r.delay,r.delay=0}var s=r.next;if(null!=s){var o=r.trackLast-s.delay;if(o>=0){for(s.delay=0,s.trackTime+=0==r.timeScale?0:(o/r.timeScale+t)*s.timeScale,r.trackTime+=i,this.setCurrent(a,s,!0);null!=s.mixingFrom;)s.mixTime+=t,s=s.mixingFrom;continue}}else if(r.trackLast>=r.trackEnd&&null==r.mixingFrom){e[a]=null,this.queue.end(r),this.disposeNext(r);continue}if(null!=r.mixingFrom&&this.updateMixingFrom(r,t)){var l=r.mixingFrom;for(r.mixingFrom=null,null!=l&&(l.mixingTo=null);null!=l;)this.queue.end(l),l=l.mixingFrom}r.trackTime+=i}}this.queue.drain()}},{key:"updateMixingFrom",value:function(t,e){var a=t.mixingFrom;if(null==a)return!0;var n=this.updateMixingFrom(a,e);return a.animationLast=a.nextAnimationLast,a.trackLast=a.nextTrackLast,t.mixTime>0&&t.mixTime>=t.mixDuration?(0!=a.totalAlpha&&0!=t.mixDuration||(t.mixingFrom=a.mixingFrom,null!=a.mixingFrom&&(a.mixingFrom.mixingTo=t),t.interruptAlpha=a.interruptAlpha,this.queue.end(a)),n):(a.trackTime+=e*a.timeScale,t.mixTime+=e,!1)}},{key:"apply",value:function(e){if(null==e)throw new Error("skeleton cannot be null.");this.animationsChanged&&this._animationsChanged();for(var a=this.events,n=this.tracks,r=!1,i=0,s=n.length;i<s;i++){var o=n[i];if(!(null==o||o.delay>0)){r=!0;var l=0==i?_.first:o.mixBlend,h=o.alpha;null!=o.mixingFrom?h*=this.applyMixingFrom(o,e,l):o.trackTime>=o.trackEnd&&null==o.next&&(h=0);var u=o.animationLast,c=o.getAnimationTime(),d=o.animation.timelines.length,v=o.animation.timelines;if(0==i&&1==h||l==_.add)for(var g=0;g<d;g++){f.webkit602BugfixHelper(h,l);var m=v[g];m instanceof $?this.applyAttachmentTimeline(m,e,c,l,!0):m.apply(e,u,c,a,h,l,O.mixIn)}else{var p=o.timelineMode,y=0==o.timelinesRotation.length;y&&f.setArraySize(o.timelinesRotation,d<<1,null);for(var w=o.timelinesRotation,k=0;k<d;k++){var x=v[k],E=p[k]==t.SUBSEQUENT?l:_.setup;x instanceof j?this.applyRotateTimeline(x,e,c,h,E,w,k<<1,y):x instanceof $?this.applyAttachmentTimeline(x,e,c,l,!0):(f.webkit602BugfixHelper(h,l),x.apply(e,u,c,a,h,E,O.mixIn))}}this.queueEvents(o,c),a.length=0,o.nextAnimationLast=c,o.nextTrackLast=o.trackTime}}for(var b=this.unkeyedState+t.SETUP,M=e.slots,S=0,I=e.slots.length;S<I;S++){var A=M[S];if(A.attachmentState==b){var T=A.data.attachmentName;A.attachment=null==T?null:e.getAttachment(A.data.index,T)}}return this.unkeyedState+=2,this.queue.drain(),r}},{key:"applyMixingFrom",value:function(e,a,n){var r=e.mixingFrom;null!=r.mixingFrom&&this.applyMixingFrom(r,a,n);var i=0;0==e.mixDuration?(i=1,n==_.first&&(n=_.setup)):((i=e.mixTime/e.mixDuration)>1&&(i=1),n!=_.first&&(n=r.mixBlend));var s=i<r.eventThreshold?this.events:null,o=i<r.attachmentThreshold,l=i<r.drawOrderThreshold,h=r.animationLast,u=r.getAnimationTime(),c=r.animation.timelines.length,d=r.animation.timelines,v=r.alpha*e.interruptAlpha,g=v*(1-i);if(n==_.add)for(var m=0;m<c;m++)d[m].apply(a,h,u,s,g,n,O.mixOut);else{var p=r.timelineMode,y=r.timelineHoldMix,w=0==r.timelinesRotation.length;w&&f.setArraySize(r.timelinesRotation,c<<1,null);var k=r.timelinesRotation;r.totalAlpha=0;for(var x=0;x<c;x++){var E=d[x],b=O.mixOut,M=void 0,S=0;switch(p[x]){case t.SUBSEQUENT:if(!l&&E instanceof nt)continue;M=n,S=g;break;case t.FIRST:M=_.setup,S=g;break;case t.HOLD_SUBSEQUENT:M=n,S=v;break;case t.HOLD_FIRST:M=_.setup,S=v;break;default:M=_.setup;var I=y[x];S=v*Math.max(0,1-I.mixTime/I.mixDuration)}r.totalAlpha+=S,E instanceof j?this.applyRotateTimeline(E,a,u,S,M,k,x<<1,w):E instanceof $?this.applyAttachmentTimeline(E,a,u,M,o):(f.webkit602BugfixHelper(S,n),l&&E instanceof nt&&M==_.setup&&(b=O.mixIn),E.apply(a,h,u,s,S,M,b))}}return e.mixDuration>0&&this.queueEvents(r,u),this.events.length=0,r.nextAnimationLast=u,r.nextTrackLast=r.trackTime,i}},{key:"applyAttachmentTimeline",value:function(e,a,n,r,i){var s=a.slots[e.slotIndex];if(s.bone.active){var o,l=e.frames;n<l[0]?r!=_.setup&&r!=_.first||this.setAttachment(a,s,s.data.attachmentName,i):(o=n>=l[l.length-1]?l.length-1:H.binarySearch(l,n)-1,this.setAttachment(a,s,e.attachmentNames[o],i)),s.attachmentState<=this.unkeyedState&&(s.attachmentState=this.unkeyedState+t.SETUP)}}},{key:"setAttachment",value:function(e,a,n,r){a.attachment=null==n?null:e.getAttachment(a.data.index,n),r&&(a.attachmentState=this.unkeyedState+t.CURRENT)}},{key:"applyRotateTimeline",value:function(t,e,a,n,r,i,s,o){if(o&&(i[s]=0),1!=n){var l=t,h=l.frames,u=e.bones[l.boneIndex];if(u.active){var c=0,f=0;if(a<h[0])switch(r){case _.setup:u.rotation=u.data.rotation;default:return;case _.first:c=u.rotation,f=u.data.rotation}else if(c=r==_.setup?u.data.rotation:u.rotation,a>=h[h.length-j.ENTRIES])f=u.data.rotation+h[h.length+j.PREV_ROTATION];else{var v=H.binarySearch(h,a,j.ENTRIES),g=h[v+j.PREV_ROTATION],m=h[v],p=l.getCurvePercent((v>>1)-1,1-(a-m)/(h[v+j.PREV_TIME]-m));f=h[v+j.ROTATION]-g,f=g+(f-=360*(16384-(16384.499999999996-f/360|0)))*p+u.data.rotation,f-=360*(16384-(16384.499999999996-f/360|0))}var y=0,w=f-c;if(0==(w-=360*(16384-(16384.499999999996-w/360|0))))y=i[s];else{var k=0,x=0;o?(k=0,x=w):(k=i[s],x=i[s+1]);var E=w>0,b=k>=0;d.signum(x)!=d.signum(w)&&Math.abs(x)<=90&&(Math.abs(k)>180&&(k+=360*d.signum(k)),b=E),y=w+k-k%360,b!=E&&(y+=360*d.signum(k)),i[s]=y}i[s+1]=w,c+=y*n,u.rotation=c-360*(16384-(16384.499999999996-c/360|0))}}else t.apply(e,0,a,null,1,r,O.mixIn)}},{key:"queueEvents",value:function(t,e){for(var a=t.animationStart,n=t.animationEnd,r=n-a,i=t.trackLast%r,s=this.events,o=0,l=s.length;o<l;o++){var h=s[o];if(h.time<i)break;h.time>n||this.queue.event(t,h)}for((t.loop?0==r||i>t.trackTime%r:e>=n&&t.animationLast<n)&&this.queue.complete(t);o<l;o++)s[o].time<a||this.queue.event(t,s[o])}},{key:"clearTracks",value:function(){var t=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var e=0,a=this.tracks.length;e<a;e++)this.clearTrack(e);this.tracks.length=0,this.queue.drainDisabled=t,this.queue.drain()}},{key:"clearTrack",value:function(t){if(!(t>=this.tracks.length)){var e=this.tracks[t];if(null!=e){this.queue.end(e),this.disposeNext(e);for(var a=e;;){var n=a.mixingFrom;if(null==n)break;this.queue.end(n),a.mixingFrom=null,a.mixingTo=null,a=n}this.tracks[e.trackIndex]=null,this.queue.drain()}}}},{key:"setCurrent",value:function(t,e,a){var n=this.expandToIndex(t);this.tracks[t]=e,null!=n&&(a&&this.queue.interrupt(n),e.mixingFrom=n,n.mixingTo=e,e.mixTime=0,null!=n.mixingFrom&&n.mixDuration>0&&(e.interruptAlpha*=Math.min(1,n.mixTime/n.mixDuration)),n.timelinesRotation.length=0),this.queue.start(e)}},{key:"setAnimation",value:function(t,e,a){var n=this.data.skeletonData.findAnimation(e);if(null==n)throw new Error("Animation not found: "+e);return this.setAnimationWith(t,n,a)}},{key:"setAnimationWith",value:function(t,e,a){if(null==e)throw new Error("animation cannot be null.");var n=!0,r=this.expandToIndex(t);null!=r&&(-1==r.nextTrackLast?(this.tracks[t]=r.mixingFrom,this.queue.interrupt(r),this.queue.end(r),this.disposeNext(r),r=r.mixingFrom,n=!1):this.disposeNext(r));var i=this.trackEntry(t,e,a,r);return this.setCurrent(t,i,n),this.queue.drain(),i}},{key:"addAnimation",value:function(t,e,a,n){var r=this.data.skeletonData.findAnimation(e);if(null==r)throw new Error("Animation not found: "+e);return this.addAnimationWith(t,r,a,n)}},{key:"addAnimationWith",value:function(t,e,a,n){if(null==e)throw new Error("animation cannot be null.");var r=this.expandToIndex(t);if(null!=r)for(;null!=r.next;)r=r.next;var i=this.trackEntry(t,e,a,r);if(null==r)this.setCurrent(t,i,!0),this.queue.drain();else if(r.next=i,n<=0){var s=r.animationEnd-r.animationStart;0!=s?(r.loop?n+=s*(1+(r.trackTime/s|0)):n+=Math.max(s,r.trackTime),n-=this.data.getMix(r.animation,e)):n=r.trackTime}return i.delay=n,i}},{key:"setEmptyAnimation",value:function(e,a){var n=this.setAnimationWith(e,t.emptyAnimation,!1);return n.mixDuration=a,n.trackEnd=a,n}},{key:"addEmptyAnimation",value:function(e,a,n){n<=0&&(n-=a);var r=this.addAnimationWith(e,t.emptyAnimation,!1,n);return r.mixDuration=a,r.trackEnd=a,r}},{key:"setEmptyAnimations",value:function(t){var e=this.queue.drainDisabled;this.queue.drainDisabled=!0;for(var a=0,n=this.tracks.length;a<n;a++){var r=this.tracks[a];null!=r&&this.setEmptyAnimation(r.trackIndex,t)}this.queue.drainDisabled=e,this.queue.drain()}},{key:"expandToIndex",value:function(t){return t<this.tracks.length?this.tracks[t]:(f.ensureArrayCapacity(this.tracks,t+1,null),this.tracks.length=t+1,null)}},{key:"trackEntry",value:function(t,e,a,n){var r=this.trackEntryPool.obtain();return r.trackIndex=t,r.animation=e,r.loop=a,r.holdPrevious=!1,r.eventThreshold=0,r.attachmentThreshold=0,r.drawOrderThreshold=0,r.animationStart=0,r.animationEnd=e.duration,r.animationLast=-1,r.nextAnimationLast=-1,r.delay=0,r.trackTime=0,r.trackLast=-1,r.nextTrackLast=-1,r.trackEnd=Number.MAX_VALUE,r.timeScale=1,r.alpha=1,r.interruptAlpha=1,r.mixTime=0,r.mixDuration=null==n?0:this.data.getMix(n.animation,e),r.mixBlend=_.replace,r}},{key:"disposeNext",value:function(t){for(var e=t.next;null!=e;)this.queue.dispose(e),e=e.next;t.next=null}},{key:"_animationsChanged",value:function(){this.animationsChanged=!1,this.propertyIDs.clear();for(var t=0,e=this.tracks.length;t<e;t++){var a=this.tracks[t];if(null!=a){for(;null!=a.mixingFrom;)a=a.mixingFrom;do{null!=a.mixingFrom&&a.mixBlend==_.add||this.computeHold(a),a=a.mixingTo}while(null!=a)}}}},{key:"computeHold",value:function(e){var a=e.mixingTo,n=e.animation.timelines,r=e.animation.timelines.length,i=f.setArraySize(e.timelineMode,r);e.timelineHoldMix.length=0;var s=f.setArraySize(e.timelineHoldMix,r),o=this.propertyIDs;if(null!=a&&a.holdPrevious)for(var l=0;l<r;l++)i[l]=o.add(n[l].getPropertyId())?t.HOLD_FIRST:t.HOLD_SUBSEQUENT;else t:for(var h=0;h<r;h++){var u=n[h],c=u.getPropertyId();if(o.add(c))if(null==a||u instanceof $||u instanceof nt||u instanceof at||!a.animation.hasTimeline(c))i[h]=t.FIRST;else{for(var d=a.mixingTo;null!=d;d=d.mixingTo)if(!d.animation.hasTimeline(c)){if(e.mixDuration>0){i[h]=t.HOLD_MIX,s[h]=d;continue t}break}i[h]=t.HOLD_FIRST}else i[h]=t.SUBSEQUENT}}},{key:"getCurrent",value:function(t){return t>=this.tracks.length?null:this.tracks[t]}},{key:"addListener",value:function(t){if(null==t)throw new Error("listener cannot be null.");this.listeners.push(t)}},{key:"removeListener",value:function(t){var e=this.listeners.indexOf(t);e>=0&&this.listeners.splice(e,1)}},{key:"clearListeners",value:function(){this.listeners.length=0}},{key:"clearListenerNotifications",value:function(){this.queue.clear()}}]),t}();ht.emptyAnimation=new H("<empty>",[],0),ht.SUBSEQUENT=0,ht.FIRST=1,ht.HOLD_SUBSEQUENT=2,ht.HOLD_FIRST=3,ht.HOLD_MIX=4,ht.SETUP=1,ht.CURRENT=2;var ut,ct=function(){function t(){a(this,t),this.animation=void 0,this.next=void 0,this.mixingFrom=void 0,this.mixingTo=void 0,this.listener=void 0,this.trackIndex=void 0,this.loop=void 0,this.holdPrevious=void 0,this.eventThreshold=void 0,this.attachmentThreshold=void 0,this.drawOrderThreshold=void 0,this.animationStart=void 0,this.animationEnd=void 0,this.animationLast=void 0,this.nextAnimationLast=void 0,this.delay=void 0,this.trackTime=void 0,this.trackLast=void 0,this.nextTrackLast=void 0,this.trackEnd=void 0,this.timeScale=void 0,this.alpha=void 0,this.mixTime=void 0,this.mixDuration=void 0,this.interruptAlpha=void 0,this.totalAlpha=void 0,this.mixBlend=_.replace,this.timelineMode=new Array,this.timelineHoldMix=new Array,this.timelinesRotation=new Array}return r(t,[{key:"reset",value:function(){this.next=null,this.mixingFrom=null,this.mixingTo=null,this.animation=null,this.listener=null,this.timelineMode.length=0,this.timelineHoldMix.length=0,this.timelinesRotation.length=0}},{key:"getAnimationTime",value:function(){if(this.loop){var t=this.animationEnd-this.animationStart;return 0==t?this.animationStart:this.trackTime%t+this.animationStart}return Math.min(this.trackTime+this.animationStart,this.animationEnd)}},{key:"setAnimationLast",value:function(t){this.animationLast=t,this.nextAnimationLast=t}},{key:"isComplete",value:function(){return this.trackTime>=this.animationEnd-this.animationStart}},{key:"resetRotationDirections",value:function(){this.timelinesRotation.length=0}}]),t}(),dt=function(){function t(e){a(this,t),this.objects=[],this.drainDisabled=!1,this.animState=void 0,this.animState=e}return r(t,[{key:"start",value:function(t){this.objects.push(ut.start),this.objects.push(t),this.animState.animationsChanged=!0}},{key:"interrupt",value:function(t){this.objects.push(ut.interrupt),this.objects.push(t)}},{key:"end",value:function(t){this.objects.push(ut.end),this.objects.push(t),this.animState.animationsChanged=!0}},{key:"dispose",value:function(t){this.objects.push(ut.dispose),this.objects.push(t)}},{key:"complete",value:function(t){this.objects.push(ut.complete),this.objects.push(t)}},{key:"event",value:function(t){function e(e,a){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}((function(t,e){this.objects.push(ut.event),this.objects.push(t),this.objects.push(e)}))},{key:"drain",value:function(){if(!this.drainDisabled){this.drainDisabled=!0;for(var t=this.objects,e=this.animState.listeners,a=0;a<t.length;a+=2){var n=t[a],r=t[a+1];switch(n){case ut.start:null!=r.listener&&r.listener.start&&r.listener.start(r);for(var i=0;i<e.length;i++)e[i].start&&e[i].start(r);break;case ut.interrupt:null!=r.listener&&r.listener.interrupt&&r.listener.interrupt(r);for(var s=0;s<e.length;s++)e[s].interrupt&&e[s].interrupt(r);break;case ut.end:null!=r.listener&&r.listener.end&&r.listener.end(r);for(var o=0;o<e.length;o++)e[o].end&&e[o].end(r);case ut.dispose:null!=r.listener&&r.listener.dispose&&r.listener.dispose(r);for(var l=0;l<e.length;l++)e[l].dispose&&e[l].dispose(r);this.animState.trackEntryPool.free(r);break;case ut.complete:null!=r.listener&&r.listener.complete&&r.listener.complete(r);for(var h=0;h<e.length;h++)e[h].complete&&e[h].complete(r);break;case ut.event:var u=t[2+a++];null!=r.listener&&r.listener.event&&r.listener.event(r,u);for(var c=0;c<e.length;c++)e[c].event&&e[c].event(r,u)}}this.clear(),this.drainDisabled=!1}}},{key:"clear",value:function(){this.objects.length=0}}]),t}();!function(t){t[t.start=0]="start",t[t.interrupt=1]="interrupt",t[t.end=2]="end",t[t.dispose=3]="dispose",t[t.complete=4]="complete",t[t.event=5]="event"}(ut||(ut={}));var ft=function(){function t(e){if(a(this,t),this.skeletonData=void 0,this.animationToMixTime={},this.defaultMix=0,null==e)throw new Error("skeletonData cannot be null.");this.skeletonData=e}return r(t,[{key:"setMix",value:function(t,e,a){var n=this.skeletonData.findAnimation(t);if(null==n)throw new Error("Animation not found: "+t);var r=this.skeletonData.findAnimation(e);if(null==r)throw new Error("Animation not found: "+e);this.setMixWith(n,r,a)}},{key:"setMixWith",value:function(t,e,a){if(null==t)throw new Error("from cannot be null.");if(null==e)throw new Error("to cannot be null.");var n=t.name+"."+e.name;this.animationToMixTime[n]=a}},{key:"getMix",value:function(t,e){var a=t.name+"."+e.name,n=this.animationToMixTime[a];return void 0===n?this.defaultMix:n}}]),t}(),vt=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).endSlot=void 0,r.color=new c(.2275,.2275,.8078,1),r}return r(n,[{key:"copy",value:function(){var t=new n(this.name);return this.copyTo(t),t.endSlot=this.endSlot,t.color.setFromColor(this.color),t}}]),n}(T),gt=function(){function t(){a(this,t),this.convexPolygons=new Array,this.convexPolygonsIndices=new Array,this.indicesArray=new Array,this.isConcaveArray=new Array,this.triangles=new Array,this.polygonPool=new g((function(){return new Array})),this.polygonIndicesPool=new g((function(){return new Array}))}return r(t,[{key:"triangulate",value:function(e){var a=e,n=e.length>>1,r=this.indicesArray;r.length=0;for(var i=0;i<n;i++)r[i]=i;var s=this.isConcaveArray;s.length=0;for(var o=0,l=n;o<l;++o)s[o]=t.isConcave(o,n,a,r);var h=this.triangles;for(h.length=0;n>3;){for(var u=n-1,c=0,d=1;;){t:if(!s[c]){for(var f=r[u]<<1,v=r[c]<<1,g=r[d]<<1,m=a[f],p=a[f+1],y=a[v],w=a[v+1],k=a[g],x=a[g+1],E=(d+1)%n;E!=u;E=(E+1)%n)if(s[E]){var b=r[E]<<1,M=a[b],S=a[b+1];if(t.positiveArea(k,x,m,p,M,S)&&t.positiveArea(m,p,y,w,M,S)&&t.positiveArea(y,w,k,x,M,S))break t}break}if(0==d){do{if(!s[c])break;c--}while(c>0);break}u=c,c=d,d=(d+1)%n}h.push(r[(n+c-1)%n]),h.push(r[c]),h.push(r[(c+1)%n]),r.splice(c,1),s.splice(c,1);var I=(--n+c-1)%n,A=c==n?0:c;s[I]=t.isConcave(I,n,a,r),s[A]=t.isConcave(A,n,a,r)}return 3==n&&(h.push(r[2]),h.push(r[0]),h.push(r[1])),h}},{key:"decompose",value:function(e,a){var n=e,r=this.convexPolygons;this.polygonPool.freeAll(r),r.length=0;var i=this.convexPolygonsIndices;this.polygonIndicesPool.freeAll(i),i.length=0;var s=this.polygonIndicesPool.obtain();s.length=0;var o=this.polygonPool.obtain();o.length=0;for(var l=-1,h=0,u=0,c=a.length;u<c;u+=3){var d=a[u]<<1,f=a[u+1]<<1,v=a[u+2]<<1,g=n[d],m=n[d+1],p=n[f],y=n[f+1],w=n[v],k=n[v+1],x=!1;if(l==d){var E=o.length-4,b=t.winding(o[E],o[E+1],o[E+2],o[E+3],w,k),M=t.winding(w,k,o[0],o[1],o[2],o[3]);b==h&&M==h&&(o.push(w),o.push(k),s.push(v),x=!0)}x||(o.length>0?(r.push(o),i.push(s)):(this.polygonPool.free(o),this.polygonIndicesPool.free(s)),(o=this.polygonPool.obtain()).length=0,o.push(g),o.push(m),o.push(p),o.push(y),o.push(w),o.push(k),(s=this.polygonIndicesPool.obtain()).length=0,s.push(d),s.push(f),s.push(v),h=t.winding(g,m,p,y,w,k),l=d)}o.length>0&&(r.push(o),i.push(s));for(var S=0,I=r.length;S<I;S++)if(0!=(s=i[S]).length)for(var A=s[0],T=s[s.length-1],R=(o=r[S]).length-4,C=o[R],V=o[R+1],P=o[R+2],F=o[R+3],N=o[0],_=o[1],O=o[2],L=o[3],X=t.winding(C,V,P,F,N,_),D=0;D<I;D++)if(D!=S){var Y=i[D];if(3==Y.length){var B=Y[0],U=Y[1],W=Y[2],q=r[D],H=q[q.length-2],G=q[q.length-1];if(B==A&&U==T){var j=t.winding(C,V,P,F,H,G),Z=t.winding(H,G,N,_,O,L);j==X&&Z==X&&(q.length=0,Y.length=0,o.push(H),o.push(G),s.push(W),C=P,V=F,P=H,F=G,D=0)}}}for(var z=r.length-1;z>=0;z--)0==(o=r[z]).length&&(r.splice(z,1),this.polygonPool.free(o),s=i[z],i.splice(z,1),this.polygonIndicesPool.free(s));return r}}],[{key:"isConcave",value:function(t,e,a,n){var r=n[(e+t-1)%e]<<1,i=n[t]<<1,s=n[(t+1)%e]<<1;return!this.positiveArea(a[r],a[r+1],a[i],a[i+1],a[s],a[s+1])}},{key:"positiveArea",value:function(t,e,a,n,r,i){return t*(i-n)+a*(e-i)+r*(n-e)>=0}},{key:"winding",value:function(t,e,a,n,r,i){var s=a-t,o=n-e;return r*o-i*s+s*e-t*o>=0?1:-1}}]),t}(),mt=function(){function t(){a(this,t),this.triangulator=new gt,this.clippingPolygon=new Array,this.clipOutput=new Array,this.clippedVertices=new Array,this.clippedTriangles=new Array,this.scratch=new Array,this.clipAttachment=void 0,this.clippingPolygons=void 0}return r(t,[{key:"clipStart",value:function(e,a){if(null!=this.clipAttachment)return 0;this.clipAttachment=a;var n=a.worldVerticesLength,r=f.setArraySize(this.clippingPolygon,n);a.computeWorldVertices(e,0,n,r,0,2);var i=this.clippingPolygon;t.makeClockwise(i);for(var s=this.clippingPolygons=this.triangulator.decompose(i,this.triangulator.triangulate(i)),o=0,l=s.length;o<l;o++){var h=s[o];t.makeClockwise(h),h.push(h[0]),h.push(h[1])}return s.length}},{key:"clipEndWithSlot",value:function(t){null!=this.clipAttachment&&this.clipAttachment.endSlot==t.data&&this.clipEnd()}},{key:"clipEnd",value:function(){null!=this.clipAttachment&&(this.clipAttachment=null,this.clippingPolygons=null,this.clippedVertices.length=0,this.clippedTriangles.length=0,this.clippingPolygon.length=0)}},{key:"isClipping",value:function(){return null!=this.clipAttachment}},{key:"clipTriangles",value:function(t,e,a,n,r,i,s,o){var l=this.clipOutput,h=this.clippedVertices,u=this.clippedTriangles,c=this.clippingPolygons,d=this.clippingPolygons.length,v=o?12:8,g=0;h.length=0,u.length=0;t:for(var m=0;m<n;m+=3)for(var p=a[m]<<1,y=t[p],w=t[p+1],k=r[p],x=r[p+1],E=t[p=a[m+1]<<1],b=t[p+1],M=r[p],S=r[p+1],I=t[p=a[m+2]<<1],A=t[p+1],T=r[p],R=r[p+1],C=0;C<d;C++){var V=h.length;if(!this.clip(y,w,E,b,I,A,c[C],l)){var P=f.setArraySize(h,V+3*v);P[V]=y,P[V+1]=w,P[V+2]=i.r,P[V+3]=i.g,P[V+4]=i.b,P[V+5]=i.a,o?(P[V+6]=k,P[V+7]=x,P[V+8]=s.r,P[V+9]=s.g,P[V+10]=s.b,P[V+11]=s.a,P[V+12]=E,P[V+13]=b,P[V+14]=i.r,P[V+15]=i.g,P[V+16]=i.b,P[V+17]=i.a,P[V+18]=M,P[V+19]=S,P[V+20]=s.r,P[V+21]=s.g,P[V+22]=s.b,P[V+23]=s.a,P[V+24]=I,P[V+25]=A,P[V+26]=i.r,P[V+27]=i.g,P[V+28]=i.b,P[V+29]=i.a,P[V+30]=T,P[V+31]=R,P[V+32]=s.r,P[V+33]=s.g,P[V+34]=s.b,P[V+35]=s.a):(P[V+6]=k,P[V+7]=x,P[V+8]=E,P[V+9]=b,P[V+10]=i.r,P[V+11]=i.g,P[V+12]=i.b,P[V+13]=i.a,P[V+14]=M,P[V+15]=S,P[V+16]=I,P[V+17]=A,P[V+18]=i.r,P[V+19]=i.g,P[V+20]=i.b,P[V+21]=i.a,P[V+22]=T,P[V+23]=R),V=u.length;var F=f.setArraySize(u,V+3);F[V]=g,F[V+1]=g+1,F[V+2]=g+2,g+=3;continue t}var N=l.length;if(0!=N){for(var _=b-A,O=I-E,L=y-I,X=A-w,D=1/(_*L+O*(w-A)),Y=N>>1,B=this.clipOutput,U=f.setArraySize(h,V+Y*v),W=0;W<N;W+=2){var q=B[W],H=B[W+1];U[V]=q,U[V+1]=H,U[V+2]=i.r,U[V+3]=i.g,U[V+4]=i.b,U[V+5]=i.a;var G=q-I,j=H-A,Z=(_*G+O*j)*D,z=(X*G+L*j)*D,Q=1-Z-z;U[V+6]=k*Z+M*z+T*Q,U[V+7]=x*Z+S*z+R*Q,o&&(U[V+8]=s.r,U[V+9]=s.g,U[V+10]=s.b,U[V+11]=s.a),V+=v}V=u.length;var J=f.setArraySize(u,V+3*(Y-2));Y--;for(var K=1;K<Y;K++)J[V]=g,J[V+1]=g+K,J[V+2]=g+K+1,V+=3;g+=Y+1}}}},{key:"clip",value:function(t,e,a,n,r,i,s,o){var l=o,h=!1,u=null;s.length%4>=2?(u=o,o=this.scratch):u=this.scratch,u.length=0,u.push(t),u.push(e),u.push(a),u.push(n),u.push(r),u.push(i),u.push(t),u.push(e),o.length=0;for(var c=s,d=s.length-4,f=0;;f+=2){for(var v=c[f],g=c[f+1],m=c[f+2],p=c[f+3],y=v-m,w=g-p,k=u,x=u.length-2,E=o.length,b=0;b<x;b+=2){var M=k[b],S=k[b+1],I=k[b+2],A=k[b+3],T=y*(A-p)-w*(I-m)>0;if(y*(S-p)-w*(M-m)>0){if(T){o.push(I),o.push(A);continue}var R=A-S,C=I-M,V=R*(m-v)-C*(p-g);if(Math.abs(V)>1e-6){var P=(C*(g-S)-R*(v-M))/V;o.push(v+(m-v)*P),o.push(g+(p-g)*P)}else o.push(v),o.push(g)}else if(T){var F=A-S,N=I-M,_=F*(m-v)-N*(p-g);if(Math.abs(_)>1e-6){var O=(N*(g-S)-F*(v-M))/_;o.push(v+(m-v)*O),o.push(g+(p-g)*O)}else o.push(v),o.push(g);o.push(I),o.push(A)}h=!0}if(E==o.length)return l.length=0,!0;if(o.push(o[0]),o.push(o[1]),f==d)break;var L=o;(o=u).length=0,u=L}if(l!=o){l.length=0;for(var X=0,D=o.length-2;X<D;X++)l[X]=o[X]}else l.length=l.length-2;return h}}],[{key:"makeClockwise",value:function(t){for(var e=t,a=t.length,n=e[a-2]*e[1]-e[0]*e[a-1],r=0,i=0,s=0,o=0,l=a-3;o<l;o+=2)r=e[o],i=e[o+1],s=e[o+2],n+=r*e[o+3]-s*i;if(!(n<0))for(var h=0,u=a-2,c=a>>1;h<c;h+=2){var d=e[h],f=e[h+1],v=u-h;e[h]=e[v],e[h+1]=e[v+1],e[v]=d,e[v+1]=f}}}]),t}(),pt=function(){function t(){a(this,t),this._mesh=void 0,this.indexBuffer=void 0,this.vertexBuffer=void 0}return r(t,[{key:"mesh",get:function(){return this._mesh}},{key:"initialize",value:function(t,a){var n=this._mesh=new e.BufferMesh(t),r=new Uint16Array(a),i=[new e.VertexElement("POSITION",0,e.VertexElementFormat.Vector3,0),new e.VertexElement("COLOR",12,e.VertexElementFormat.Vector4,0),new e.VertexElement("TEXCOORD",28,e.VertexElementFormat.Vector2,0)],s=36*a,o=new e.Buffer(t,e.BufferBindFlag.VertexBuffer,s,e.BufferUsage.Dynamic),l=new e.Buffer(t,e.BufferBindFlag.IndexBuffer,r,e.BufferUsage.Dynamic);this.indexBuffer=l,this.vertexBuffer=o,n.setVertexBufferBinding(o,36),n.setIndexBufferBinding(l,e.IndexFormat.UInt16),n.setVertexElements(i),n.addSubMesh(0,r.length)}},{key:"fillVertexData",value:function(t){this.vertexBuffer.setData(t,0,0,0,e.SetDataOptions.Discard)}},{key:"fillIndexData",value:function(t){this.indexBuffer.setData(t,0,0,0,e.SetDataOptions.Discard)}}]),t}(),yt=function(){function t(e,n){a(this,t),this.setting=void 0,this.engine=void 0,this.entity=void 0,this.clipper=new mt,this.spineMesh=new pt,this.vertexCount=0,this.indicesLength=0,this.verticesLength=0,this.vertices=new Float32Array(1024),this.verticesWithZ=new Float32Array(1024),this.indices=new Uint16Array(1024),this.tempColor=new c,this.engine=e,this.entity=n}return r(t,[{key:"mesh",get:function(){return this.spineMesh.mesh}},{key:"buildMesh",value:function(a){if(a){var n=this.entity.getComponent(e.MeshRenderer);if(n){if(0===this.vertexCount){var r=this.getVertexCount(a);this.spineMesh.initialize(this.engine,r),n.mesh=this.spineMesh.mesh}var i=this.setting||{},s=i.useClipping,o=void 0===s||s,l=i.zSpacing,h=void 0===l?.01:l;this.verticesLength=0,this.indicesLength=0;for(var u=a.drawOrder,c=this.clipper,d=this.vertices,f=null,v=null,g=0;g<u.length;g+=1){var m=u[g];if(m.bone.active){var p=m.getAttachment(),y=null,w=null,k=h*g,x=0,E=c.isClipping()?2:t.VERTEX_SIZE;if(p instanceof V){var b=p;y=b.color,d=this.vertices,x=4*E,b.computeWorldVertices(m.bone,d,0,E),f=t.QUAD_TRIANGLES,v=b.uvs,w=b.region.renderObject.texture}else if(p instanceof W){var M=p;y=M.color,d=this.vertices,x=(M.worldVerticesLength>>1)*E,d.length,M.computeWorldVertices(m,0,M.worldVerticesLength,d,0,E),f=M.triangles,v=M.uvs,w=M.region.renderObject.texture}else{if(!(p instanceof vt))continue;if(o){var S=p;c.clipStart(m,S);continue}}if(null!=w){var I=m.bone.skeleton.color,A=m.color,T=I.a*A.a*y.a,R=this.tempColor;R.set(I.r*A.r*y.r,I.g*A.g*y.g,I.b*A.b*y.b,T);var C=void 0,P=void 0,F=void 0;if(c.isClipping()){c.clipTriangles(d,x,f,f.length,v,R,null,!1);var N=c.clippedVertices,_=c.clippedTriangles;C=N.length,P=_,F=_.length}else{for(var O=d,L=2,X=0,D=x;L<D;L+=E,X+=2)O[L]=R.r,O[L+1]=R.g,O[L+2]=R.b,O[L+3]=R.a,O[L+4]=v[X],O[L+5]=v[X+1];C=x,P=f,F=f.length}if(0==C||0==F)continue;for(var Y=this.verticesLength/t.VERTEX_STRIDE,B=this.verticesWithZ,U=this.verticesLength,q=0;q<C;)B[U++]=d[q++],B[U++]=d[q++],B[U++]=k,B[U++]=d[q++],B[U++]=d[q++],B[U++]=d[q++],B[U++]=d[q++],B[U++]=d[q++],B[U++]=d[q++];this.verticesLength=U;var H=this.indices;for(U=this.indicesLength,q=0;q<F;U++,q++)H[U]=P[q]+Y;this.indicesLength+=F}var G=n.getMaterial(0);G.shaderData.getTexture("map")||G.shaderData.setTexture("map",w.texture),c.clipEndWithSlot(m)}else c.clipEndWithSlot(m)}c.clipEnd()}else console.warn("You need add MeshRenderer component to entity first")}}},{key:"fillVertexData",value:function(){this.spineMesh.fillVertexData(this.verticesWithZ)}},{key:"fillIndexData",value:function(){this.spineMesh.fillIndexData(this.indices)}},{key:"addSubMesh",value:function(t){}},{key:"getVertexCount",value:function(e){if(e){for(var a=e.drawOrder,n=0,r=0,i=a.length;r<i;r++){var s=a[r];if(s.bone.active){var o=s.getAttachment();if(o)if(o instanceof V)n+=t.QUAD_TRIANGLES.length;else{if(!(o instanceof W))continue;n+=o.triangles.length}}}return this.vertices=new Float32Array(n*t.VERTEX_SIZE/3),this.verticesWithZ=new Float32Array(n*t.VERTEX_STRIDE/3),this.indices=new Uint16Array(n),this.vertexCount=n,n}}}]),t}();yt.QUAD_TRIANGLES=[0,1,2,2,3,0],yt.VERTEX_SIZE=8,yt.VERTEX_STRIDE=9;var wt,kt=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t))._skeletonData=void 0,r._skeleton=void 0,r._state=void 0,r._meshGenerator=void 0,r._meshGenerator=new yt(r.engine,t),r}return r(n,[{key:"skeletonData",get:function(){return this._skeletonData}},{key:"skeleton",get:function(){return this._skeleton}},{key:"state",get:function(){return this._state}},{key:"mesh",get:function(){return this._meshGenerator.mesh}},{key:"scale",set:function(t){this._skeleton&&(this._skeleton.scaleX=t,this._skeleton.scaleY=t)}},{key:"setSkeletonData",value:function(t){this._skeletonData=t,this._skeleton=new q(t);var e=new ft(t);this._state=new ht(e),this._meshGenerator.buildMesh(this._skeleton)}},{key:"disposeCurrentSkeleton",value:function(){this._skeletonData=null}},{key:"onUpdate",value:function(t){this.updateState(.001*t)}},{key:"updateState",value:function(t){if(this._skeleton&&this.state){var e=this._state,a=this._skeleton;e.update(t),e.apply(a),a.updateWorldTransform(),this.updateGeometry()}}},{key:"updateGeometry",value:function(){this._meshGenerator.buildMesh(this._skeleton),this._meshGenerator.fillVertexData(),this._meshGenerator.fillIndexData()}}]),n}(e.Script),xt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";a(this,t),this.pathPrefix=void 0,this.textureLoader=void 0,this.assets={},this.errors={},this.toLoad=0,this.loaded=0,this.rawDataUris={},this.textureLoader=e,this.pathPrefix=n}return r(t,[{key:"downloadText",value:function(t,e,a){var n=new XMLHttpRequest;n.overrideMimeType("text/html"),this.rawDataUris[t]&&(t=this.rawDataUris[t]),n.open("GET",t,!0),n.onload=function(){200==n.status?e(n.responseText):a(n.status,n.responseText)},n.onerror=function(){a(n.status,n.responseText)},n.send()}},{key:"downloadBinary",value:function(t,e,a){var n=new XMLHttpRequest;this.rawDataUris[t]&&(t=this.rawDataUris[t]),n.open("GET",t,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status?e(new Uint8Array(n.response)):a(n.status,n.responseText)},n.onerror=function(){a(n.status,n.responseText)},n.send()}},{key:"setRawDataURI",value:function(t,e){this.rawDataUris[this.pathPrefix+t]=e}},{key:"loadBinary",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=this.pathPrefix+t,this.toLoad++,this.downloadBinary(t,(function(n){e.assets[t]=n,a&&a(t,n),e.toLoad--,e.loaded++}),(function(a,r){e.errors[t]="Couldn't load binary ".concat(t,": status ").concat(status,", ").concat(r),n&&n(t,"Couldn't load binary ".concat(t,": status ").concat(status,", ").concat(r)),e.toLoad--,e.loaded++}))}},{key:"loadText",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(n){e.assets[t]=n,a&&a(t,n),e.toLoad--,e.loaded++}),(function(a,r){e.errors[t]="Couldn't load text ".concat(t,": status ").concat(status,", ").concat(r),n&&n(t,"Couldn't load text ".concat(t,": status ").concat(status,", ").concat(r)),e.toLoad--,e.loaded++}))}},{key:"loadTexture",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t=this.pathPrefix+t;this.toLoad++;var i=new Image;i.crossOrigin="anonymous",i.onload=function(n){var s=e.textureLoader(i);e.assets[r]=s,e.toLoad--,e.loaded++,a&&a(t,i)},i.onerror=function(a){e.errors[t]="Couldn't load image ".concat(t),e.toLoad--,e.loaded++,n&&n(t,"Couldn't load image ".concat(t))},this.rawDataUris[t]&&(t=this.rawDataUris[t]),i.src=t}},{key:"loadTextureAtlas",value:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=t.lastIndexOf("/")>=0?t.substring(0,t.lastIndexOf("/")):"";t=this.pathPrefix+t,this.toLoad++,this.downloadText(t,(function(i){var s={count:0},o=new Array;try{new D(i,(function(t){o.push(""==r?t:r+"/"+t);var e=document.createElement("img");return e.width=16,e.height=16,new X(e)}))}catch(a){var l=a;return e.errors[t]="Couldn't load texture atlas ".concat(t,": ").concat(l.message),n&&n(t,"Couldn't load texture atlas ".concat(t,": ").concat(l.message)),e.toLoad--,void e.loaded++}for(var h=function(){var l=c[u],h=!1;e.loadTexture(l,(function(l,u){if(s.count++,s.count==o.length)if(h)e.errors[t]="Couldn't load texture atlas page ".concat(l,"} of atlas ").concat(t),n&&n(t,"Couldn't load texture atlas page ".concat(l," of atlas ").concat(t)),e.toLoad--,e.loaded++;else try{var c=new D(i,(function(t){return e.get(""==r?t:r+"/"+t)}));e.assets[t]=c,a&&a(t,c),e.toLoad--,e.loaded++}catch(a){var d=a;e.errors[t]="Couldn't load texture atlas ".concat(t,": ").concat(d.message),n&&n(t,"Couldn't load texture atlas ".concat(t,": ").concat(d.message)),e.toLoad--,e.loaded++}}),(function(a,r){h=!0,s.count++,s.count==o.length&&(e.errors[t]="Couldn't load texture atlas page ".concat(a,"} of atlas ").concat(t),n&&n(t,"Couldn't load texture atlas page ".concat(a," of atlas ").concat(t)),e.toLoad--,e.loaded++)}))},u=0,c=o;u<c.length;u++)h()}),(function(a,r){e.errors[t]="Couldn't load texture atlas ".concat(t,": status ").concat(status,", ").concat(r),n&&n(t,"Couldn't load texture atlas ".concat(t,": status ").concat(status,", ").concat(r)),e.toLoad--,e.loaded++}))}},{key:"get",value:function(t){return t=this.pathPrefix+t,this.assets[t]}},{key:"remove",value:function(t){t=this.pathPrefix+t;var e=this.assets[t];e.dispose&&e.dispose(),this.assets[t]=null}},{key:"removeAll",value:function(){for(var t in this.assets){var e=this.assets[t];e.dispose&&e.dispose()}this.assets={}}},{key:"isLoadingComplete",value:function(){return 0==this.toLoad}},{key:"getToLoad",value:function(){return this.toLoad}},{key:"getLoaded",value:function(){return this.loaded}},{key:"dispose",value:function(){this.removeAll()}},{key:"hasErrors",value:function(){return Object.keys(this.errors).length>0}},{key:"getErrors",value:function(){return this.errors}}]),t}(),Et=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).color=new c(1,1,1,1),r}return r(n,[{key:"copy",value:function(){var t=new n(this.name);return this.copyTo(t),t.color.setFromColor(this.color),t}}]),n}(T),bt=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t)).x=void 0,r.y=void 0,r.rotation=void 0,r.color=new c(.38,.94,0,1),r.name=t,r}return r(n,[{key:"computeWorldPosition",value:function(t,e){return e.x=this.x*t.a+this.y*t.b+t.worldX,e.y=this.x*t.c+this.y*t.d+t.worldY,e}},{key:"computeWorldRotation",value:function(t){var e=d.cosDeg(this.rotation),a=d.sinDeg(this.rotation),n=e*t.a+a*t.b,r=e*t.c+a*t.d;return Math.atan2(r,n)*d.radDeg}},{key:"copy",value:function(){var t=new n(this.name);return t.x=this.x,t.y=this.y,t.rotation=this.rotation,t.color.setFromColor(this.color),t}}]),n}(T),Mt=function(){function t(e){a(this,t),this.atlas=void 0,this.atlas=e}return r(t,[{key:"newRegionAttachment",value:function(t,e,a){var n=this.atlas.findRegion(a);if(null==n)throw new Error("Region not found in atlas: "+a+" (region attachment: "+e+")");n.renderObject=n;var r=new V(e);return r.setRegion(n),r}},{key:"newMeshAttachment",value:function(t,e,a){var n=this.atlas.findRegion(a);if(null==n)throw new Error("Region not found in atlas: "+a+" (mesh attachment: "+e+")");n.renderObject=n;var r=new W(e);return r.region=n,r}},{key:"newBoundingBoxAttachment",value:function(t,e){return new Et(e)}},{key:"newPathAttachment",value:function(t,e){return new R(e)}},{key:"newPointAttachment",value:function(t,e){return new bt(e)}},{key:"newClippingAttachment",value:function(t,e){return new vt(e)}}]),t}(),St=function(){function t(){a(this,t),this.name=void 0,this.bones=new Array,this.slots=new Array,this.skins=new Array,this.defaultSkin=void 0,this.events=new Array,this.animations=new Array,this.ikConstraints=new Array,this.transformConstraints=new Array,this.pathConstraints=new Array,this.x=void 0,this.y=void 0,this.width=void 0,this.height=void 0,this.version=void 0,this.hash=void 0,this.fps=0,this.imagesPath=void 0,this.audioPath=void 0}return r(t,[{key:"findBone",value:function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findBoneIndex",value:function(t){if(null==t)throw new Error("boneName cannot be null.");for(var e=this.bones,a=0,n=e.length;a<n;a++)if(e[a].name==t)return a;return-1}},{key:"findSlot",value:function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findSlotIndex",value:function(t){if(null==t)throw new Error("slotName cannot be null.");for(var e=this.slots,a=0,n=e.length;a<n;a++)if(e[a].name==t)return a;return-1}},{key:"findSkin",value:function(t){if(null==t)throw new Error("skinName cannot be null.");for(var e=this.skins,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findEvent",value:function(t){if(null==t)throw new Error("eventDataName cannot be null.");for(var e=this.events,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findAnimation",value:function(t){if(null==t)throw new Error("animationName cannot be null.");for(var e=this.animations,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findIkConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.ikConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findTransformConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.transformConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findPathConstraint",value:function(t){if(null==t)throw new Error("constraintName cannot be null.");for(var e=this.pathConstraints,a=0,n=e.length;a<n;a++){var r=e[a];if(r.name==t)return r}return null}},{key:"findPathConstraintIndex",value:function(t){if(null==t)throw new Error("pathConstraintName cannot be null.");for(var e=this.pathConstraints,a=0,n=e.length;a<n;a++)if(e[a].name==t)return a;return-1}}]),t}(),It=function t(e,n,r){if(a(this,t),this.index=void 0,this.name=void 0,this.boneData=void 0,this.color=new c(1,1,1,1),this.darkColor=void 0,this.attachmentName=void 0,this.blendMode=void 0,e<0)throw new Error("index must be >= 0.");if(null==n)throw new Error("name cannot be null.");if(null==r)throw new Error("boneData cannot be null.");this.index=e,this.name=n,this.boneData=r},At=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t,0,!1)).bones=new Array,r.target=void 0,r.bendDirection=1,r.compress=!1,r.stretch=!1,r.uniform=!1,r.mix=1,r.softness=0,r}return n}(S),Tt=function(t){i(n,t);var e=h(n);function n(t){var r;return a(this,n),(r=e.call(this,t,0,!1)).bones=new Array,r.target=void 0,r.rotateMix=0,r.translateMix=0,r.scaleMix=0,r.shearMix=0,r.offsetRotation=0,r.offsetX=0,r.offsetY=0,r.offsetScaleX=0,r.offsetScaleY=0,r.offsetShearY=0,r.relative=!1,r.local=!1,r}return n}(S),Rt=function t(e,n,r){a(this,t),this.slotIndex=e,this.name=n,this.attachment=r},Ct=function(){function t(e){if(a(this,t),this.name=void 0,this.attachments=new Array,this.bones=Array(),this.constraints=new Array,null==e)throw new Error("name cannot be null.");this.name=e}return r(t,[{key:"setAttachment",value:function(t,e,a){if(null==a)throw new Error("attachment cannot be null.");var n=this.attachments;t>=n.length&&(n.length=t+1),n[t]||(n[t]={}),n[t][e]=a}},{key:"addSkin",value:function(t){for(var e=0;e<t.bones.length;e++){for(var a=t.bones[e],n=!1,r=0;r<this.bones.length;r++)if(this.bones[r]==a){n=!0;break}n||this.bones.push(a)}for(var i=0;i<t.constraints.length;i++){for(var s=t.constraints[i],o=!1,l=0;l<this.constraints.length;l++)if(this.constraints[l]==s){o=!0;break}o||this.constraints.push(s)}for(var h=t.getAttachments(),u=0;u<h.length;u++){var c=h[u];this.setAttachment(c.slotIndex,c.name,c.attachment)}}},{key:"copySkin",value:function(t){for(var e=0;e<t.bones.length;e++){for(var a=t.bones[e],n=!1,r=0;r<this.bones.length;r++)if(this.bones[r]==a){n=!0;break}n||this.bones.push(a)}for(var i=0;i<t.constraints.length;i++){for(var s=t.constraints[i],o=!1,l=0;l<this.constraints.length;l++)if(this.constraints[l]==s){o=!0;break}o||this.constraints.push(s)}for(var h=t.getAttachments(),u=0;u<h.length;u++){var c=h[u];null!=c.attachment&&(c.attachment instanceof W?(c.attachment=c.attachment.newLinkedMesh(),this.setAttachment(c.slotIndex,c.name,c.attachment)):(c.attachment=c.attachment.copy(),this.setAttachment(c.slotIndex,c.name,c.attachment)))}}},{key:"getAttachment",value:function(t,e){var a=this.attachments[t];return a?a[e]:null}},{key:"removeAttachment",value:function(t,e){var a=this.attachments[t];a&&(a[e]=null)}},{key:"getAttachments",value:function(){for(var t=new Array,e=0;e<this.attachments.length;e++){var a=this.attachments[e];if(a)for(var n in a){var r=a[n];r&&t.push(new Rt(e,n,r))}}return t}},{key:"getAttachmentsForSlot",value:function(t,e){var a=this.attachments[t];if(a)for(var n in a){var r=a[n];r&&e.push(new Rt(t,n,r))}}},{key:"clear",value:function(){this.attachments.length=0,this.bones.length=0,this.constraints.length=0}},{key:"attachAll",value:function(t,e){for(var a=0,n=0;n<t.slots.length;n++){var r=t.slots[n],i=r.getAttachment();if(i&&a<e.attachments.length){var s=e.attachments[a];for(var o in s)if(i==s[o]){var l=this.getAttachment(a,o);null!=l&&r.setAttachment(l);break}}a++}}}]),t}(),Vt=function t(e){a(this,t),this.name=void 0,this.intValue=void 0,this.floatValue=void 0,this.stringValue=void 0,this.audioPath=void 0,this.volume=void 0,this.balance=void 0,this.name=e};!function(t){t[t.Normal=0]="Normal",t[t.Additive=1]="Additive",t[t.Multiply=2]="Multiply",t[t.Screen=3]="Screen"}(wt||(wt={}));var Pt,Ft=function t(e,n){if(a(this,t),this.data=void 0,this.intValue=void 0,this.floatValue=void 0,this.stringValue=void 0,this.time=void 0,this.volume=void 0,this.balance=void 0,null==n)throw new Error("data cannot be null.");this.time=e,this.data=n},Nt=function(){function t(e){a(this,t),this.attachmentLoader=void 0,this.scale=1,this.linkedMeshes=new Array,this.attachmentLoader=e}return r(t,[{key:"readSkeletonData",value:function(e){var a=this.scale,n=new St,r="string"==typeof e?JSON.parse(e):e,i=r.skeleton;if(null!=i){if(n.hash=i.hash,n.version=i.spine,"3.8.75"==n.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");n.x=i.x,n.y=i.y,n.width=i.width,n.height=i.height,n.fps=i.fps,n.imagesPath=i.images}if(r.bones)for(var s=0;s<r.bones.length;s++){var o=r.bones[s],l=null,h=this.getValue(o,"parent",null);if(null!=h&&null==(l=n.findBone(h)))throw new Error("Parent bone not found: "+h);var u=new p(n.bones.length,o.name,l);u.length=this.getValue(o,"length",0)*a,u.x=this.getValue(o,"x",0)*a,u.y=this.getValue(o,"y",0)*a,u.rotation=this.getValue(o,"rotation",0),u.scaleX=this.getValue(o,"scaleX",1),u.scaleY=this.getValue(o,"scaleY",1),u.shearX=this.getValue(o,"shearX",0),u.shearY=this.getValue(o,"shearY",0),u.transformMode=t.transformModeFromString(this.getValue(o,"transform","normal")),u.skinRequired=this.getValue(o,"skin",!1),n.bones.push(u)}if(r.slots)for(var d=0;d<r.slots.length;d++){var f=r.slots[d],v=f.name,g=f.bone,m=n.findBone(g);if(null==m)throw new Error("Slot bone not found: "+g);var k=new It(n.slots.length,v,m),x=this.getValue(f,"color",null);null!=x&&k.color.setFromString(x);var E=this.getValue(f,"dark",null);null!=E&&(k.darkColor=new c(1,1,1,1),k.darkColor.setFromString(E)),k.attachmentName=this.getValue(f,"attachment",null),k.blendMode=t.blendModeFromString(this.getValue(f,"blend","normal")),n.slots.push(k)}if(r.ik)for(var b=0;b<r.ik.length;b++){var M=r.ik[b],S=new At(M.name);S.order=this.getValue(M,"order",0),S.skinRequired=this.getValue(M,"skin",!1);for(var A=0;A<M.bones.length;A++){var T=M.bones[A],R=n.findBone(T);if(null==R)throw new Error("IK bone not found: "+T);S.bones.push(R)}var C=M.target;if(S.target=n.findBone(C),null==S.target)throw new Error("IK target bone not found: "+C);S.mix=this.getValue(M,"mix",1),S.softness=this.getValue(M,"softness",0)*a,S.bendDirection=this.getValue(M,"bendPositive",!0)?1:-1,S.compress=this.getValue(M,"compress",!1),S.stretch=this.getValue(M,"stretch",!1),S.uniform=this.getValue(M,"uniform",!1),n.ikConstraints.push(S)}if(r.transform)for(var V=0;V<r.transform.length;V++){var P=r.transform[V],F=new Tt(P.name);F.order=this.getValue(P,"order",0),F.skinRequired=this.getValue(P,"skin",!1);for(var N=0;N<P.bones.length;N++){var _=P.bones[N],O=n.findBone(_);if(null==O)throw new Error("Transform constraint bone not found: "+_);F.bones.push(O)}var L=P.target;if(F.target=n.findBone(L),null==F.target)throw new Error("Transform constraint target bone not found: "+L);F.local=this.getValue(P,"local",!1),F.relative=this.getValue(P,"relative",!1),F.offsetRotation=this.getValue(P,"rotation",0),F.offsetX=this.getValue(P,"x",0)*a,F.offsetY=this.getValue(P,"y",0)*a,F.offsetScaleX=this.getValue(P,"scaleX",0),F.offsetScaleY=this.getValue(P,"scaleY",0),F.offsetShearY=this.getValue(P,"shearY",0),F.rotateMix=this.getValue(P,"rotateMix",1),F.translateMix=this.getValue(P,"translateMix",1),F.scaleMix=this.getValue(P,"scaleMix",1),F.shearMix=this.getValue(P,"shearMix",1),n.transformConstraints.push(F)}if(r.path)for(var X=0;X<r.path.length;X++){var D=r.path[X],Y=new I(D.name);Y.order=this.getValue(D,"order",0),Y.skinRequired=this.getValue(D,"skin",!1);for(var B=0;B<D.bones.length;B++){var U=D.bones[B],W=n.findBone(U);if(null==W)throw new Error("Transform constraint bone not found: "+U);Y.bones.push(W)}var q=D.target;if(Y.target=n.findSlot(q),null==Y.target)throw new Error("Path target slot not found: "+q);Y.positionMode=t.positionModeFromString(this.getValue(D,"positionMode","percent")),Y.spacingMode=t.spacingModeFromString(this.getValue(D,"spacingMode","length")),Y.rotateMode=t.rotateModeFromString(this.getValue(D,"rotateMode","tangent")),Y.offsetRotation=this.getValue(D,"rotation",0),Y.position=this.getValue(D,"position",0),Y.positionMode==y.Fixed&&(Y.position*=a),Y.spacing=this.getValue(D,"spacing",0),Y.spacingMode!=w.Length&&Y.spacingMode!=w.Fixed||(Y.spacing*=a),Y.rotateMix=this.getValue(D,"rotateMix",1),Y.translateMix=this.getValue(D,"translateMix",1),n.pathConstraints.push(Y)}if(r.skins)for(var H=0;H<r.skins.length;H++){var G=r.skins[H],j=new Ct(G.name);if(G.bones)for(var Z=0;Z<G.bones.length;Z++){var z=n.findBone(G.bones[Z]);if(null==z)throw new Error("Skin bone not found: "+G.bones[H]);j.bones.push(z)}if(G.ik)for(var Q=0;Q<G.ik.length;Q++){var J=n.findIkConstraint(G.ik[Q]);if(null==J)throw new Error("Skin IK constraint not found: "+G.ik[H]);j.constraints.push(J)}if(G.transform)for(var K=0;K<G.transform.length;K++){var $=n.findTransformConstraint(G.transform[K]);if(null==$)throw new Error("Skin transform constraint not found: "+G.transform[H]);j.constraints.push($)}if(G.path)for(var tt=0;tt<G.path.length;tt++){var et=n.findPathConstraint(G.path[tt]);if(null==et)throw new Error("Skin path constraint not found: "+G.path[H]);j.constraints.push(et)}for(var at in G.attachments){var nt=n.findSlot(at);if(null==nt)throw new Error("Slot not found: "+at);var rt=G.attachments[at];for(var it in rt){var st=this.readAttachment(rt[it],j,nt.index,it,n);null!=st&&j.setAttachment(nt.index,it,st)}}n.skins.push(j),"default"==j.name&&(n.defaultSkin=j)}for(var ot=0,lt=this.linkedMeshes.length;ot<lt;ot++){var ht=this.linkedMeshes[ot],ut=null==ht.skin?n.defaultSkin:n.findSkin(ht.skin);if(null==ut)throw new Error("Skin not found: "+ht.skin);var ct=ut.getAttachment(ht.slotIndex,ht.parent);if(null==ct)throw new Error("Parent mesh not found: "+ht.parent);ht.mesh.deformAttachment=ht.inheritDeform?ct:ht.mesh,ht.mesh.setParentMesh(ct),ht.mesh.updateUVs()}if(this.linkedMeshes.length=0,r.events)for(var dt in r.events){var ft=r.events[dt],vt=new Vt(dt);vt.intValue=this.getValue(ft,"int",0),vt.floatValue=this.getValue(ft,"float",0),vt.stringValue=this.getValue(ft,"string",""),vt.audioPath=this.getValue(ft,"audio",null),null!=vt.audioPath&&(vt.volume=this.getValue(ft,"volume",1),vt.balance=this.getValue(ft,"balance",0)),n.events.push(vt)}if(r.animations)for(var gt in r.animations){var mt=r.animations[gt];this.readAnimation(mt,gt,n)}return n}},{key:"readAttachment",value:function(t,e,a,n,r){var i=this.scale;switch(n=this.getValue(t,"name",n),this.getValue(t,"type","region")){case"region":var s=this.getValue(t,"path",n),o=this.attachmentLoader.newRegionAttachment(e,n,s);if(null==o)return null;o.path=s,o.x=this.getValue(t,"x",0)*i,o.y=this.getValue(t,"y",0)*i,o.scaleX=this.getValue(t,"scaleX",1),o.scaleY=this.getValue(t,"scaleY",1),o.rotation=this.getValue(t,"rotation",0),o.width=t.width*i,o.height=t.height*i;var l=this.getValue(t,"color",null);return null!=l&&o.color.setFromString(l),o.updateOffset(),o;case"boundingbox":var h=this.attachmentLoader.newBoundingBoxAttachment(e,n);if(null==h)return null;this.readVertices(t,h,t.vertexCount<<1);var u=this.getValue(t,"color",null);return null!=u&&h.color.setFromString(u),h;case"mesh":case"linkedmesh":var c=this.getValue(t,"path",n),d=this.attachmentLoader.newMeshAttachment(e,n,c);if(null==d)return null;d.path=c;var v=this.getValue(t,"color",null);null!=v&&d.color.setFromString(v),d.width=this.getValue(t,"width",0)*i,d.height=this.getValue(t,"height",0)*i;var g=this.getValue(t,"parent",null);if(null!=g)return this.linkedMeshes.push(new _t(d,this.getValue(t,"skin",null),a,g,this.getValue(t,"deform",!0))),d;var m=t.uvs;return this.readVertices(t,d,m.length),d.triangles=t.triangles,d.regionUVs=m,d.updateUVs(),d.edges=this.getValue(t,"edges",null),d.hullLength=2*this.getValue(t,"hull",0),d;case"path":var p=this.attachmentLoader.newPathAttachment(e,n);if(null==p)return null;p.closed=this.getValue(t,"closed",!1),p.constantSpeed=this.getValue(t,"constantSpeed",!0);var y=t.vertexCount;this.readVertices(t,p,y<<1);for(var w=f.newArray(y/3,0),k=0;k<t.lengths.length;k++)w[k]=t.lengths[k]*i;p.lengths=w;var x=this.getValue(t,"color",null);return null!=x&&p.color.setFromString(x),p;case"point":var E=this.attachmentLoader.newPointAttachment(e,n);if(null==E)return null;E.x=this.getValue(t,"x",0)*i,E.y=this.getValue(t,"y",0)*i,E.rotation=this.getValue(t,"rotation",0);var b=this.getValue(t,"color",null);return null!=b&&E.color.setFromString(b),E;case"clipping":var M=this.attachmentLoader.newClippingAttachment(e,n);if(null==M)return null;var S=this.getValue(t,"end",null);if(null!=S){var I=r.findSlot(S);if(null==I)throw new Error("Clipping end slot not found: "+S);M.endSlot=I}var A=t.vertexCount;this.readVertices(t,M,A<<1);var T=this.getValue(t,"color",null);return null!=T&&M.color.setFromString(T),M}return null}},{key:"readVertices",value:function(t,e,a){var n=this.scale;e.worldVerticesLength=a;var r=t.vertices;if(a!=r.length){for(var i=new Array,s=new Array,o=0,l=r.length;o<l;){var h=r[o++];s.push(h);for(var u=o+4*h;o<u;o+=4)s.push(r[o]),i.push(r[o+1]*n),i.push(r[o+2]*n),i.push(r[o+3])}e.bones=s,e.vertices=f.toFloatArray(i)}else{var c=f.toFloatArray(r);if(1!=n)for(var d=0,v=r.length;d<v;d++)c[d]*=n;e.vertices=c}}},{key:"readAnimation",value:function(t,e,a){var n=this.scale,r=new Array,i=0;if(t.slots)for(var s in t.slots){var o=t.slots[s],l=a.findSlotIndex(s);if(-1==l)throw new Error("Slot not found: "+s);for(var h in o){var u=o[h];if("attachment"==h){var d=new $(u.length);d.slotIndex=l;for(var v=0,g=0;g<u.length;g++){var m=u[g];d.setFrame(v++,this.getValue(m,"time",0),m.name)}r.push(d),i=Math.max(i,d.frames[d.getFrameCount()-1])}else if("color"==h){var p=new J(u.length);p.slotIndex=l;for(var k=0,x=0;x<u.length;x++){var E=u[x],b=new c;b.setFromString(E.color),p.setFrame(k,this.getValue(E,"time",0),b.r,b.g,b.b,b.a),this.readCurve(E,p,k),k++}r.push(p),i=Math.max(i,p.frames[(p.getFrameCount()-1)*J.ENTRIES])}else{if("twoColor"!=h)throw new Error("Invalid timeline type for a slot: "+h+" ("+s+")");var M=new K(u.length);M.slotIndex=l;for(var S=0,I=0;I<u.length;I++){var A=u[I],T=new c,R=new c;T.setFromString(A.light),R.setFromString(A.dark),M.setFrame(S,this.getValue(A,"time",0),T.r,T.g,T.b,T.a,R.r,R.g,R.b),this.readCurve(A,M,S),S++}r.push(M),i=Math.max(i,M.frames[(M.getFrameCount()-1)*K.ENTRIES])}}}if(t.bones)for(var C in t.bones){var V=t.bones[C],P=a.findBoneIndex(C);if(-1==P)throw new Error("Bone not found: "+C);for(var F in V){var N=V[F];if("rotate"===F){var _=new j(N.length);_.boneIndex=P;for(var O=0,L=0;L<N.length;L++){var X=N[L];_.setFrame(O,this.getValue(X,"time",0),this.getValue(X,"angle",0)),this.readCurve(X,_,O),O++}r.push(_),i=Math.max(i,_.frames[(_.getFrameCount()-1)*j.ENTRIES])}else{if("translate"!==F&&"scale"!==F&&"shear"!==F)throw new Error("Invalid timeline type for a bone: "+F+" ("+C+")");var D=null,Y=1,B=0;"scale"===F?(D=new z(N.length),B=1):"shear"===F?D=new Q(N.length):(D=new Z(N.length),Y=n),D.boneIndex=P;for(var U=0,W=0;W<N.length;W++){var q=N[W],G=this.getValue(q,"x",B),tt=this.getValue(q,"y",B);D.setFrame(U,this.getValue(q,"time",0),G*Y,tt*Y),this.readCurve(q,D,U),U++}r.push(D),i=Math.max(i,D.frames[(D.getFrameCount()-1)*Z.ENTRIES])}}}if(t.ik)for(var ht in t.ik){var ut=t.ik[ht],ct=a.findIkConstraint(ht),dt=new rt(ut.length);dt.ikConstraintIndex=a.ikConstraints.indexOf(ct);for(var ft=0,vt=0;vt<ut.length;vt++){var gt=ut[vt];dt.setFrame(ft,this.getValue(gt,"time",0),this.getValue(gt,"mix",1),this.getValue(gt,"softness",0)*n,this.getValue(gt,"bendPositive",!0)?1:-1,this.getValue(gt,"compress",!1),this.getValue(gt,"stretch",!1)),this.readCurve(gt,dt,ft),ft++}r.push(dt),i=Math.max(i,dt.frames[(dt.getFrameCount()-1)*rt.ENTRIES])}if(t.transform)for(var mt in t.transform){var pt=t.transform[mt],yt=a.findTransformConstraint(mt),wt=new it(pt.length);wt.transformConstraintIndex=a.transformConstraints.indexOf(yt);for(var kt=0,xt=0;xt<pt.length;xt++){var Et=pt[xt];wt.setFrame(kt,this.getValue(Et,"time",0),this.getValue(Et,"rotateMix",1),this.getValue(Et,"translateMix",1),this.getValue(Et,"scaleMix",1),this.getValue(Et,"shearMix",1)),this.readCurve(Et,wt,kt),kt++}r.push(wt),i=Math.max(i,wt.frames[(wt.getFrameCount()-1)*it.ENTRIES])}if(t.path)for(var bt in t.path){var Mt=t.path[bt],St=a.findPathConstraintIndex(bt);if(-1==St)throw new Error("Path constraint not found: "+bt);var It=a.pathConstraints[St];for(var At in Mt){var Tt=Mt[At];if("position"===At||"spacing"===At){var Rt=null,Ct=1;"spacing"===At?(Rt=new ot(Tt.length),It.spacingMode!=w.Length&&It.spacingMode!=w.Fixed||(Ct=n)):(Rt=new st(Tt.length),It.positionMode==y.Fixed&&(Ct=n)),Rt.pathConstraintIndex=St;for(var Vt=0,Pt=0;Pt<Tt.length;Pt++){var Nt=Tt[Pt];Rt.setFrame(Vt,this.getValue(Nt,"time",0),this.getValue(Nt,At,0)*Ct),this.readCurve(Nt,Rt,Vt),Vt++}r.push(Rt),i=Math.max(i,Rt.frames[(Rt.getFrameCount()-1)*st.ENTRIES])}else if("mix"===At){var _t=new lt(Tt.length);_t.pathConstraintIndex=St;for(var Ot=0,Lt=0;Lt<Tt.length;Lt++){var Xt=Tt[Lt];_t.setFrame(Ot,this.getValue(Xt,"time",0),this.getValue(Xt,"rotateMix",1),this.getValue(Xt,"translateMix",1)),this.readCurve(Xt,_t,Ot),Ot++}r.push(_t),i=Math.max(i,_t.frames[(_t.getFrameCount()-1)*lt.ENTRIES])}}}if(t.deform)for(var Dt in t.deform){var Yt=t.deform[Dt],Bt=a.findSkin(Dt);if(null==Bt)throw new Error("Skin not found: "+Dt);for(var Ut in Yt){var Wt=Yt[Ut],qt=a.findSlotIndex(Ut);if(-1==qt)throw new Error("Slot not found: "+Wt.name);for(var Ht in Wt){var Gt=Wt[Ht],jt=Bt.getAttachment(qt,Ht);if(null==jt)throw new Error("Deform attachment not found: "+Gt.name);var Zt=null!=jt.bones,zt=jt.vertices,Qt=Zt?zt.length/3*2:zt.length,Jt=new et(Gt.length);Jt.slotIndex=qt,Jt.attachment=jt;for(var Kt=0,$t=0;$t<Gt.length;$t++){var te=Gt[$t],ee=void 0,ae=this.getValue(te,"vertices",null);if(null==ae)ee=Zt?f.newFloatArray(Qt):zt;else{ee=f.newFloatArray(Qt);var ne=this.getValue(te,"offset",0);if(f.arrayCopy(ae,0,ee,ne,ae.length),1!=n)for(var re=ne,ie=re+ae.length;re<ie;re++)ee[re]*=n;if(!Zt)for(var se=0;se<Qt;se++)ee[se]+=zt[se]}Jt.setFrame(Kt,this.getValue(te,"time",0),ee),this.readCurve(te,Jt,Kt),Kt++}r.push(Jt),i=Math.max(i,Jt.frames[Jt.getFrameCount()-1])}}}var oe=t.drawOrder;if(null==oe&&(oe=t.draworder),null!=oe){for(var le=new nt(oe.length),he=a.slots.length,ue=0,ce=0;ce<oe.length;ce++){var de=oe[ce],fe=null,ve=this.getValue(de,"offsets",null);if(null!=ve){fe=f.newArray(he,-1);for(var ge=f.newArray(he-ve.length,0),me=0,pe=0,ye=0;ye<ve.length;ye++){var we=ve[ye],ke=a.findSlotIndex(we.slot);if(-1==ke)throw new Error("Slot not found: "+we.slot);for(;me!=ke;)ge[pe++]=me++;fe[me+we.offset]=me++}for(;me<he;)ge[pe++]=me++;for(var xe=he-1;xe>=0;xe--)-1==fe[xe]&&(fe[xe]=ge[--pe])}le.setFrame(ue++,this.getValue(de,"time",0),fe)}r.push(le),i=Math.max(i,le.frames[le.getFrameCount()-1])}if(t.events){for(var Ee=new at(t.events.length),be=0,Me=0;Me<t.events.length;Me++){var Se=t.events[Me],Ie=a.findEvent(Se.name);if(null==Ie)throw new Error("Event not found: "+Se.name);var Ae=new Ft(f.toSinglePrecision(this.getValue(Se,"time",0)),Ie);Ae.intValue=this.getValue(Se,"int",Ie.intValue),Ae.floatValue=this.getValue(Se,"float",Ie.floatValue),Ae.stringValue=this.getValue(Se,"string",Ie.stringValue),null!=Ae.data.audioPath&&(Ae.volume=this.getValue(Se,"volume",1),Ae.balance=this.getValue(Se,"balance",0)),Ee.setFrame(be++,Ae)}r.push(Ee),i=Math.max(i,Ee.frames[Ee.getFrameCount()-1])}if(isNaN(i))throw new Error("Error while parsing animation, duration is NaN");a.animations.push(new H(e,r,i))}},{key:"readCurve",value:function(t,e,a){if(t.hasOwnProperty("curve"))if("stepped"==t.curve)e.setStepped(a);else{var n=t.curve;e.setCurve(a,n,this.getValue(t,"c2",0),this.getValue(t,"c3",1),this.getValue(t,"c4",1))}}},{key:"getValue",value:function(t,e,a){return void 0!==t[e]?t[e]:a}}],[{key:"blendModeFromString",value:function(t){if("normal"==(t=t.toLowerCase()))return wt.Normal;if("additive"==t)return wt.Additive;if("multiply"==t)return wt.Multiply;if("screen"==t)return wt.Screen;throw new Error("Unknown blend mode: ".concat(t))}},{key:"positionModeFromString",value:function(t){if("fixed"==(t=t.toLowerCase()))return y.Fixed;if("percent"==t)return y.Percent;throw new Error("Unknown position mode: ".concat(t))}},{key:"spacingModeFromString",value:function(t){if("length"==(t=t.toLowerCase()))return w.Length;if("fixed"==t)return w.Fixed;if("percent"==t)return w.Percent;throw new Error("Unknown position mode: ".concat(t))}},{key:"rotateModeFromString",value:function(t){if("tangent"==(t=t.toLowerCase()))return k.Tangent;if("chain"==t)return k.Chain;if("chainscale"==t)return k.ChainScale;throw new Error("Unknown rotate mode: ".concat(t))}},{key:"transformModeFromString",value:function(t){if("normal"==(t=t.toLowerCase()))return v.Normal;if("onlytranslation"==t)return v.OnlyTranslation;if("norotationorreflection"==t)return v.NoRotationOrReflection;if("noscale"==t)return v.NoScale;if("noscaleorreflection"==t)return v.NoScaleOrReflection;throw new Error("Unknown transform mode: ".concat(t))}}]),t}(),_t=function t(e,n,r,i,s){a(this,t),this.parent=void 0,this.skin=void 0,this.slotIndex=void 0,this.mesh=void 0,this.inheritDeform=void 0,this.mesh=e,this.skin=n,this.slotIndex=r,this.parent=i,this.inheritDeform=s};!function(t){t[t.Region=0]="Region",t[t.BoundingBox=1]="BoundingBox",t[t.Mesh=2]="Mesh",t[t.LinkedMesh=3]="LinkedMesh",t[t.Path=4]="Path",t[t.Point=5]="Point",t[t.Clipping=6]="Clipping"}(Pt||(Pt={}));var Ot=function(){function t(e){a(this,t),this.scale=1,this.attachmentLoader=void 0,this.linkedMeshes=new Array,this.attachmentLoader=e}return r(t,[{key:"readSkeletonData",value:function(e){var a=this.scale,n=new St;n.name="";var r=new Lt(e);if(n.hash=r.readString(),n.version=r.readString(),"3.8.75"==n.version)throw new Error("Unsupported skeleton data, please export with a newer version of Spine.");n.x=r.readFloat(),n.y=r.readFloat(),n.width=r.readFloat(),n.height=r.readFloat();var i=r.readBoolean();i&&(n.fps=r.readFloat(),n.imagesPath=r.readString(),n.audioPath=r.readString());var s=0;s=r.readInt(!0);for(var o=0;o<s;o++)r.strings.push(r.readString());s=r.readInt(!0);for(var l=0;l<s;l++){var h=r.readString(),u=0==l?null:n.bones[r.readInt(!0)],d=new p(l,h,u);d.rotation=r.readFloat(),d.x=r.readFloat()*a,d.y=r.readFloat()*a,d.scaleX=r.readFloat(),d.scaleY=r.readFloat(),d.shearX=r.readFloat(),d.shearY=r.readFloat(),d.length=r.readFloat()*a,d.transformMode=t.TransformModeValues[r.readInt(!0)],d.skinRequired=r.readBoolean(),i&&c.rgba8888ToColor(d.color,r.readInt32()),n.bones.push(d)}s=r.readInt(!0);for(var v=0;v<s;v++){var g=r.readString(),m=n.bones[r.readInt(!0)],k=new It(v,g,m);c.rgba8888ToColor(k.color,r.readInt32());var x=r.readInt32();-1!=x&&c.rgb888ToColor(k.darkColor=new c,x),k.attachmentName=r.readStringRef(),k.blendMode=t.BlendModeValues[r.readInt(!0)],n.slots.push(k)}s=r.readInt(!0);for(var E,b=0;b<s;b++){var M=new At(r.readString());M.order=r.readInt(!0),M.skinRequired=r.readBoolean(),E=r.readInt(!0);for(var S=0;S<E;S++)M.bones.push(n.bones[r.readInt(!0)]);M.target=n.bones[r.readInt(!0)],M.mix=r.readFloat(),M.softness=r.readFloat()*a,M.bendDirection=r.readByte(),M.compress=r.readBoolean(),M.stretch=r.readBoolean(),M.uniform=r.readBoolean(),n.ikConstraints.push(M)}s=r.readInt(!0);for(var A,T=0;T<s;T++){var R=new Tt(r.readString());R.order=r.readInt(!0),R.skinRequired=r.readBoolean(),A=r.readInt(!0);for(var C=0;C<A;C++)R.bones.push(n.bones[r.readInt(!0)]);R.target=n.bones[r.readInt(!0)],R.local=r.readBoolean(),R.relative=r.readBoolean(),R.offsetRotation=r.readFloat(),R.offsetX=r.readFloat()*a,R.offsetY=r.readFloat()*a,R.offsetScaleX=r.readFloat(),R.offsetScaleY=r.readFloat(),R.offsetShearY=r.readFloat(),R.rotateMix=r.readFloat(),R.translateMix=r.readFloat(),R.scaleMix=r.readFloat(),R.shearMix=r.readFloat(),n.transformConstraints.push(R)}s=r.readInt(!0);for(var V,P=0;P<s;P++){var F=new I(r.readString());F.order=r.readInt(!0),F.skinRequired=r.readBoolean(),V=r.readInt(!0);for(var N=0;N<V;N++)F.bones.push(n.bones[r.readInt(!0)]);F.target=n.slots[r.readInt(!0)],F.positionMode=t.PositionModeValues[r.readInt(!0)],F.spacingMode=t.SpacingModeValues[r.readInt(!0)],F.rotateMode=t.RotateModeValues[r.readInt(!0)],F.offsetRotation=r.readFloat(),F.position=r.readFloat(),F.positionMode==y.Fixed&&(F.position*=a),F.spacing=r.readFloat(),F.spacingMode!=w.Length&&F.spacingMode!=w.Fixed||(F.spacing*=a),F.rotateMix=r.readFloat(),F.translateMix=r.readFloat(),n.pathConstraints.push(F)}var _=this.readSkin(r,n,!0,i);null!=_&&(n.defaultSkin=_,n.skins.push(_));var O=n.skins.length;for(f.setArraySize(n.skins,s=O+r.readInt(!0));O<s;O++)n.skins[O]=this.readSkin(r,n,!1,i);s=this.linkedMeshes.length;for(var L=0;L<s;L++){var X=this.linkedMeshes[L],D=null==X.skin?n.defaultSkin:n.findSkin(X.skin);if(null==D)throw new Error("Skin not found: "+X.skin);var Y=D.getAttachment(X.slotIndex,X.parent);if(null==Y)throw new Error("Parent mesh not found: "+X.parent);X.mesh.deformAttachment=X.inheritDeform?Y:X.mesh,X.mesh.setParentMesh(Y),X.mesh.updateUVs()}this.linkedMeshes.length=0,s=r.readInt(!0);for(var B=0;B<s;B++){var U=new Vt(r.readStringRef());U.intValue=r.readInt(!1),U.floatValue=r.readFloat(),U.stringValue=r.readString(),U.audioPath=r.readString(),null!=U.audioPath&&(U.volume=r.readFloat(),U.balance=r.readFloat()),n.events.push(U)}s=r.readInt(!0);for(var W=0;W<s;W++)n.animations.push(this.readAnimation(r,r.readString(),n));return n}},{key:"readSkin",value:function(t,e,a,n){var r=null,i=0;if(a){if(0==(i=t.readInt(!0)))return null;r=new Ct("default")}else{(r=new Ct(t.readStringRef())).bones.length=t.readInt(!0);for(var s=0,o=r.bones.length;s<o;s++)r.bones[s]=e.bones[t.readInt(!0)];for(var l=0,h=t.readInt(!0);l<h;l++)r.constraints.push(e.ikConstraints[t.readInt(!0)]);for(var u=0,c=t.readInt(!0);u<c;u++)r.constraints.push(e.transformConstraints[t.readInt(!0)]);for(var d=0,f=t.readInt(!0);d<f;d++)r.constraints.push(e.pathConstraints[t.readInt(!0)]);i=t.readInt(!0)}for(var v=0;v<i;v++)for(var g=t.readInt(!0),m=0,p=t.readInt(!0);m<p;m++){var y=t.readStringRef(),w=this.readAttachment(t,e,r,g,y,n);null!=w&&r.setAttachment(g,y,w)}return r}},{key:"readAttachment",value:function(e,a,n,r,i,s){var o=this.scale,l=e.readStringRef();null==l&&(l=i);var h=e.readByte();switch(t.AttachmentTypeValues[h]){case Pt.Region:var u=e.readStringRef(),d=e.readFloat(),v=e.readFloat(),g=e.readFloat(),m=e.readFloat(),p=e.readFloat(),y=e.readFloat(),w=e.readFloat(),k=e.readInt32();null==u&&(u=l);var x=this.attachmentLoader.newRegionAttachment(n,l,u);return null==x?null:(x.path=u,x.x=v*o,x.y=g*o,x.scaleX=m,x.scaleY=p,x.rotation=d,x.width=y*o,x.height=w*o,c.rgba8888ToColor(x.color,k),x.updateOffset(),x);case Pt.BoundingBox:var E=e.readInt(!0),b=this.readVertices(e,E),M=s?e.readInt32():0,S=this.attachmentLoader.newBoundingBoxAttachment(n,l);return null==S?null:(S.worldVerticesLength=E<<1,S.vertices=b.vertices,S.bones=b.bones,s&&c.rgba8888ToColor(S.color,M),S);case Pt.Mesh:var I=e.readStringRef(),A=e.readInt32(),T=e.readInt(!0),R=this.readFloatArray(e,T<<1,1),C=this.readShortArray(e),V=this.readVertices(e,T),P=e.readInt(!0),F=null,N=0,_=0;s&&(F=this.readShortArray(e),N=e.readFloat(),_=e.readFloat()),null==I&&(I=l);var O=this.attachmentLoader.newMeshAttachment(n,l,I);return null==O?null:(O.path=I,c.rgba8888ToColor(O.color,A),O.bones=V.bones,O.vertices=V.vertices,O.worldVerticesLength=T<<1,O.triangles=C,O.regionUVs=R,O.updateUVs(),O.hullLength=P<<1,s&&(O.edges=F,O.width=N*o,O.height=_*o),O);case Pt.LinkedMesh:var L=e.readStringRef(),X=e.readInt32(),D=e.readStringRef(),Y=e.readStringRef(),B=e.readBoolean(),U=0,W=0;s&&(U=e.readFloat(),W=e.readFloat()),null==L&&(L=l);var q=this.attachmentLoader.newMeshAttachment(n,l,L);return null==q?null:(q.path=L,c.rgba8888ToColor(q.color,X),s&&(q.width=U*o,q.height=W*o),this.linkedMeshes.push(new Xt(q,D,r,Y,B)),q);case Pt.Path:for(var H=e.readBoolean(),G=e.readBoolean(),j=e.readInt(!0),Z=this.readVertices(e,j),z=f.newArray(j/3,0),Q=0,J=z.length;Q<J;Q++)z[Q]=e.readFloat()*o;var K=s?e.readInt32():0,$=this.attachmentLoader.newPathAttachment(n,l);return null==$?null:($.closed=H,$.constantSpeed=G,$.worldVerticesLength=j<<1,$.vertices=Z.vertices,$.bones=Z.bones,$.lengths=z,s&&c.rgba8888ToColor($.color,K),$);case Pt.Point:var tt=e.readFloat(),et=e.readFloat(),at=e.readFloat(),nt=s?e.readInt32():0,rt=this.attachmentLoader.newPointAttachment(n,l);return null==rt?null:(rt.x=et*o,rt.y=at*o,rt.rotation=tt,s&&c.rgba8888ToColor(rt.color,nt),rt);case Pt.Clipping:var it=e.readInt(!0),st=e.readInt(!0),ot=this.readVertices(e,st),lt=s?e.readInt32():0,ht=this.attachmentLoader.newClippingAttachment(n,l);return null==ht?null:(ht.endSlot=a.slots[it],ht.worldVerticesLength=st<<1,ht.vertices=ot.vertices,ht.bones=ot.bones,s&&c.rgba8888ToColor(ht.color,lt),ht)}return null}},{key:"readVertices",value:function(t,e){var a=e<<1,n=new Dt,r=this.scale;if(!t.readBoolean())return n.vertices=this.readFloatArray(t,a,r),n;for(var i=new Array,s=new Array,o=0;o<e;o++){var l=t.readInt(!0);s.push(l);for(var h=0;h<l;h++)s.push(t.readInt(!0)),i.push(t.readFloat()*r),i.push(t.readFloat()*r),i.push(t.readFloat())}return n.vertices=f.toFloatArray(i),n.bones=s,n}},{key:"readFloatArray",value:function(t,e,a){var n=new Array(e);if(1==a)for(var r=0;r<e;r++)n[r]=t.readFloat();else for(var i=0;i<e;i++)n[i]=t.readFloat()*a;return n}},{key:"readShortArray",value:function(t){for(var e=t.readInt(!0),a=new Array(e),n=0;n<e;n++)a[n]=t.readShort();return a}},{key:"readAnimation",value:function(e,a,n){for(var r=new Array,i=this.scale,s=0,o=new c,l=new c,h=0,u=e.readInt(!0);h<u;h++)for(var d=e.readInt(!0),v=0,g=e.readInt(!0);v<g;v++){var m=e.readByte(),p=e.readInt(!0);switch(m){case t.SLOT_ATTACHMENT:var k=new $(p);k.slotIndex=d;for(var x=0;x<p;x++)k.setFrame(x,e.readFloat(),e.readStringRef());r.push(k),s=Math.max(s,k.frames[p-1]);break;case t.SLOT_COLOR:var E=new J(p);E.slotIndex=d;for(var b=0;b<p;b++){var M=e.readFloat();c.rgba8888ToColor(o,e.readInt32()),E.setFrame(b,M,o.r,o.g,o.b,o.a),b<p-1&&this.readCurve(e,b,E)}r.push(E),s=Math.max(s,E.frames[(p-1)*J.ENTRIES]);break;case t.SLOT_TWO_COLOR:var S=new K(p);S.slotIndex=d;for(var I=0;I<p;I++){var A=e.readFloat();c.rgba8888ToColor(o,e.readInt32()),c.rgb888ToColor(l,e.readInt32()),S.setFrame(I,A,o.r,o.g,o.b,o.a,l.r,l.g,l.b),I<p-1&&this.readCurve(e,I,S)}r.push(S),s=Math.max(s,S.frames[(p-1)*K.ENTRIES])}}for(var T=0,R=e.readInt(!0);T<R;T++)for(var C=e.readInt(!0),V=0,P=e.readInt(!0);V<P;V++){var F=e.readByte(),N=e.readInt(!0);switch(F){case t.BONE_ROTATE:var _=new j(N);_.boneIndex=C;for(var O=0;O<N;O++)_.setFrame(O,e.readFloat(),e.readFloat()),O<N-1&&this.readCurve(e,O,_);r.push(_),s=Math.max(s,_.frames[(N-1)*j.ENTRIES]);break;case t.BONE_TRANSLATE:case t.BONE_SCALE:case t.BONE_SHEAR:var L=void 0,X=1;F==t.BONE_SCALE?L=new z(N):F==t.BONE_SHEAR?L=new Q(N):(L=new Z(N),X=i),L.boneIndex=C;for(var D=0;D<N;D++)L.setFrame(D,e.readFloat(),e.readFloat()*X,e.readFloat()*X),D<N-1&&this.readCurve(e,D,L);r.push(L),s=Math.max(s,L.frames[(N-1)*Z.ENTRIES])}}for(var Y=0,B=e.readInt(!0);Y<B;Y++){var U=e.readInt(!0),W=e.readInt(!0),q=new rt(W);q.ikConstraintIndex=U;for(var G=0;G<W;G++)q.setFrame(G,e.readFloat(),e.readFloat(),e.readFloat()*i,e.readByte(),e.readBoolean(),e.readBoolean()),G<W-1&&this.readCurve(e,G,q);r.push(q),s=Math.max(s,q.frames[(W-1)*rt.ENTRIES])}for(var tt=0,ht=e.readInt(!0);tt<ht;tt++){var ut=e.readInt(!0),ct=e.readInt(!0),dt=new it(ct);dt.transformConstraintIndex=ut;for(var ft=0;ft<ct;ft++)dt.setFrame(ft,e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat()),ft<ct-1&&this.readCurve(e,ft,dt);r.push(dt),s=Math.max(s,dt.frames[(ct-1)*it.ENTRIES])}for(var vt=0,gt=e.readInt(!0);vt<gt;vt++)for(var mt=e.readInt(!0),pt=n.pathConstraints[mt],yt=0,wt=e.readInt(!0);yt<wt;yt++){var kt=e.readByte(),xt=e.readInt(!0);switch(kt){case t.PATH_POSITION:case t.PATH_SPACING:var Et=void 0,bt=1;kt==t.PATH_SPACING?(Et=new ot(xt),pt.spacingMode!=w.Length&&pt.spacingMode!=w.Fixed||(bt=i)):(Et=new st(xt),pt.positionMode==y.Fixed&&(bt=i)),Et.pathConstraintIndex=mt;for(var Mt=0;Mt<xt;Mt++)Et.setFrame(Mt,e.readFloat(),e.readFloat()*bt),Mt<xt-1&&this.readCurve(e,Mt,Et);r.push(Et),s=Math.max(s,Et.frames[(xt-1)*st.ENTRIES]);break;case t.PATH_MIX:var St=new lt(xt);St.pathConstraintIndex=mt;for(var It=0;It<xt;It++)St.setFrame(It,e.readFloat(),e.readFloat(),e.readFloat()),It<xt-1&&this.readCurve(e,It,St);r.push(St),s=Math.max(s,St.frames[(xt-1)*lt.ENTRIES])}}for(var At=0,Tt=e.readInt(!0);At<Tt;At++)for(var Rt=n.skins[e.readInt(!0)],Ct=0,Vt=e.readInt(!0);Ct<Vt;Ct++)for(var Pt=e.readInt(!0),Nt=0,_t=e.readInt(!0);Nt<_t;Nt++){var Ot=Rt.getAttachment(Pt,e.readStringRef()),Lt=null!=Ot.bones,Xt=Ot.vertices,Dt=Lt?Xt.length/3*2:Xt.length,Yt=e.readInt(!0),Bt=new et(Yt);Bt.slotIndex=Pt,Bt.attachment=Ot;for(var Ut=0;Ut<Yt;Ut++){var Wt=e.readFloat(),qt=void 0,Ht=e.readInt(!0);if(0==Ht)qt=Lt?f.newFloatArray(Dt):Xt;else{qt=f.newFloatArray(Dt);var Gt=e.readInt(!0);if(Ht+=Gt,1==i)for(var jt=Gt;jt<Ht;jt++)qt[jt]=e.readFloat();else for(var Zt=Gt;Zt<Ht;Zt++)qt[Zt]=e.readFloat()*i;if(!Lt)for(var zt=0,Qt=qt.length;zt<Qt;zt++)qt[zt]+=Xt[zt]}Bt.setFrame(Ut,Wt,qt),Ut<Yt-1&&this.readCurve(e,Ut,Bt)}r.push(Bt),s=Math.max(s,Bt.frames[Yt-1])}var Jt=e.readInt(!0);if(Jt>0){for(var Kt=new nt(Jt),$t=n.slots.length,te=0;te<Jt;te++){for(var ee=e.readFloat(),ae=e.readInt(!0),ne=f.newArray($t,0),re=$t-1;re>=0;re--)ne[re]=-1;for(var ie=f.newArray($t-ae,0),se=0,oe=0,le=0;le<ae;le++){for(var he=e.readInt(!0);se!=he;)ie[oe++]=se++;ne[se+e.readInt(!0)]=se++}for(;se<$t;)ie[oe++]=se++;for(var ue=$t-1;ue>=0;ue--)-1==ne[ue]&&(ne[ue]=ie[--oe]);Kt.setFrame(te,ee,ne)}r.push(Kt),s=Math.max(s,Kt.frames[Jt-1])}var ce=e.readInt(!0);if(ce>0){for(var de=new at(ce),fe=0;fe<ce;fe++){var ve=e.readFloat(),ge=n.events[e.readInt(!0)],me=new Ft(ve,ge);me.intValue=e.readInt(!1),me.floatValue=e.readFloat(),me.stringValue=e.readBoolean()?e.readString():ge.stringValue,null!=me.data.audioPath&&(me.volume=e.readFloat(),me.balance=e.readFloat()),de.setFrame(fe,me)}r.push(de),s=Math.max(s,de.frames[ce-1])}return new H(a,r,s)}},{key:"readCurve",value:function(e,a,n){switch(e.readByte()){case t.CURVE_STEPPED:n.setStepped(a);break;case t.CURVE_BEZIER:this.setCurve(n,a,e.readFloat(),e.readFloat(),e.readFloat(),e.readFloat())}}},{key:"setCurve",value:function(t,e,a,n,r,i){t.setCurve(e,a,n,r,i)}}]),t}();Ot.AttachmentTypeValues=[0,1,2,3,4,5,6],Ot.TransformModeValues=[v.Normal,v.OnlyTranslation,v.NoRotationOrReflection,v.NoScale,v.NoScaleOrReflection],Ot.PositionModeValues=[y.Fixed,y.Percent],Ot.SpacingModeValues=[w.Length,w.Fixed,w.Percent],Ot.RotateModeValues=[k.Tangent,k.Chain,k.ChainScale],Ot.BlendModeValues=[wt.Normal,wt.Additive,wt.Multiply,wt.Screen],Ot.BONE_ROTATE=0,Ot.BONE_TRANSLATE=1,Ot.BONE_SCALE=2,Ot.BONE_SHEAR=3,Ot.SLOT_ATTACHMENT=0,Ot.SLOT_COLOR=1,Ot.SLOT_TWO_COLOR=2,Ot.PATH_POSITION=0,Ot.PATH_SPACING=1,Ot.PATH_MIX=2,Ot.CURVE_LINEAR=0,Ot.CURVE_STEPPED=1,Ot.CURVE_BEZIER=2;var Lt=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Array,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new DataView(e.buffer);a(this,t),this.strings=n,this.index=r,this.buffer=i}return r(t,[{key:"readByte",value:function(){return this.buffer.getInt8(this.index++)}},{key:"readShort",value:function(){var t=this.buffer.getInt16(this.index);return this.index+=2,t}},{key:"readInt32",value:function(){var t=this.buffer.getInt32(this.index);return this.index+=4,t}},{key:"readInt",value:function(t){var e=this.readByte(),a=127&e;return 0!=(128&e)&&(a|=(127&(e=this.readByte()))<<7,0!=(128&e)&&(a|=(127&(e=this.readByte()))<<14,0!=(128&e)&&(a|=(127&(e=this.readByte()))<<21,0!=(128&e)&&(a|=(127&(e=this.readByte()))<<28)))),t?a:a>>>1^-(1&a)}},{key:"readStringRef",value:function(){var t=this.readInt(!0);return 0==t?null:this.strings[t-1]}},{key:"readString",value:function(){var t=this.readInt(!0);switch(t){case 0:return null;case 1:return""}t--;for(var e="",a=0;a<t;){var n=this.readByte();switch(n>>4){case 12:case 13:e+=String.fromCharCode((31&n)<<6|63&this.readByte()),a+=2;break;case 14:e+=String.fromCharCode((15&n)<<12|(63&this.readByte())<<6|63&this.readByte()),a+=3;break;default:e+=String.fromCharCode(n),a++}}return e}},{key:"readFloat",value:function(){var t=this.buffer.getFloat32(this.index);return this.index+=4,t}},{key:"readBoolean",value:function(){return 0!=this.readByte()}}]),t}(),Xt=function t(e,n,r,i,s){a(this,t),this.parent=void 0,this.skin=void 0,this.slotIndex=void 0,this.mesh=void 0,this.inheritDeform=void 0,this.mesh=e,this.skin=n,this.slotIndex=r,this.parent=i,this.inheritDeform=s},Dt=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;a(this,t),this.bones=e,this.vertices=n};e.Shader.create("spine_skeleton","\n  uniform mat4 u_MVPMat;\n\n  attribute vec3 POSITION; \n  attribute vec4 COLOR;\n  attribute vec2 TEXCOORD;\n  varying vec2 v_uv;\n  varying vec4 v_color;\n\n  void main() {\n    v_uv = TEXCOORD;\n    v_color = COLOR;\n    gl_Position = u_MVPMat * vec4(POSITION, 1.0);\n  }\n  ","\n  uniform sampler2D map;\n  varying vec2 v_uv;\n  varying vec4 v_color;\n\n  void main() {\n    gl_FragColor = texture2D(map, v_uv) * v_color;\n  }\n");var Yt=function(t){i(r,t);var n=h(r);function r(t){var i;a(this,r),(i=n.call(this,t,e.Shader.find("spine_skeleton"))).renderState.rasterState.cullMode=e.CullMode.Off,i.renderState.depthState.writeEnabled=!1;var s=i.renderState.blendState.targetBlendState;return s.sourceColorBlendFactor=e.BlendFactor.SourceAlpha,s.destinationColorBlendFactor=e.BlendFactor.OneMinusSourceAlpha,s.sourceAlphaBlendFactor=e.BlendFactor.One,s.destinationAlphaBlendFactor=e.BlendFactor.OneMinusSourceAlpha,i.renderQueueType=e.RenderQueueType.Transparent,s.enabled=!0,i}return r}(e.Material);e.resourceLoader("spine",["json","bin"])(function(t){i(s,t);var n=h(s);function s(){return a(this,s),n.apply(this,arguments)}return r(s,[{key:"load",value:function(t,a){var n=this;return new e.AssetPromise((function(r,i){var s;"spine"!==t.type&&i("Asset type must be spine.");var o,l=!1;!t.urls&&t.url&&n.checkUrl(t.url)&&(l=!0,s=n.getResouceFromUrl(t.url)),t.urls&&n.checkUrls(t.urls)&&(s=n.getResouceFromUrls(t.urls)),o=new xt((function(t){return new Bt(t,a.engine)}));var h=s,u=h.skeletonFile,c=h.atlasFile,d=h.textureFile;s&&l?(o.loadText(u),o.loadTextureAtlas(c)):s&&!l?(o.loadText(u),o.loadText(c),o.loadTexture(d)):i("Resouce param error"),n.onLoad(o).then((function(t){var s;"loaded"!==t&&i(t),s=l?o.get(c):new D(o.get(c),(function(){return o.get(d)}));var h=new Mt(s),f=(n.isBinFile(u)?new Ot(h):new Nt(h)).readSkeletonData(o.get(u)),v=new e.Entity(a.engine),g=v.addComponent(e.MeshRenderer),m=new Yt(a.engine);g.setMaterial(m),v.addComponent(kt).setSkeletonData(f),r(v)}))}))}},{key:"isBinFile",value:function(t){return"bin"===this.getExtFromUrl(t)}},{key:"checkUrl",value:function(t){var e=this.getExtFromUrl(t);return"json"===e||"bin"===e||(console.error("When use url as params, url must be json or bin file"),!1)}},{key:"getResouceFromUrl",value:function(t){var e=t,a=t,n=a.indexOf("?");return n>0&&(a=a.substr(0,n)),{skeletonFile:e,atlasFile:a=a.substr(0,a.lastIndexOf("."))+".atlas"}}},{key:"checkUrls",value:function(t){if(t.length<3)return console.error("When use urls as params, urls must contain three url: json/bin, atlas and img"),!1;if(t.length>3)return console.error("Spine runtime dont support multiple texture now"),!1;var e=this.getResouceFromUrls(t),a=e.skeletonFile,n=e.atlasFile,r=e.textureFile;return!!(a&&n&&r)||(console.error("Lack ".concat(a?"":"skeletonFile").concat(n?" atlasFile":"").concat(r?" textureFile":"")),!1)}},{key:"getResouceFromUrls",value:function(t){for(var e,a,n,r=0;r<t.length;r+=1){var i=t[r],s=this.getExtFromUrl(i);"json"!==s&&"bin"!==s||(e=i),"atlas"===s&&(a=i),["png","jpg","webp","jpeg"].includes(s)&&(n=i)}return{skeletonFile:e,atlasFile:a,textureFile:n}}},{key:"getExtFromUrl",value:function(t){return t.split(/[#?]/)[0].split(".").pop().trim()}},{key:"onLoad",value:function(t){return new Promise((function(e,a){setInterval((function(){t.isLoadingComplete()&&(t.hasErrors()?a(t.getErrors()):e("loaded"))}),100)}))}}]),s}(e.Loader));var Bt=function(t){i(s,t);var n=h(s);function s(t,r){var i;return a(this,s),(i=n.call(this,t)).texture=void 0,i.texture=new e.Texture2D(r,t.width,t.height),i.texture.setImageSource(t),i.texture.generateMipmaps(),i}return r(s,[{key:"setFilters",value:function(t,a){t===WebGLRenderingContext.NEAREST?this.texture.filterMode=e.TextureFilterMode.Point:a===WebGLRenderingContext.LINEAR_MIPMAP_LINEAR?this.texture.filterMode=e.TextureFilterMode.Trilinear:this.texture.filterMode=e.TextureFilterMode.Bilinear}},{key:"setWraps",value:function(t,e){this.texture.wrapModeU=t,this.texture.wrapModeV=e}},{key:"dispose",value:function(){}}]),s}(N);t.SpineAnimation=kt,Object.defineProperty(t,"__esModule",{value:!0})}(e,a("qSBo"))}}]);