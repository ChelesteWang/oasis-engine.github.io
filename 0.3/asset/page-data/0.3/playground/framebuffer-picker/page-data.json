{"componentChunkName":"component---src-templates-playground-tsx","path":"/0.3/playground/framebuffer-picker","result":{"pageContext":{"node":{"internal":{"content":"(function (global, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define([\"oasis-engine\", \"@oasis-engine/controls\", \"@oasis-engine/framebuffer-picker\"], factory);\n  } else if (typeof exports !== \"undefined\") {\n    factory(require(\"oasis-engine\"), require(\"@oasis-engine/controls\"), require(\"@oasis-engine/framebuffer-picker\"));\n  } else {\n    var mod = {\n      exports: {}\n    };\n    factory(global.oasisEngine, global[\"@oasisEngine/controls\"], global[\"@oasisEngine/framebufferPicker\"]);\n    global.index = mod.exports;\n  }\n})(typeof globalThis !== \"undefined\" ? globalThis : typeof self !== \"undefined\" ? self : this, function (_oasisEngine, _controls, _framebufferPicker) {\n  \"use strict\";\n\n  /**\n   * @title Framebuffer Picker\n   * @category Picking\n   */\n  var engine = new _oasisEngine.WebGLEngine(\"canvas\");\n  engine.canvas.resizeByClientSize();\n  var scene = engine.sceneManager.activeScene;\n  var rootNode = scene.createRootEntity(); //-- create engine object\n\n  var envLightNode = rootNode.createChild(\"env_light\");\n  var envLight = envLightNode.addComponent(_oasisEngine.EnvironmentMapLight); //-- create camera\n\n  var cameraNode = rootNode.createChild(\"camera_node\");\n  cameraNode.transform.position = new _oasisEngine.Vector3(0, 0, 30);\n  var camera = cameraNode.addComponent(_oasisEngine.Camera);\n  cameraNode.addComponent(_controls.OrbitControl);\n  var resources = [{\n    url: \"https://gw.alipayobjects.com/os/bmw-prod/83219f61-7d20-4704-890a-60eb92aa6159.gltf\"\n  }, {\n    urls: [\"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*Bk5FQKGOir4AAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*_cPhR7JMDjkAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*trqjQp1nOMQAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*_RXwRqwMK3EAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*q4Q6TroyuXcAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*DP5QTbTSAYgAAAAAAAAAAAAAARQnAQ\"],\n    type: _oasisEngine.AssetType.TextureCube\n  }, {\n    urls: [\"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*5w6_Rr6ML6IAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*TiT2TbN5cG4AAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*8GF6Q4LZefUAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*D5pdRqUHC3IAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*_FooTIp6pNIAAAAAAAAAAAAAARQnAQ\", \"https://gw.alipayobjects.com/mdn/rms_7c464e/afts/img/A*CYGZR7ogZfoAAAAAAAAAAAAAARQnAQ\"],\n    type: _oasisEngine.AssetType.TextureCube\n  }];\n  engine.resourceManager.load(resources).then(function (res) {\n    var gltf = res[0];\n    var mesh = gltf.meshes[0];\n\n    for (var x = 0; x < 5; x++) {\n      for (var y = 0; y < 5; y++) {\n        var testNode = rootNode.createChild(\"test_mesh\" + x + y);\n        testNode.addChild(gltf.defaultSceneRoot.clone());\n        testNode.transform.position = new _oasisEngine.Vector3((x - 2) * 5, (y - 2) * 5, 0);\n      }\n    }\n\n    envLight.diffuseTexture = res[1];\n    envLight.specularTexture = res[2]; // framebuffer picker\n\n    var lastMaterial;\n    var laseBaseColor;\n    var framebufferPicker = rootNode.addComponent(_framebufferPicker.FramebufferPicker);\n    framebufferPicker.camera = camera;\n\n    framebufferPicker.onPick = function (obj) {\n      if (lastMaterial) lastMaterial.baseColor = laseBaseColor;\n\n      if (obj) {\n        var primitive = obj.primitive,\n            component = obj.component;\n        var material = component.getInstanceMaterial();\n        lastMaterial = material;\n        laseBaseColor = material.baseColor;\n        material.baseColor = new _oasisEngine.Color(1, 0, 0, 1);\n      }\n    };\n\n    document.getElementById(\"canvas\").addEventListener(\"mousedown\", function (e) {\n      console.log(e.offsetX, e.offsetY);\n      framebufferPicker.pick(e.offsetX, e.offsetY);\n    });\n  }); //-- run\n\n  engine.run();\n});"},"name":"framebuffer-picker","id":"2dbf822b-d1db-5fab-b2db-e273b423facb"}}},"staticQueryHashes":[]}